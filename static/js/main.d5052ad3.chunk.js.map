{"version":3,"sources":["../node_modules/@trust/webcrypto/src/algorithms sync","../node_modules/n3/lib sync /^/N3.*$","Actions/actionTypes.ts","config.ts","Reducers/accountReducer.ts","Reducers/dialogsReducer.ts","Reducers/itemsReducer.ts","Reducers/metasReducer.ts","Reducers/pathReducer.ts","Reducers/uploadReducer.ts","Reducers/reducer.ts","Reducers/currentBlobReducer.ts","Reducers/errorReducer.ts","Reducers/loadingReducer.ts","serviceWorker.ts","Api/FileUtils.ts","Api/Item.ts","Api/folderUtils.ts","Api/Api.ts","Api/ApiCache.ts","Api/CouchDb.ts","Api/MetaUtils.ts","Api/ApiHandler.ts","Actions/Actions.ts","Components/TreeView/TreeViewItem.tsx","Components/Loader/Loader.tsx","Components/TreeView/TreeView.tsx","Components/TagList/TagList.tsx","Components/File/File.tsx","Components/FileList/FileListEmptyMessage.tsx","Components/FileList/FileList.tsx","Components/Meta/MetaRow.tsx","Components/Meta/MetaListEmptyMessage.tsx","Components/Meta/MetaList.tsx","TreeAndTagList.tsx","Components/ContextMenu/ContextMenuActions/CreateFolderAction.tsx","Components/ContextMenu/ContextMenuActions/CreateFileAction.tsx","Components/ContextMenu/ContextMenuActions/UploadFileAction.tsx","Components/ContextMenu/ContextMenuActions/ChooseLocationAction.tsx","Components/Navbar/ThreeDotsMenu.tsx","Components/Breadcrumb/BreadcrumbText.tsx","Components/Navbar/Navbar.tsx","Components/ContextMenu/ContextMenuActions/OpenAction.tsx","Components/ContextMenu/ContextMenuActions/RemoveAction.tsx","Components/ContextMenu/ContextMenuActions/MoveAction.tsx","Components/ContextMenu/ContextMenuActions/CopyAction.tsx","Components/ContextMenu/ContextMenuActions/EditAction.tsx","Components/ContextMenu/ContextMenuActions/EditTagsAction.tsx","Components/ContextMenu/ContextMenuActions/RenameAction.tsx","Components/ContextMenu/ContextMenuActions/ZipAction.tsx","Components/ContextMenu/ContextMenuActions/ExtractAction.tsx","Components/ContextMenu/ContextMenuActions/DownloadAction.tsx","Components/ContextMenu/ContextMenuActions/OpenInNewTabAction.tsx","Components/ContextMenu/ContextMenu.tsx","Components/HistoryHandler/HistoryHandler.tsx","Components/Dialogs/Menu/Menu.tsx","Components/Dialogs/Content/Content.tsx","Components/Dialogs/Media/Media.tsx","Components/Dialogs/Edit/Edit.tsx","Api/jsonp.js","Components/Dialogs/EditTags/AutocompleteTag.tsx","Components/Dialogs/EditTags/EditTags.tsx","Components/Dialogs/CreateFolder/CreateFolder.tsx","Components/Dialogs/CreateFile/CreateFile.tsx","Components/Dialogs/Rename/Rename.tsx","Components/File/FileSublist/FileSublist.tsx","Components/FileList/FileListSublist/FileListSublist.tsx","Components/Dialogs/ChooseLocation/ChooseLocation.tsx","Components/Dialogs/Move/Move.tsx","Components/Dialogs/Copy/Copy.tsx","Components/FileUploader/UploadFileList.tsx","Components/FileUploader/FileUploader.tsx","Components/Dialogs/UploadFile/UploadFile.tsx","Components/Dialogs/Dialogs.tsx","Components/Notification/DynamicSnackbar.tsx","App.tsx","index.tsx"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","map","webpackContext","webpackContextResolve","__webpack_require__","o","Object","DIALOGS","host","getHost","setHost","newHost","endsWith","slice","initialState","loggedIn","webId","initialVisibleDialogs","values","name","reduce","prev","cur","initialContextMenuState","open","x","y","initialItemsState","inCurFolder","filter","selected","removeItem","items","item","selectedItem","equals","addItem","initialMetasState","initialPath","initialUploadState","fileList","progress","rootReducer","combineReducers","account","state","action","type","config","value","blob","URL","createObjectURL","revokeObjectURL","contextMenu","visibleDialogs","errorMessage","includes","loading","path","upload","metas","isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","onUpdate","onSuccess","catch","error","FileClient","require","FileUtils","popupLogin","serverId","split","err","ms","Promise","setTimeout","this","webIdAndHost","baseUrl","sleep","solidAuth","session","fileName","getWebIdAndHost","infos","res","readFolder","content","decodeURI","folders","forEach","f","alert","url","readFile","body","createFile","newContent","updateFile","Item","size","_name","_path","_url","_size","getPathFromUrl","pop","length","every","val","index","getHumanFileSize","FileItem","patterns","image","test","media","editable","extractable","video","FolderItem","byteString","bytes","parseInt","Math","pow","toFixed","urlString","pathname","getFolderItems","graph","subj","files","each","rdflib","undefined","subjectName","subjectNode","nsSize","any","getSizeByGraph","folderNode","isAnInstanceOfClass","types","some","isFolder","push","text2graph","text","a","contentType","guessFileType","reject","ext","replace","fetchFile","buildFileUrl","assertSuccessfulResponse","fetchFolder","folderName","buildFolderUrl","headers","response","folderRDF","folderUtils","folderItems","destination","itemNames","copyItems","removeItems","oldName","newName","copyFile","oldFolderName","newFolderName","copyFolder","removeFolderRecursively","promises","all","Response","originPath","originName","destinationPath","destinationName","fileResponse","createFolder","Array","from","file","folderExists","createItem","Blob","itemName","link","request","method","slug","status","removeFolderContents","folderPath","ok","ApiCache","_data","itemList","hasOwnProperty","paths","contains","CouchDb","xhr","createCORSRequest","couchDbBaseUrl","onload","responseText","onerror","send","executeQueryonCouch","json","JSON","parse","usedTag","rows","row","tag","tagType","key","published","selectedTags","tagsAsString","tagArrayTotring","foundMeta","meta","createIdFromMeta","oldMeta","_rev","writeMeta","statusText","stringify","XMLHttpRequest","setRequestHeader","reg","RegExp","hostName","pathName","tags","tagsAsAstring","comma","couchDbServerUrl","couchDbDatabaseName","onServerColor","MetaUtils","SolidFileClientUtils","allMetas","allLocalMetas","fileClientReadFileAsString","fileClientcreateFile","getTagIndexFullPath","showLocalOrCentral","getLocalMetaList","getCentralMetaList","getAllLocalMetas","filteredMetas","testTag","filterByMetaTag","havingTagMeta","existingFilteredMeta","lodash","find","havingTagMetaCopy","creationDate","Date","getMetaFromTags","getUrl","mimeType","currentMeta","existingMeta","el","currentItem","fileClientupdateFile","metaCopy","updateMeta","currentLocalUsedTags","getLocalUsedTags","foundTags","usedTags","uniqWith","first","second","sortBy","getItemsByViewGroupedTags","centralTags","centralTag","localTags","localTag","markCentralFromLocal","cache","handleFetchError","detailedErrorMessage","group","displayMessages","displayErrorMessage","message","stack","groupEnd","fixPath","getItemList","get","API","add","getFileBlob","filename","renameFile","newFileName","remove","renameFolder","trim","moveItems","filenames","uploadFiles","getAsZip","zip","JSZip","addItemsToZip","zipFolder","folder","binary","extractZipArchive","loadAsync","uploadExtractedZipArchive","curFolder","getItemsInZipFolder","relativePath","getItemNameFromPath","getParentPathFromPath","dir","async","substr","lastIndexOf","solidLogin","dispatch","getState","displayLoading","solidPopupLogin","updateLoginStatus","r","setErrorMessage","String","finally","stopLoading","setWebId","setLoggedIn","setLoggedOut","resetWebId","popupUri","clearCache","clear","APIHandler","closeDialog","EDITTAGS","getMetaList","setMetas","displayCurrentItemList","resetSelectedItems","join","setItems","refreshItemList","promptDownload","msSaveOrOpenBlob","document","createElement","href","download","appendChild","click","removeChild","getFileContent","resetFileContent","setFileContent","loadAndEditFile","openDialog","EDIT","loadAndDisplayFile","CONTENT","displaySelectedMediaFile","MEDIA","targetPath","COPY","setSelectedItemsFromLastTo","lastFile","selectedItems","lastPreviouslySelected","lastPreviouslySelectedIndex","indexOf","lastSelectedIndex","isInRange","num","start","end","toAdd","selectItems","resetFileUploader","setFileUploadProgress","UPLOAD_FILE","resetFileUploadList","enterFolder","setPath","resetFilter","enterFolderByItem","rightClickOnFile","selectItem","makeActionCreator","moveFolderUpwards","resetPath","resetItems","toggleSelectedItem","filterItems","setFileUploadList","openContextMenu","closeContextMenu","TreeViewItem","colNumber","Blank","width","height","viewBox","xmlns","xmlnsXlink","d","fill","props","handleClick","itemHandleClick","style","padding","button","onClick","bind","blanks","expColl","fontSize","it","React","Component","connect","ownProps","withStyles","theme","createStyles","margin","spacing","unit","container","justify","className","classes","color","TreeView","updateFolder","setState","fileClientReadFolder","forceUpdate","i","known","j","initFolders","flexShrink","subheader","printRows","component","in","timeout","unmountOnExit","TagList","PrintList","minWidth","itemColor","role","dense","onChange","checked","elt","refreshView","getCentralUsedTags","metaTag","splice","handleSubmit","File","isSelected","handleClickOnName","handleClickOnFolder","handleDoubleClick","handleContextMenu","iconStyle","backgroundColor","blue","realSize","getDisplaySize","data-selected","primary","getDisplayName","secondary","onDoubleClick","onContextMenu","absolute","isEditable","isImage","isMedia","event","preventDefault","stopPropagation","nativeEvent","MouseEvent","clientX","clientY","TouchEvent","touches","pageX","pageY","warn","shiftKey","ctrlKey","FileListEmptyMessage","FileList","isLoading","itemComponents","filterMatch","toLocaleLowerCase","MetaRow","prevChars","shift","loadAndEditFileFromTag","loadAndDisplayFileFromTag","displaySelectedMediaFileFromTag","MetaListEmptyMessage","MetaList","TreeAndTagList","showTreeOrTag","CREATE_FOLDER","callback","handleClose","variant","CREATE_FILE","CHOOSE_LOCATION","ThreeDotsMenu","anchorEl","currentTarget","marginLeft","aria-label","aria-owns","aria-haspopup","onClose","BreadcrumbText","handleClickPath","rootTitle","handleGoBack","canGoBack","separator","rootPath","data-index","lastPath","directories","display","breakpoints","up","root","marginBottom","grow","flexGrow","menuButton","marginRight","title","search","position","borderRadius","shape","fade","palette","common","white","searchIcon","pointerEvents","alignItems","justifyContent","inputRoot","inputInput","paddingTop","paddingRight","paddingBottom","paddingLeft","transition","transitions","create","handleChange","moveUpwards","n","moveFolderUpwardsAndRefresh","handleRefresh","noWrap","placeholder","input","MOVE","RENAME","archiveName","generateAsync","downloadName","ContextMenu","acts","anchorReference","anchorPosition","top","left","transformOrigin","vertical","horizontal","PaperProps","EditAction","RenameAction","getActionsForMultipleItems","getActionsForItem","getActionsForFile","getActionsForFolder","actions","isExtractable","HistoryHandler","history","states","stateIndex","createBrowserHistory","listen","handlePop","handleReplace","handlePush","updateBrowserHistory","prevState","locationsEqual","encodeURI","newState","getLocationObjectFromUrl","origin","URLSearchParams","FormDialog","isLoggedIn","encodedUrl","targetForm","form","querySelector","handleLogin","handleLogout","aria-labelledby","fullWidth","maxWidth","gutterBottom","autoFocus","label","lastBlobUrl","blobUrl","src","alt","isVideo","iconUrl","textField","createRef","fetch","t","current","textArea","minHeight","defaultValue","ref","handleSave","updateTextFile","jsonp","callback2","callbackName","round","random","data","script","MultiValueLabel","styles","tagHandleClick","AutocompleteTag","creatableSelect","source","lastStr","handleRadioChange","suggests","focusCreatableSelect","focus","setSaveTextParameter","saveTextLevel","setSaveText","str","retVal","callback1","searchedString","autoComplete","CallJsonP","suggestion","target","control","labelPlacement","components","options","isMulti","handleChangeTagList","onInputChange","selectAllToCentral","saveText","itemUrl","getOrInitMeta","cleanedTags","extension","spl","fullScreen","overflow","native","inputRef","createNewFolder","previousName","FileSublist","FileListSublist","handleOpenFolder","initialHost","prevProps","updateItems","ApiHandler","actionName","disabled","move","targetLocation","ChooseLocation","copy","UploadFileList","list","FileUploader","inputElement","handleReset","handleSelectedFiles","inputfile","inputreset","htmlFor","multiple","canUpload","Dialogs","DynamicSnackbar","errorMsg","notificationDuration","anchorOrigin","autoHideDuration","ContentProps","close","createMuiTheme","typography","useNextVariants","App","init","handleHideContextMenu","Navbar","element","tagName","store","createStore","reducer","applyMiddleware","thunk","ReactDOM","render","getElementById","process","addEventListener","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.d5052ad3.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 588;","var map = {\n\t\"./N3Lexer\": 199,\n\t\"./N3Lexer.js\": 199,\n\t\"./N3Parser\": 200,\n\t\"./N3Parser.js\": 200,\n\t\"./N3Store\": 307,\n\t\"./N3Store.js\": 307,\n\t\"./N3StreamParser\": 308,\n\t\"./N3StreamParser.js\": 308,\n\t\"./N3StreamWriter\": 309,\n\t\"./N3StreamWriter.js\": 309,\n\t\"./N3Util\": 201,\n\t\"./N3Util.js\": 201,\n\t\"./N3Writer\": 202,\n\t\"./N3Writer.js\": 202\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 611;","//import { Item } from \"../Api/Item\";\r\n\r\nexport interface Action<V> {\r\n    type: string;\r\n    value: V;\r\n};\r\n\r\nexport const SET_ERROR_MESSAGE = 'SET_ERROR_MESSAGE';\r\nexport const ENTER_FOLDER = 'ENTER_FOLDER';\r\nexport const MOVE_FOLDER_UPWARDS = 'MOVE_FOLDER_UPWARDS';\r\nexport const SET_PATH = 'SET_PATH';\r\n\r\nexport const SET_LOGGED_IN = 'SET_LOGGED_IN';\r\nexport const SET_LOGGED_OUT = 'SET_LOGGED_OUT';\r\nexport const RESET_HOST = 'RESET_HOST';\r\nexport const SET_HOST = 'SET_HOST'; // TODO: Consider renaming to BASE_URL\r\nexport const RESET_WEB_ID = 'RESET_WEB_ID';\r\nexport const SET_WEB_ID = 'SET_WEB_ID';\r\n\r\nexport const SET_ITEMS = 'SET_ITEMS';\r\nexport const SET_METAS = 'SET_METAS';\r\n\r\nexport const SELECT_ITEMS = 'SELECT_ITEMS';\r\nexport const TOGGLE_SELECTED_ITEM = 'TOGGLE_SELECTED_ITEM';\r\nexport const DESELECT_ITEM = 'DESELECT_ITEM';\r\n\r\nexport const FILTER_ITEMS = 'FILTER_ITEMS';\r\nexport const RESET_FILTER = 'REMOVE_FILTER';\r\n\r\nexport const DISPLAY_LOADING = 'DISPLAY_LOADING';\r\nexport const STOP_LOADING = 'STOP_LOADING';\r\n\r\nexport const RESET_LOADED_BLOB = 'RESET_LOADED_BLOB';\r\nexport const SET_LOADED_BLOB = 'SET_LOADED_BLOB';\r\n\r\nexport const SET_UPLOAD_FILE_PROGRESS = 'SET_UPLOAD_FILE_PROGRESS';\r\nexport const SET_UPLOAD_FILE_LIST = 'SET_UPLOAD_FILE_LIST';\r\n\r\nexport const OPEN_CONTEXT_MENU = 'OPEN_CONTEXT_MENU';\r\nexport const CLOSE_CONTEXT_MENU = 'CLOSE_CONTEXT_MENU';\r\n\r\nexport const OPEN_DIALOG = 'OPEN_DIALOG';\r\nexport const CLOSE_DIALOG = 'CLOSE_DIALOG';\r\n\r\nexport enum DIALOGS {\r\n    CHOOSE_LOCATION = 'CHOOSE_LOCATION',\r\n    CREATE_FOLDER = 'CREATE_FOLDER',\r\n    CREATE_FILE = 'CREATE_FILE',\r\n    UPLOAD_FILE = 'UPLOAD_FILE',\r\n    RENAME = 'RENAME',\r\n    EDITTAGS = 'EDITTAGS',\r\n    MOVE = 'MOVE',\r\n    COPY = 'COPY',\r\n    CONTENT = 'CONTENT',\r\n    MEDIA = 'MEDIA',\r\n    EDIT = 'EDIT',\r\n    CONTEXT_MENU = 'CONTEXT_MENU',\r\n};","let host: string | null = null;\r\n\r\nexport default {\r\n    getHost() {\r\n        return host;\r\n    },\r\n    setHost(newHost: string) {\r\n        host = newHost;\r\n        while (host.endsWith('/'))\r\n            host = host.slice(0, -1);\r\n    }\r\n};\r\n","import { Action, SET_LOGGED_IN, SET_LOGGED_OUT, SET_HOST, SET_WEB_ID, RESET_HOST, RESET_WEB_ID } from \"../Actions/actionTypes\";\r\nimport config from \"../config\";\r\n\r\ninterface AccountState {\r\n    loggedIn: boolean;\r\n    host: string | null;\r\n    webId: string | null;\r\n}\r\n\r\nconst initialState: AccountState = {\r\n    loggedIn: false,\r\n    host: null,\r\n    webId: null\r\n};\r\n\r\nexport const account = (state = initialState, action: Action<string|null|void>): AccountState => {\r\n    switch(action.type) {\r\n        case SET_LOGGED_IN:\r\n            return { ...state, loggedIn: true };\r\n        case SET_LOGGED_OUT:\r\n            return { ...state, loggedIn: false };\r\n        case SET_HOST:\r\n            config.setHost(action.value as string); // TODO\r\n            return { ...state, host: action.value as string };\r\n        case RESET_HOST:\r\n            return { ...state, host: null };\r\n        case SET_WEB_ID:\r\n            return { ...state, webId: action.value as string|null };\r\n        case RESET_WEB_ID:\r\n            return { ...state, webId: null };\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n","import { DIALOGS, Action, OPEN_DIALOG, CLOSE_DIALOG, OPEN_CONTEXT_MENU, CLOSE_CONTEXT_MENU } from \"../Actions/actionTypes\";\r\n\r\n// Initialize state with values of DIALOGS as keys and false (closed) as value\r\nconst initialVisibleDialogs: Record<DIALOGS, boolean> = Object.values(DIALOGS)\r\n    .map((name: DIALOGS) => ({ [name]: false } as Record<DIALOGS, boolean>))\r\n    .reduce((prev, cur) => ({ ...prev, ...cur })) as Record<DIALOGS, boolean>;\r\n\r\nexport const visibleDialogs = (state = initialVisibleDialogs, action: Action<DIALOGS>): typeof initialVisibleDialogs => {\r\n    switch (action.type) {\r\n        case OPEN_DIALOG:\r\n            return { ...state, [action.value]: true };\r\n        case CLOSE_DIALOG:\r\n            return { ...state, [action.value]: false };\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nconst initialContextMenuState = {\r\n    open: false,\r\n    x: 0,\r\n    y: 0,\r\n};\r\n\r\nexport const contextMenu = (state = initialContextMenuState, action: Action<any>): typeof initialContextMenuState => {\r\n    switch (action.type) {\r\n        case OPEN_CONTEXT_MENU:\r\n            return {\r\n                ...state,\r\n                open: true,\r\n                x: action.value.x,\r\n                y: action.value.y\r\n            };\r\n        case CLOSE_CONTEXT_MENU:\r\n            return { ...state, open: false };\r\n        default:\r\n            return state;\r\n    }\r\n};","import { Item } from \"../Api/Item\";\r\n\r\nimport { Action, SET_ITEMS, SELECT_ITEMS, DESELECT_ITEM, FILTER_ITEMS, RESET_FILTER, TOGGLE_SELECTED_ITEM } from \"../Actions/actionTypes\";\r\n\r\ninterface ItemsState {\r\n    inCurFolder: Item[];\r\n    filter: string;\r\n    selected: Item[];\r\n}\r\n\r\nconst initialItemsState: ItemsState = {\r\n    inCurFolder: [],\r\n    filter: '',\r\n    selected: [],\r\n};\r\n\r\nexport const items = (state = initialItemsState, action: Action<any>): ItemsState => {\r\n    switch (action.type) {\r\n        case SET_ITEMS:\r\n            return { ...state, inCurFolder: action.value as Item[] };\r\n        case SELECT_ITEMS:\r\n            return { ...state, selected: action.value as Item[] };\r\n        case DESELECT_ITEM:\r\n            return { ...state, selected: removeItem(state.selected, action.value as Item) };\r\n        case TOGGLE_SELECTED_ITEM:\r\n            return {\r\n                ...state,\r\n                selected: state.selected.includes(action.value) ?\r\n                    removeItem(state.selected, action.value as Item)\r\n                    : addItem(state.selected, action.value as Item)\r\n            };\r\n        case FILTER_ITEMS:\r\n            return { ...state, filter: action.value as string };\r\n        case RESET_FILTER:\r\n            return { ...state, filter: '' };\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nconst removeItem = (items: Item[], item: Item) => {\r\n    return items.filter(selectedItem => !selectedItem.equals(item));\r\n}\r\n\r\nconst addItem = (items: Item[], item: Item) => {\r\n    return [...items, item];\r\n}\r\n","import { Meta } from \"../Api/MetaUtils\";\r\nimport { Action, SET_METAS } from \"../Actions/actionTypes\";\r\n\r\ninterface MetasState {\r\n    inCurFolder: Meta[];\r\n    filter: string;\r\n    selected: Meta[];\r\n}\r\n\r\nconst initialMetasState: MetasState = {\r\n    inCurFolder: [],\r\n    filter: '',\r\n    selected: [],\r\n};\r\n\r\nexport const metas = (state = initialMetasState, action: Action<any>): MetasState => {\r\n    switch (action.type) {\r\n        case SET_METAS:\r\n            return { ...state, inCurFolder: action.value as Meta[] };\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n","import { Action, ENTER_FOLDER, SET_PATH, MOVE_FOLDER_UPWARDS } from \"../Actions/actionTypes\";\r\n\r\n\r\nconst initialPath: string[] = [];\r\n\r\nexport const path = (state = initialPath, action: Action<any>): typeof initialPath => {\r\n    switch(action.type) {\r\n        case ENTER_FOLDER:\r\n            return [...state, action.value];\r\n        case MOVE_FOLDER_UPWARDS:\r\n            return action.value > 0 ?\r\n                state.slice(0, -action.value)\r\n                : state;\r\n        case SET_PATH:\r\n            return [...action.value];\r\n        default:\r\n            return state;\r\n    }\r\n};","import { Action, SET_UPLOAD_FILE_LIST, SET_UPLOAD_FILE_PROGRESS } from \"../Actions/actionTypes\";\r\n\r\nconst initialUploadState = {\r\n    fileList: null as FileList|null,\r\n    progress: 0,\r\n};\r\n\r\nexport const upload = (state = initialUploadState, action: Action<FileList|number>): typeof initialUploadState => {\r\n    switch(action.type) {\r\n        case SET_UPLOAD_FILE_LIST:\r\n            return { ...state, fileList: action.value as FileList };\r\n        case SET_UPLOAD_FILE_PROGRESS:\r\n            return { ...state, progress: action.value as number };\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n","import { combineReducers } from 'redux';\r\nimport { account } from './accountReducer';\r\nimport { blob } from './currentBlobReducer';\r\nimport { visibleDialogs, contextMenu } from './dialogsReducer';\r\nimport { errorMessage } from './errorReducer';\r\nimport { items } from './itemsReducer';\r\nimport { metas } from './metasReducer';\r\nimport { loading } from './loadingReducer';\r\nimport { path } from './pathReducer';\r\nimport { upload } from './uploadReducer';\r\n\r\nconst rootReducer = combineReducers({\r\n    account,\r\n    blob,\r\n    contextMenu,\r\n    visibleDialogs,\r\n    errorMessage,\r\n    items,\r\n    loading,\r\n    path,\r\n    upload,\r\n    metas\r\n});\r\n\r\nexport default rootReducer;\r\nexport type AppState = ReturnType<typeof rootReducer>;","import { Action, SET_LOADED_BLOB, RESET_LOADED_BLOB } from \"../Actions/actionTypes\";\r\n\r\nexport const blob = (state: string|null = null, action: Action<Blob>): typeof state => {\r\n    switch(action.type) {\r\n        case SET_LOADED_BLOB:\r\n            return URL.createObjectURL(action.value);\r\n        case RESET_LOADED_BLOB:\r\n            if (state !== null)\r\n                URL.revokeObjectURL(state);\r\n            return null;\r\n        default:\r\n            return state;\r\n    }\r\n};","import { Action, SET_ERROR_MESSAGE } from \"../Actions/actionTypes\";\r\n\r\nexport const errorMessage = (state = '', action: Action<string>): typeof state => {\r\n    switch(action.type) {\r\n        case SET_ERROR_MESSAGE:\r\n            return action.value;\r\n        default:\r\n            return state;\r\n    }\r\n};","import { Action, DISPLAY_LOADING, STOP_LOADING } from \"../Actions/actionTypes\";\r\n\r\nconst initialLoadingState: boolean = false;\r\n\r\nexport const loading = (state = initialLoadingState, action: Action<void>): boolean => {\r\n    switch(action.type) {\r\n        case DISPLAY_LOADING:\r\n            return true;\r\n        case STOP_LOADING:\r\n            return false;\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read http://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config: ServiceWorkerConfig) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config: ServiceWorkerConfig) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config: ServiceWorkerConfig) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n\r\n\r\nexport interface ServiceWorkerConfig {\r\n  onUpdate(registration: ServiceWorkerRegistration): void;\r\n  onSuccess(registration: ServiceWorkerRegistration): void;\r\n}","import config from '../config';\r\nimport * as solidAuth from 'solid-auth-client';\r\nconst FileClient = require('solid-file-client');\r\n\r\nexport interface IFolder {\r\n    type: \"folder\";\r\n    name: string; // folder name (without path),\r\n    url: string; // full URL of the resource,\r\n    modified: string; // dcterms:modified date\r\n    mtime: string; // stat:mtime\r\n    size: number;// stat:size\r\n    parent: string;// parentFolder or undef if none,\r\n    content: string; // raw content of the folder's turtle representation,\r\n    files: Array<any>; // an array of files in the folder\r\n    folders: IFolder[];// an array of sub-folders in the folder,\r\n    known?: boolean;//details of sub folders are read (in treeview)\r\n}\r\n\r\nexport default class FileUtils {\r\n\r\n    static serverId: string = ''\r\n    static webId: string = ''\r\n\r\n    //Interface method for FileClient.popupLogin\r\n    static async fileClientPopupLogin() {\r\n        await FileClient.popupLogin()\r\n            .then(\r\n                (webId: string) => {\r\n                    const serverId = webId.split(\"/card\")[0];\r\n                    this.serverId = serverId\r\n                    this.webId = webId\r\n                    console.log(`Logged in as ${webId} on ${serverId}.`);\r\n                }\r\n                , (err: any) => console.log('Error while loging' + err)\r\n            )\r\n    }\r\n\r\n    static sleep(ms: number) {\r\n        return new Promise(resolve => setTimeout(resolve, ms));\r\n    }\r\n\r\n    static webIdAndHost = {webId: '', baseUrl: ''}\r\n    static async getWebIdAndHost() {\r\n        if (this.webIdAndHost.webId === '') {\r\n            let baseUrl = config.getHost()\r\n            while (baseUrl === null) {\r\n                await this.sleep(1000)\r\n                baseUrl = config.getHost()\r\n            }\r\n            const session = await solidAuth.currentSession()\r\n            let webId = session ? session.webId : ''\r\n            this.webIdAndHost = { webId: webId, baseUrl: baseUrl }\r\n        }\r\n        return this.webIdAndHost\r\n    }\r\n\r\n    static async fileClientReadFolder(fileName: string) {\r\n        const infos = await this.getWebIdAndHost()\r\n        let res = {} as IFolder;\r\n        await FileClient.readFolder(fileName).then((content: IFolder) => {\r\n            content.name = decodeURI(content.name)\r\n            content.folders.forEach((f: IFolder) => {\r\n                f.name = decodeURI(f.name)\r\n                f.folders = []\r\n            })\r\n            res = content\r\n        }, (err: any) => {\r\n            alert(`User ${infos.webId} is not able to read folder ${fileName} on Pod ${infos.baseUrl}`)\r\n        });\r\n        return res\r\n    }\r\n\r\n\r\n    //Interface method for FileClient.readFile\r\n    static async fileClientReadFileAsString(url: string) {\r\n        let res: string = ''\r\n        await FileClient.readFile(url).then(\r\n            (body: string) => {\r\n                res = body\r\n            }\r\n            , (err: any) => {\r\n                console.log(`Error when reading file ${url}, returning blank`)\r\n                //throw new Error(\"read error  \" + err)\r\n            });\r\n        return res as string\r\n    }\r\n\r\n    //Interface method for FileClient.createFile\r\n    static async fileClientcreateFile(url: string) {\r\n        FileClient.createFile(url)\r\n            .then(\r\n                () => { return true }\r\n                , (err: any) => console.log('Error while creating file ' + url)\r\n            )\r\n    }\r\n\r\n    //Interface method for FileClient.updateFile\r\n    static async fileClientupdateFile(url: string, newContent: string) {\r\n        FileClient.updateFile(url, newContent)\r\n            .then(\r\n                () => { return true }\r\n                , (err: any) => console.log('Error while updating file ' + url)\r\n            )\r\n    }\r\n}","/**\r\n * Class for an arbitrary item from a solid pod\r\n */\r\nexport class Item {\r\n    _name: string;\r\n    _path: string[];\r\n    _url: string;\r\n    _size?: string\r\n\r\n    constructor(url: string, size?: string) {\r\n        const path = getPathFromUrl(url);\r\n\r\n        this._name = path.pop() || '';\r\n        this._path = path;\r\n        this._url = url;\r\n        this._size = size;\r\n    }\r\n\r\n    // Make properties readonly\r\n    get name() { return this._name; }\r\n    get path() { return this._path; }\r\n    get url() { return this._url; }\r\n    get size() { return this._size; }\r\n\r\n    equals(item: Item) {\r\n        return this.name === item.name\r\n            && this.path.length === item.path.length\r\n            && this.path.every((val, index) => val === item.path[index]);\r\n    }\r\n\r\n    getUrl() {\r\n        return this.url;\r\n    }\r\n    \r\n    getDisplayName() {\r\n        return decodeURI(this.name);\r\n    }\r\n\r\n    getDisplaySize() {\r\n        return this._size ? getHumanFileSize(this._size) : 'Unknown size';\r\n    }\r\n}\r\n\r\nexport class FileItem extends Item {\r\n    isImage() {\r\n        return patterns.image.test(this.name);\r\n    }\r\n\r\n    isMedia() {\r\n        return patterns.media.test(this.name);\r\n    }\r\n\r\n    isEditable() {\r\n        return patterns.editable.test(this.name);\r\n    }\r\n\r\n    isExtractable() {\r\n        return patterns.extractable.test(this.name);\r\n    }\r\n\r\n    isVideo() {\r\n        return patterns.video.test(this.name);\r\n    }\r\n}\r\n\r\nexport class FolderItem extends Item { }\r\n\r\n\r\n// regex patterns for testing if a file is of a specific type\r\nconst patterns = {\r\n    editable: /\\.(txt|diff?|patch|svg|asc|cnf|cfg|conf|html?|cfm|cgi|aspx?|ini|pl|py|md|css|cs|jsx?|jsp|log|htaccess|htpasswd|gitignore|gitattributes|env|json|atom|eml|rss|markdown|sql|xml|xslt?|sh|rb|as|bat|cmd|cob|for|ftn|frm|frx|inc|lisp|scm|coffee|php[3-6]?|java|c|cbl|go|h|scala|vb|tmpl|lock|go|yml|yaml|tsv|lst|ttl)$/i,\r\n    image: /\\.(jpe?g|gif|bmp|png|svg|tiff?)$/i,\r\n    media: /\\.(mp3|ogg|wav|mp4|webm)$/i,\r\n    video: /\\.(mp4|webm|ogg)$/i,\r\n    extractable: /\\.(zip)$/i\r\n};\r\n\r\n/**\r\n * Calculate file size by bytes in human readable format\r\n */\r\nexport const getHumanFileSize = (byteString: string|number): string => {\r\n    const bytes = typeof byteString === 'string' ?\r\n        parseInt(byteString)\r\n        : byteString;\r\n    const e = (Math.log(bytes) / Math.log(1e3)) | 0;\r\n    return +(bytes / Math.pow(1e3, e)).toFixed(2) + ' ' + ('kMGTPEZY'[e - 1] || '') + 'B';\r\n};\r\n\r\n\r\n/**\r\n * Get path including the last element (e.g. [public, test, index.html])\r\n */\r\nconst getPathFromUrl = (urlString: string): string[] => {\r\n    const url = new URL(urlString);\r\n    return url.pathname.split('/').filter(val => val !== '');\r\n}","// Based on https://github.com/jeff-zucker/solid-file-client/blob/master/src/folderUtils\r\nimport * as rdflib from 'rdflib';\r\nimport { FileItem, FolderItem } from './Item';\r\nimport { FolderItems } from './types';\r\n\r\nexport function getSizeByGraph(graph: rdflib.IndexedFormula, subjectName: string): string | undefined {\r\n    const subjectNode = rdflib.sym(subjectName);\r\n    const nsSize = rdflib.sym('http://www.w3.org/ns/posix/stat#size');\r\n    const size = graph.any(subjectNode, nsSize, undefined, undefined);\r\n\r\n    return (size && 'value' in size) ? size.value : undefined;\r\n}\r\n\r\n/**\r\n * @param {rdflib.IndexedFormula} graph a rdflib.graph() database instance\r\n * @param {string} baseUrl location of the folder\r\n * @returns {boolean}\r\n */\r\nexport function isFolder(graph: rdflib.IndexedFormula, baseUrl: string): boolean {\r\n    const folderNode = rdflib.sym(baseUrl);\r\n    const isAnInstanceOfClass = rdflib.sym('http://www.w3.org/1999/02/22-rdf-syntax-ns#type');\r\n    const types = graph.each(folderNode, isAnInstanceOfClass, undefined, undefined);\r\n    return Object.values(types)\r\n        .some(({ value }) => value.match('ldp#BasicContainer') !== null);\r\n}\r\n\r\nexport function getFolderItems(graph: rdflib.IndexedFormula, subj: string): FolderItems {\r\n    const files: FileItem[] = [];\r\n    const folders: FolderItem[] = [];\r\n\r\n    graph.each(\r\n        rdflib.sym(subj),\r\n        rdflib.sym('http://www.w3.org/ns/ldp#contains'),\r\n        undefined,\r\n        undefined\r\n    ).forEach(item => {\r\n        const url = item.value;\r\n        const size = getSizeByGraph(graph, url);\r\n\r\n        if (isFolder(graph, url))\r\n            folders.push(new FolderItem(url, size));\r\n        else\r\n            files.push(new FileItem(url, size));\r\n    });\r\n\r\n    return { files, folders };\r\n}\r\n\r\n/**\r\n * @param {string} text RDF text that can be passed to $rdf.parse()\r\n * @param {string} baseUrl the base url of the item\r\n * @param {string} contentType Content-Type of the request\r\n * @returns {Promise<rdflib.IndexedFormula>} a rdfilb.graph() database instance with parsed RDF\r\n */\r\nexport async function text2graph(text: string, baseUrl: string, contentType: string = ''): Promise<rdflib.IndexedFormula> {\r\n    contentType = contentType || guessFileType(baseUrl);\r\n    const graph = rdflib.graph();\r\n\r\n    return new Promise((resolve, reject) => {\r\n        rdflib.parse(text, graph, baseUrl, contentType, () => {});\r\n        resolve(graph);\r\n    });\r\n}\r\n\r\nfunction guessFileType(url: string): string {\r\n    const ext = url.replace(/.*\\./, '');\r\n    if (ext.match(/\\/$/)) return 'dir';\r\n    if (ext.match(/(md|markdown)/)) return 'text/markdown';\r\n    if (ext.match(/html/)) return 'text/html';\r\n    if (ext.match(/xml/)) return 'text/xml';\r\n    if (ext.match(/ttl/)) return 'text/turtle';\r\n    if (ext.match(/n3/)) return 'text/n3';\r\n    if (ext.match(/rq/)) return 'application/sparql';\r\n    if (ext.match(/css/)) return 'text/css';\r\n    if (ext.match(/txt/)) return 'text/plain';\r\n    if (ext.match(/json/)) return 'application/json';\r\n    if (ext.match(/js/)) return 'application/javascript';\r\n    if (ext.match(/(png|gif|jpeg|tif)/)) return 'image';\r\n    if (ext.match(/(mp3|aif|ogg)/)) return 'audio';\r\n    if (ext.match(/(avi|mp4|mpeg)/)) return 'video';\r\n    /* default */ return 'text/turtle';\r\n}\r\n","import config from './../config';\r\nimport * as folderUtils from './folderUtils';\r\nimport * as solidAuth from 'solid-auth-client';\r\nimport { FolderItems } from './types';\r\n\r\n\r\n/**\r\n * Fetch API to get item\r\n */\r\nexport async function fetchFile(path: string, fileName?: string): Promise<Response>  {\r\n    console.log(path)\r\n    console.log(fileName)\r\n    const url = buildFileUrl(path, fileName);\r\n    console.log(url)\r\n    return solidAuth.fetch(url)\r\n        .then(assertSuccessfulResponse);\r\n};\r\n\r\n\r\n/**\r\n * Fetch API to get folder\r\n */\r\nexport async function fetchFolder(path: string, folderName?: string): Promise<Response> {\r\n    const url = buildFolderUrl(path, folderName);\r\n    return solidAuth.fetch(url, { headers: { \"Accept\": \"text/turtle\" } })\r\n        .then(assertSuccessfulResponse);\r\n};\r\n\r\n\r\n/**\r\n * Fetch API to retrieve object containing a files and folders array\r\n */\r\nexport async function readFolder(path: string, folderName?: string): Promise<FolderItems> {\r\n    const url = buildFolderUrl(path, folderName);\r\n\r\n    const response = await fetchFolder(path, folderName);\r\n    const folderRDF = await response.text();\r\n    const graph = await folderUtils.text2graph(folderRDF, url, 'text/turtle');\r\n    const folderItems = folderUtils.getFolderItems(graph, url);\r\n\r\n    return folderItems;\r\n}\r\n\r\n\r\n/**\r\n * Fetch API to move items\r\n */\r\nexport async function moveItems(path: string, destination: string, itemNames: string[]): Promise<Response> {\r\n    await copyItems(path, destination, itemNames);\r\n    return removeItems(path, itemNames);\r\n};\r\n\r\n/**\r\n * Fetch API to tag a file\r\n */\r\n\r\nexport async function editTags(path: string, oldName: string, newName: string): Promise<Response> {\r\n    await copyFile(path, oldName, path, newName);\r\n    return removeItem(path, oldName);\r\n};\r\n\r\n/**\r\n * Fetch API to rename a file\r\n */\r\nexport async function renameFile(path: string, oldName: string, newName: string): Promise<Response> {\r\n    await copyFile(path, oldName, path, newName);\r\n    return removeItem(path, oldName);\r\n};\r\n\r\n\r\n/**\r\n * Fetch API to rename a folder\r\n */\r\nexport async function renameFolder(path: string, oldFolderName: string, newFolderName: string): Promise<Response> {\r\n    await copyFolder(path, oldFolderName, path, newFolderName);\r\n    return removeFolderRecursively(path, oldFolderName);\r\n};\r\n\r\n\r\n/**\r\n * Fetch API to copy files\r\n */\r\nexport async function copyItems(path: string, destination: string, itemNames: string[]): Promise<Response> {\r\n    let { files, folders } = await readFolder(path);\r\n\r\n    files = files.filter(({ name }) => itemNames.includes(name));\r\n    folders = folders.filter(({ name }) => itemNames.includes(name));\r\n\r\n    const promises = [\r\n        ...files.map(({ name }) => copyFile(path, name, destination, name)),\r\n        ...folders.map(({ name }) => copyFolder(path, name, destination, name))\r\n    ];\r\n\r\n    await Promise.all(promises);\r\n    return new Response();\r\n};\r\n\r\n\r\n/**\r\n * Fetch API to copy a file\r\n */\r\nexport async function copyFile(originPath: string, originName: string, destinationPath: string, destinationName: string): Promise<Response> {\r\n    const fileResponse = await fetchFile(originPath, originName);\r\n    const content = await fileResponse.blob();\r\n\r\n    return createFile(destinationPath, destinationName, content);\r\n}\r\n\r\n\r\n/**\r\n * Fetch API to copy a folder recursively\r\n */\r\nexport async function copyFolder(originPath: string, originName: string, destinationPath: string, destinationName: string): Promise<Response> {\r\n    // TODO: Combine these two promises for better performance\r\n    await createFolder(destinationPath, destinationName);\r\n    const { files, folders } = await readFolder(originPath, originName);\r\n\r\n    const promises = [\r\n        ...files.map(({ name }) => copyFile(`${originPath}/${originName}`, name, `${destinationPath}/${destinationName}`, name)),\r\n        ...folders.map(({ name }) => copyFolder(`${originPath}/${originName}`, name, `${destinationPath}/${destinationName}`, name))\r\n    ];\r\n\r\n    await Promise.all(promises);\r\n    return new Response();\r\n}\r\n\r\n\r\n/**\r\n * Fetch API to upload files\r\n */\r\nexport async function upload(path: string, fileList: FileList): Promise<Response> {\r\n    const promises = Array.from(fileList).map(file => updateFile(path, file.name, file));\r\n    await Promise.all(promises);\r\n    return new Response();\r\n};\r\n\r\n\r\n/**\r\n * Fetch API to create a folder\r\n */\r\nexport async function createFolder(path: string, folderName: string): Promise<Response> {\r\n    if (await folderExists(path, folderName))\r\n        return new Response();\r\n\r\n    return createItem(path, folderName, new Blob(), '<http://www.w3.org/ns/ldp#BasicContainer>; rel=\"type\"');\r\n}\r\n\r\n\r\n/**\r\n * Fetch API to replace or create a new file\r\n */\r\nexport async function updateFile(path: string, fileName: string, content: Blob|string): Promise<Response> {\r\n    await removeItem(path, fileName);\r\n    return createFile(path, fileName, content);\r\n}\r\n\r\n\r\n/**\r\n * Fetch API to create a new file\r\n */\r\nexport async function createFile(path: string, fileName: string, content: Blob|string): Promise<Response> {\r\n    return createItem(path, fileName, content, '<http://www.w3.org/ns/ldp#Resource>; rel=\"type\"');\r\n}\r\n\r\n\r\n/**\r\n * Fetch API to create create an item\r\n */\r\nasync function createItem(path: string, itemName: string, content: Blob|string, link: string): Promise<Response> {\r\n    const baseUrl = `${config.getHost()}${path}`;\r\n    const request = {\r\n        method: 'POST',\r\n        headers: {\r\n            link,\r\n            slug: itemName,\r\n            'Content-Type': undefined as any // TODO: This hack can be removed if this issue is fixed: https://github.com/solid/node-solid-server/issues/1165\r\n        },\r\n        body: content\r\n    };\r\n\r\n    return solidAuth.fetch(baseUrl, request)\r\n        .then(assertSuccessfulResponse);\r\n}\r\n\r\n\r\n/**\r\n * Fetch API to remove multiple items\r\n */\r\nexport async function removeItems(path: string, itemNames: string[]): Promise<Response> {\r\n    return Promise.all(itemNames.map(itemName => removeItem(path, itemName)))\r\n        .then(() => new Response());\r\n};\r\n\r\n\r\n/**\r\n * Fetch API to remove one item\r\n */\r\nexport async function removeItem(path: string, itemName: string): Promise<Response> {\r\n    const url = buildFileUrl(path, itemName);\r\n\r\n    const response = await solidAuth.fetch(url, { method: 'DELETE' });\r\n    if (response.status === 409 || response.status === 301) {\r\n        // Solid pod returns 409 if the item is a folder and is not empty\r\n        // Solid pod returns 301 if is attempted to read a folder url without '/' at the end (from buildFileUrl)\r\n        return removeFolderRecursively(path, itemName);\r\n    }\r\n    else if (response.status === 404) {\r\n        // Don't throw if the item didn't exist\r\n        return response;\r\n    }\r\n    else {\r\n        assertSuccessfulResponse(response);\r\n        return response;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Fetch API to remove contents and folder itself recursively\r\n */\r\nexport async function removeFolderRecursively(path: string, folderName: string): Promise<Response> {\r\n    await removeFolderContents(path, folderName);\r\n    return removeItem(path, folderName);\r\n}\r\n\r\n\r\n/**\r\n * Fetch API to remove contents of one folder recursively\r\n */\r\nexport async function removeFolderContents(path: string, folderName: string): Promise<Response> {\r\n    const folderPath = `${path}/${folderName}`;\r\n\r\n    const { files, folders } = await readFolder(path, folderName);\r\n    const promises = [\r\n        ...files.map(({ name }) => removeItem(folderPath, name)),\r\n        ...folders.map(({ name }) => removeFolderRecursively(folderPath, name))\r\n    ];\r\n    await Promise.all(promises);\r\n    return new Response();\r\n}\r\n\r\n\r\n/**\r\n * Fetch API to check if a folder exists\r\n */\r\nexport async function folderExists(path: string, folderName: string): Promise<boolean> {\r\n    try {\r\n        await fetchFolder(path, folderName);\r\n        return true;\r\n    }\r\n    catch (error) {\r\n        if (error instanceof Response && error.status === 404)\r\n            return false;\r\n\r\n        throw error;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Build up an url from a path relative to the storage location and a folder name\r\n */\r\nfunction buildFolderUrl(path: string, folderName?: string): string {\r\n    return buildFileUrl(path, folderName) + '/';\r\n}\r\n\r\n\r\n/**\r\n * Build up an url from a path relative to the storage location and a fileName\r\n */\r\nfunction buildFileUrl(path: string, fileName?: string): string {\r\n    let url = `${config.getHost()}${path}/${fileName || ''}`;\r\n    while (url.slice(-1) === '/')\r\n        url = url.slice(0, -1);\r\n\r\n    return url;\r\n}\r\n\r\n\r\n/**\r\n * Throw response if fetch response was unsuccessful\r\n * @param {Response} response\r\n * @returns {Response}\r\n */\r\nfunction assertSuccessfulResponse(response: Response): Response {\r\n    if (!response.ok)\r\n        throw response;\r\n    return response;\r\n}\r\n","// eslint-disable-next-line no-unused-vars\r\nimport { Item } from './Item';\r\n\r\nexport default class ApiCache {\r\n    _data: Record<string, Item[]> = {};\r\n\r\n    /**\r\n     * Add data to the cache\r\n     */\r\n    add(path: string, itemList: Item[]): Item[] {\r\n        this._data[path] = itemList;\r\n        return itemList;\r\n    }\r\n\r\n    /**\r\n     * Return true if the url is already cached\r\n     */\r\n    contains(path: string): boolean {\r\n        return this._data.hasOwnProperty(path);\r\n    }\r\n\r\n    /**\r\n     * Get the cached data\r\n     */\r\n    get(path: string): Item[] {\r\n        return this._data[path];\r\n    }\r\n\r\n    /**\r\n     * Remove paths from the cache\r\n     */\r\n    remove(...paths: string[]) {\r\n        paths.filter(path => this.contains(path))\r\n            .forEach(path => delete this._data[path]);\r\n    }\r\n\r\n    /**\r\n     * Clear the whole cache\r\n     */\r\n    clear() {\r\n        this._data = {};\r\n    }\r\n}\r\n","import { Meta, MetaTag } from './MetaUtils';\r\n\r\n\r\ninterface CouchDbRowKeyValue {\r\n  key: string,\r\n  value: string\r\n}\r\n\r\nexport interface FoundTags {\r\n  key: string,\r\n  value: string\r\n}\r\n\r\n\r\nexport default class CouchDb {\r\n\r\n  static couchDbServerUrl = `http://127.0.0.1:5984`\r\n  static couchDbDatabaseName = `solidfilemanager`\r\n  static couchDbBaseUrl = `${CouchDb.couchDbServerUrl}/${CouchDb.couchDbDatabaseName}`\r\n\r\n  // unused.\r\n  static getMetaById(id: string) {\r\n    const xhr = this.createCORSRequest('GET', `${this.couchDbBaseUrl}/${id}`);\r\n    if (xhr) {\r\n      xhr.onload = function () {\r\n        const text = xhr.responseText;//=> ToDo return object\r\n        return text;\r\n      };\r\n      xhr.onerror = function () {\r\n        alert('Error calling request to CouchDb.');\r\n      };\r\n      xhr.send();\r\n    }\r\n  }\r\n\r\n  //List of unique used tags\r\n  static async getItemsByViewGroupedTags(): Promise<MetaTag[]> {\r\n    //   http://127.0.0.1:5984/solidfilemanager/_design/DesignDoc/_view/GroupedTags?reduce=true&group=true\r\n    const url: string = `${this.couchDbBaseUrl}/_design/DesignDoc/_view/GroupedTags?reduce=true&group=true`\r\n    let json = await this.executeQueryonCouch(url) as string\r\n    let response = JSON.parse(json)\r\n    let usedTag = [] as MetaTag[]\r\n    if (response.rows) {\r\n      response.rows.forEach((row: CouchDbRowKeyValue) => {\r\n        const tag = ({ tagType: row.key[0], value: row.key[1], published: true }) as MetaTag\r\n        usedTag.push(tag)\r\n      })\r\n    }\r\n    return usedTag\r\n  }\r\n\r\n    //List of Meta for selected Tags\r\n    static async getMetaFromTags(selectedTags: MetaTag[]): Promise<Meta[]> {\r\n      let tagsAsString = this.tagArrayTotring(selectedTags)\r\n      //   http://127.0.0.1:5984/solidfilemanager/_design/DesignDoc/_view/MetasByTags?keys=['tagValue'']\r\n      const url: string = `${this.couchDbBaseUrl}/_design/DesignDoc/_view/MetasByTags?keys=${tagsAsString}`\r\n      let json = await this.executeQueryonCouch(url) as string\r\n      let response = JSON.parse(json)\r\n      let foundMeta = [] as Meta[]\r\n      if (response.rows) {\r\n        response.rows.forEach((row: CouchDbRowKeyValue) => {\r\n          const meta = row.value as unknown as Meta\r\n          foundMeta.push(meta)\r\n        })\r\n      }\r\n      return foundMeta\r\n    }\r\n\r\n\r\n\r\n  //ToDo: callback to handle error (rollback on Local?)\r\n  static updateMeta(meta: Meta) {\r\n    const xhr = this.createCORSRequest('GET', `${this.couchDbBaseUrl}/${this.createIdFromMeta(meta)}`);\r\n    if (xhr) {\r\n      xhr.onload = function () {\r\n        const oldMeta = JSON.parse(xhr.responseText)\r\n        if (oldMeta && oldMeta._rev) meta._rev = oldMeta._rev\r\n        CouchDb.writeMeta(meta)\r\n      }\r\n      xhr.onerror = function () {\r\n        alert('Error reading original Meta when updating.');\r\n      };\r\n      xhr.send();\r\n    }\r\n  }\r\n\r\n  //\"privates\", only called by previous updateMeta =================================================\r\n\r\n  static executeQueryonCouch(url: string): Promise<string> {\r\n    return new Promise((resolve, reject) => {\r\n      const xhr = this.createCORSRequest('GET', url);\r\n      if (xhr) {\r\n        xhr.onload = () => {\r\n          if (xhr.status >= 200 && xhr.status < 300) {\r\n            resolve(xhr.response)\r\n          } else {\r\n            reject(xhr.statusText);\r\n          }\r\n        };\r\n        xhr.onerror = () => reject(xhr.statusText);\r\n        xhr.send();\r\n      }\r\n    })\r\n  }\r\n\r\n  static writeMeta(meta: Meta) {\r\n    const xhr = this.createCORSRequest('PUT', `${this.couchDbBaseUrl}/${this.createIdFromMeta(meta)}`);\r\n    if (xhr) {\r\n      // Response handlers.\r\n      xhr.onload = function () { };\r\n      xhr.onerror = function () {\r\n        alert('Error writing meta in CouchDb.');\r\n      };\r\n      xhr.send(JSON.stringify(meta));\r\n    }\r\n  }\r\n\r\n  // Create the XHR object.\r\n  static createCORSRequest(method: string, url: string) {\r\n    let xhr = new XMLHttpRequest();\r\n\r\n    if (\"withCredentials\" in xhr) {\r\n      // XHR for Chrome/Firefox/Opera/Safari.\r\n      xhr.open(method, url, true); //false to be sync\r\n      xhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n      //} else if (typeof XDomainRequest != \"undefined\") {\r\n      //XDomainRequest for IE.\r\n      //Error: 'XDomainRequest' is not defined  no-undef\r\n      //xhr = new XDomainRequest();\r\n      //xhr.open(method, url);\r\n    } else {\r\n      alert('CORS not supported');\r\n    }\r\n    return xhr;\r\n  }\r\n\r\n  static createIdFromMeta(meta: Meta) {\r\n    const reg = new RegExp(\"[/]\", \"g\")\r\n    return (meta.hostName + meta.pathName).replace(reg, '.')\r\n  }\r\n\r\n  static tagArrayTotring(tags: MetaTag[]) {\r\n    let tagsAsAstring = ''\r\n    let comma = ''\r\n    tags.forEach(tag => {\r\n      tagsAsAstring += `${comma}\"${tag.tagType}:${tag.value}\"`\r\n      comma = ','\r\n    })\r\n    return `[${tagsAsAstring}]`\r\n  }\r\n\r\n}\r\n","import SolidFileClientUtils from './FileUtils';\r\nimport {FolderItem} from './Item'\r\n\r\nimport lodash from 'lodash'\r\nimport { Item } from './Item';\r\nimport CouchDb from './CouchDb';\r\nimport config from '../config';\r\n\r\nconst tagDir = '/public'\r\nconst tagFileName = '_Meta.json'\r\nexport const onServerColor = 'rebeccapurple'\r\n\r\n//Same as Tag without description for Meta\r\nexport interface MetaTag {\r\n    tagType: string,\r\n    value: string,\r\n    published: boolean\r\n}\r\n\r\nexport interface Meta {\r\n    hostName: string,\r\n    pathName: string,\r\n    mimeType: string,\r\n    creationDate: Date,\r\n    tags: MetaTag[],\r\n    _rev?: string //CouchDb field \r\n}\r\n\r\nexport default class MetaUtils {\r\n\r\n    static allLocalMetas = [] as Meta[];\r\n    static currentMeta = {} as Meta;\r\n    static currentItem = {} as Item\r\n    static currentLocalUsedTags = [] as MetaTag[]\r\n\r\n    static getTagIndexFullPath() {\r\n        return `${config.getHost()}${tagDir}/${tagFileName}`\r\n    }\r\n\r\n    //Local storage, read the file and get all metas in it\r\n    static async getAllLocalMetas() {\r\n        const baseUrl = (await SolidFileClientUtils.getWebIdAndHost()).baseUrl\r\n        let allMetas = [] as Meta[]\r\n        if (this.allLocalMetas.length !== 0) allMetas = this.allLocalMetas\r\n        else {\r\n            var json: string = await SolidFileClientUtils.fileClientReadFileAsString(`${baseUrl}${tagDir}/${tagFileName}`)\r\n            if (json === '') SolidFileClientUtils.fileClientcreateFile(MetaUtils.getTagIndexFullPath())\r\n            else allMetas = JSON.parse(json)\r\n            this.allLocalMetas = allMetas\r\n        }\r\n        return allMetas\r\n    }\r\n\r\n    //List of Meta for selected tags\r\n    static async getMetaList(selectedTags: MetaTag[], showLocalOrCentral: boolean): Promise<Meta[]> {\r\n        if (!showLocalOrCentral) \r\n            return this.getLocalMetaList(selectedTags)\r\n        else \r\n            return this.getCentralMetaList(selectedTags)\r\n    }\r\n\r\n    static async getLocalMetaList(selectedTags: MetaTag[]): Promise<Meta[]> {\r\n        const allLocalMetas = await this.getAllLocalMetas() as unknown as Meta[]\r\n        let filteredMetas = [] as Meta[]\r\n        //Create a list of copies of metas filtered by view selection and only wearing selected tags\r\n        if (false) {\r\n            //Filter: AND: ToDo\r\n        } else {\r\n            //Filter: OR   \r\n            selectedTags.forEach((testTag) => {\r\n                //get metas for current testTag and reset tags to its value\r\n                let havingTagMetas = this.filterByMetaTag(allLocalMetas, testTag)\r\n                havingTagMetas.forEach(havingTagMeta => {\r\n                    //search already in filtered to add or update list\r\n                    let existingFilteredMeta =\r\n                        lodash.find(filteredMetas, function (meta) {\r\n                            return havingTagMeta.hostName + havingTagMeta.pathName === meta.hostName + meta.pathName\r\n                        })\r\n                    if (existingFilteredMeta !== undefined) {\r\n                        existingFilteredMeta.tags.push(testTag)\r\n                    } else {\r\n                        //filteredMetas: \"fakes\" Meta having only selected tags of the current view\r\n                        let havingTagMetaCopy = JSON.parse(JSON.stringify(havingTagMeta))\r\n                        havingTagMetaCopy.creationDate = new Date(0)\r\n                        havingTagMetaCopy.tags = [testTag]\r\n                        filteredMetas.push(havingTagMetaCopy)\r\n                    }\r\n                })\r\n            })\r\n        }\r\n        return filteredMetas\r\n    }\r\n\r\n    static async getCentralMetaList(selectedTags: MetaTag[]): Promise<Meta[]> {\r\n        /*\r\n        CouchDb.getMetaFromTags(selectedTags)\r\n        .then((foundMetas: Meta[]) => {\r\n            return foundMetas\r\n        })\r\n        */\r\n       return await CouchDb.getMetaFromTags(selectedTags)\r\n    }\r\n\r\n        //getLocalMetaList() helper, returns Metas having testTag\r\n    static filterByMetaTag(metas: Meta[], testTag: MetaTag) {\r\n        return lodash.filter(metas, function (meta) {\r\n            return lodash.some(meta.tags, function (tag) {\r\n                return (\r\n                    tag.tagType === testTag.tagType\r\n                    && tag.value === testTag.value\r\n                    );\r\n            });\r\n        });\r\n    }\r\n\r\n    //Get or init the meta of a file\r\n    static async getOrInitMeta(item: Item) {\r\n        const url = new URL(item.getUrl())\r\n        //init in case no better foiund\r\n        let meta = {\r\n            hostName: url.hostname,\r\n            pathName: url.pathname,\r\n            mimeType: item instanceof FolderItem ? 'FOLDER' : '',\r\n            creationDate: new Date(),\r\n            tags: []\r\n        } as unknown as Meta\r\n        //Already the current one?\r\n        if (this.currentMeta !== undefined\r\n            && this.currentMeta.hostName === url.hostname && this.currentMeta.pathName === url.pathname)\r\n            meta = this.currentMeta\r\n        else {\r\n            //Read in meta storage\r\n            const allMetas: Meta[] = await this.getAllLocalMetas()\r\n            if (allMetas !== undefined) {\r\n                const existingMeta = allMetas.filter(el => el.hostName === url.hostname && el.pathName === url.pathname)[0]\r\n                if (existingMeta !== undefined) meta = existingMeta\r\n            }\r\n        }\r\n        this.currentMeta = meta\r\n        this.currentItem = item\r\n        return meta\r\n    }\r\n\r\n    static async updateMeta(meta: Meta) {\r\n        //FILE: remove old meta from list if exists and add the new one\r\n        let allLocalMetas: Meta[] = await this.getAllLocalMetas() as unknown as Meta[]\r\n        allLocalMetas = allLocalMetas.filter(el => !(el.hostName === meta.hostName && el.pathName === meta.pathName));\r\n        allLocalMetas.push(meta)\r\n        SolidFileClientUtils.fileClientupdateFile(\r\n            MetaUtils.getTagIndexFullPath(),\r\n            JSON.stringify(allLocalMetas)\r\n        )\r\n\r\n        //COUCHDB:\r\n        let metaCopy = JSON.parse(JSON.stringify(meta)) as Meta\r\n        metaCopy.tags = metaCopy.tags.filter(tag => tag.published);\r\n        metaCopy.tags.forEach(function (tag) { delete tag.published });\r\n        CouchDb.updateMeta(metaCopy)\r\n\r\n        //FINALLY\r\n        this.currentMeta = meta\r\n        this.allLocalMetas = allLocalMetas\r\n        //update currentLocalUsedTags if already loaded\r\n        if (this.currentLocalUsedTags !== undefined) {\r\n            MetaUtils.getLocalUsedTags()\r\n                .then((foundTags: MetaTag[]) => {\r\n                    this.currentLocalUsedTags = foundTags\r\n                })\r\n        }\r\n    }\r\n\r\n    static async getLocalUsedTags() {\r\n        let usedTags = [] as MetaTag[]\r\n        if (this.currentLocalUsedTags.length !== 0) usedTags = this.currentLocalUsedTags\r\n        else {\r\n            let allMetas: Meta[] = await this.getAllLocalMetas() as unknown as Meta[]\r\n            //get list of tags in meta\r\n            let foundTags = [] as MetaTag[]\r\n            if (allMetas) {\r\n                allMetas.forEach(meta => {\r\n                    if (meta.tags) {\r\n                        meta.tags.forEach(tag => {\r\n                            foundTags.push(tag)\r\n                        })\r\n                    }\r\n                })\r\n            }\r\n            usedTags = lodash.uniqWith(foundTags, function (first, second) {\r\n                return first.tagType === second.tagType && first.value === second.value\r\n            });\r\n            usedTags = lodash.sortBy(usedTags, ['tagType', 'value']);\r\n        }\r\n        return usedTags\r\n    }\r\n\r\n    //Get tags on Central and mark them \"also on local?\"\r\n    static async getCentralUsedTags(): Promise<Array<any>> {\r\n        return new Promise((resolve, reject) => {\r\n            CouchDb.getItemsByViewGroupedTags()\r\n                .then(\r\n                    (centralTags: MetaTag[]) => {\r\n                        //meta.published property fakely used as \"central tag not published on this local?\"\r\n                        centralTags.forEach(centralTag => { centralTag.published = false })\r\n                        MetaUtils.getLocalUsedTags()\r\n                            .then((localTags: MetaTag[]) => {\r\n                                //refresh cache as we have the value\r\n                                this.currentLocalUsedTags = localTags\r\n                                localTags.forEach(localTag => {\r\n                                    if (localTag.published === true) {\r\n                                        this.markCentralFromLocal(centralTags, localTag)\r\n                                    }\r\n                                })\r\n                                resolve(centralTags)\r\n                            })\r\n                    }\r\n                )\r\n        })\r\n\r\n    }\r\n\r\n    //getCentralUsedTags() helper: marks published=true to central tags found in local tags\r\n    static markCentralFromLocal(centralTags: MetaTag[], localTag: MetaTag) {\r\n        let publishedTags: MetaTag[] = lodash.filter(\r\n            centralTags,\r\n            function (tag) { return (tag.value === localTag.value) }\r\n        )\r\n        //publishedTags.length should be 0 or 1\r\n        publishedTags.forEach((tag: MetaTag) => tag.published = true)\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n\r\n","import * as API from './Api';\r\nimport JSZip from 'jszip';\r\nimport { FileItem, FolderItem, Item } from './Item';\r\nimport ApiCache from './ApiCache';\r\nimport MetaUtils, { Meta, MetaTag } from './MetaUtils';\r\n\r\nconst cache = new ApiCache();\r\n\r\n/**\r\n * Log a fetch response error and throw it again\r\n * @param {*} error \r\n */\r\nconst handleFetchError = async (error: Error | Response | string) => {\r\n    let detailedErrorMessage = '';\r\n    let displayErrorMessage: string | undefined;\r\n\r\n    console.group('handleFetchError');\r\n    if (error instanceof Response) {\r\n        detailedErrorMessage = await error.text();\r\n\r\n        console.error(`url: ${error.url}`);\r\n        console.error(`status: ${error.status}`);\r\n\r\n        const displayMessages: Record<string, string> = {\r\n            '401': `The ressource at ${error.url} requires you to login.`,\r\n            '403': `You don't have permission to access the ressource at ${error.url}.\r\n            Please make sure that you are logged in with the correct account.\r\n            If the server runs with version 5.0.0 or higher, make sure you gave this app read/write permission`,\r\n            '404': `The ressource at ${error.url} was not found`,\r\n            '500': `An internal server error occured...\r\n            ${detailedErrorMessage}`,\r\n        };\r\n        if (error.status in displayMessages)\r\n            displayErrorMessage = displayMessages[error.status];\r\n    }\r\n    else if (error instanceof Error) {\r\n        detailedErrorMessage = error.message;\r\n        console.error(error.stack);\r\n    }\r\n    else if (typeof error === 'string') {\r\n        detailedErrorMessage = error;\r\n    }\r\n    else {\r\n        detailedErrorMessage = JSON.stringify(error);\r\n    }\r\n    console.error(`errorMessage: ${detailedErrorMessage}`);\r\n    console.error(`error: ${error}`);\r\n    console.groupEnd();\r\n\r\n    throw new Error((displayErrorMessage) ? displayErrorMessage : detailedErrorMessage);\r\n}\r\n\r\n/**\r\n * Clean path string removing double slashes and prepending a slash if non-empty\r\n */\r\nconst fixPath = (path: string): string => {\r\n    if (path === \"\")\r\n        return path;\r\n    return ('/' + path).replace(/\\/\\//g, '/');\r\n};\r\n\r\n/**\r\n * Wrap API response for retrieving item list\r\n * itemList is cached automatically\r\n * @param {String} path\r\n * @returns {Promise<API.FolderItems>}\r\n */\r\nexport const getItemList = (path: string): Promise<Item[]> => {\r\n    path = fixPath(path);\r\n    if (cache.contains(path))\r\n        return Promise.resolve(cache.get(path));\r\n    return API.readFolder(path)\r\n        .then(({ files, folders }) => [...files, ...folders])\r\n        .then(itemList => cache.add(path, itemList))\r\n        .catch(handleFetchError);\r\n};\r\n\r\nexport const clearCacheForFolder = (path: string) => cache.remove(fixPath(path));\r\nexport const clearCache = () => cache.clear();\r\n\r\n/**\r\n * Wrap API response for retrieving file content\r\n */\r\nexport const getFileBlob = (path: string, filename: string): Promise<Blob> => {\r\n    path = fixPath(path);\r\n    return API.fetchFile(path, filename)\r\n        .then(response => response.blob())\r\n        .catch(handleFetchError);\r\n};\r\n\r\n/**\r\n * Wrap API response for taging a file\r\n */\r\nexport const editTags = (path: string, fileName: string, newFileName: string): Promise<Response> => {\r\n    path = fixPath(path);\r\n    cache.remove(path);\r\n    return API.editTags(path, fileName, newFileName)\r\n        .catch(handleFetchError)\r\n};\r\n\r\n/**\r\n * Wrap API response for renaming a file\r\n */\r\nexport const renameFile = (path: string, fileName: string, newFileName: string): Promise<Response> => {\r\n    path = fixPath(path);\r\n    cache.remove(path);\r\n    return API.renameFile(path, fileName, newFileName)\r\n        .catch(handleFetchError)\r\n};\r\n\r\n/**\r\n * Wrap API response for renaming a folder\r\n */\r\nexport const renameFolder = (path: string, folderName: string, newFolderName: string): Promise<Response> => {\r\n    path = fixPath(path);\r\n    cache.remove(path);\r\n    return API.renameFolder(path, folderName, newFolderName)\r\n        .catch(handleFetchError)\r\n};\r\n\r\n/**\r\n * Wrap API response for creating a folder\r\n */\r\nexport const createFolder = (path: string, folderName: string): Promise<Response> => {\r\n    path = fixPath(path);\r\n    cache.remove(path);\r\n    if (!(folderName || '').trim()) {\r\n        return Promise.reject('Invalid folder name');\r\n    }\r\n    return API.createFolder(path, folderName)\r\n        .catch(handleFetchError)\r\n};\r\n\r\n/**\r\n * Wrap API response for removing a file or folder\r\n */\r\nexport const removeItems = (path: string, filenames: string[]): Promise<Response> => {\r\n    path = fixPath(path);\r\n    cache.remove(path);\r\n    if (!filenames.length) {\r\n        return Promise.reject('No files to remove');\r\n    }\r\n    return API.removeItems(path, filenames)\r\n        .catch(handleFetchError)\r\n};\r\n\r\n/**\r\n * Wrap API response for moving a file or folder\r\n */\r\nexport const moveItems = (path: string, destination: string, filenames: string[]): Promise<Response> => {\r\n    path = fixPath(path);\r\n    destination = fixPath(destination);\r\n    cache.remove(path, destination);\r\n    if (!filenames.length) {\r\n        return Promise.reject('No files to move');\r\n    }\r\n    return API.moveItems(path, destination, filenames)\r\n        .catch(handleFetchError)\r\n};\r\n\r\n/**\r\n * Wrap API response for copying a file or folder\r\n */\r\nexport const copyItems = (path: string, destination: string, filenames: string[]): Promise<Response> => {\r\n    path = fixPath(path);\r\n    destination = fixPath(destination);\r\n    cache.remove(path, destination);\r\n    if (!filenames.length) {\r\n        return Promise.reject('No files to copy');\r\n    }\r\n    return API.copyItems(path, destination, filenames)\r\n        .catch(handleFetchError)\r\n};\r\n\r\n/**\r\n * Wrap API response for uploading files\r\n */\r\nexport const uploadFiles = (path: string, fileList: FileList): Promise<Response> => {\r\n    path = fixPath(path);\r\n    cache.remove(path);\r\n\r\n    if (!fileList.length) {\r\n        return Promise.reject('No files to upload');\r\n    }\r\n    return API.upload(path, fileList)\r\n        .catch(handleFetchError)\r\n};\r\n\r\n/**\r\n * Wrap API response for uploading a file\r\n */\r\nexport const updateFile = (path: string, fileName: string, content: Blob|string): Promise<Response> => {\r\n    path = fixPath(path);\r\n    cache.remove(path);\r\n    return API.updateFile(path, fileName, content)\r\n        .catch(handleFetchError);\r\n};\r\n\r\n/**\r\n * Wrap API response for save Meta definition (including its tags)\r\n */\r\nexport const updateMeta = (meta: Meta) => {\r\n    MetaUtils.updateMeta(meta)\r\n        .catch(handleFetchError);\r\n};\r\n\r\n/**\r\n * Wrap API to load metas of selectedTags\r\n */\r\nexport const getMetaList = (selectedTags: MetaTag[], showLocalOrCentral: boolean): Promise<Meta[]> => {\r\n    return MetaUtils.getMetaList(selectedTags, showLocalOrCentral)\r\n        .then()\r\n        .catch(handleFetchError);\r\n};\r\n\r\n/**\r\n * Wrap API response for zipping multiple items\r\n */\r\nexport const getAsZip = (path: string, itemList: Item[]): Promise<JSZip> => {\r\n    path = fixPath(path);\r\n    const zip = new JSZip();\r\n\r\n    return addItemsToZip(zip, path, itemList)\r\n        .then(() => zip);\r\n}\r\n\r\n/**\r\n * Add items to a zip object recursively\r\n */\r\nconst addItemsToZip = (zip: JSZip, path: string, itemList: Item[]): Promise<void[]> => {\r\n    const promises = itemList.map(async item => {\r\n        if (item instanceof FolderItem) {\r\n            const zipFolder = zip.folder(item.name);\r\n            const folderPath = `${path}/${item.name}`;\r\n            const folderItems = await getItemList(folderPath);\r\n            await addItemsToZip(zipFolder, folderPath, folderItems);\r\n        }\r\n        else if (item instanceof FileItem) {\r\n            const blob = await getFileBlob(path, item.name);\r\n            zip.file(item.name, blob, { binary: true });\r\n        }\r\n    });\r\n\r\n    return Promise.all(promises);\r\n}\r\n\r\n/**\r\n * Wrap API response for extracting a zip archive\r\n */\r\nexport const extractZipArchive = async (path: string, destination: string = path, fileName: string) => {\r\n    const blob = await getFileBlob(path, fileName);\r\n    const zip = await JSZip.loadAsync(blob);\r\n\r\n    return uploadExtractedZipArchive(zip, destination);\r\n};\r\n\r\n/**\r\n * Recursively upload all files and folders from an extracted zip archive\r\n */\r\nasync function uploadExtractedZipArchive(zip: JSZip, destination: string, curFolder = ''): Promise<void[]> {\r\n    const promises = getItemsInZipFolder(zip, curFolder)\r\n        .map(async item => {\r\n            const relativePath = item.name;\r\n            const itemName = getItemNameFromPath(relativePath);\r\n            const path = getParentPathFromPath(`${destination}/${relativePath}`);\r\n\r\n            if (item.dir) {\r\n                await createFolder(path, itemName);\r\n                await uploadExtractedZipArchive(zip, destination, relativePath);\r\n            }\r\n            else {\r\n                const blob = await item.async('blob');\r\n                await updateFile(path, itemName, blob);\r\n            }\r\n        });\r\n\r\n    return Promise.all(promises);\r\n};\r\n\r\nfunction getItemsInZipFolder(zip: JSZip, folderPath: string): JSZip.JSZipObject[] {\r\n    return Object.keys(zip.files)\r\n        .filter(fileName => {\r\n            // Only items in the current folder and subfolders\r\n            const relativePath = fileName.slice(folderPath.length, fileName.length);\r\n            if (!relativePath || fileName.slice(0, folderPath.length) !== folderPath)\r\n                return false;\r\n            \r\n            // No items from subfolders\r\n            if (relativePath.includes('/') && relativePath.slice(0, -1).includes('/'))\r\n                return false;\r\n\r\n            return true;\r\n        })\r\n        .map(key => zip.files[key]);\r\n};\r\n\r\nfunction getItemNameFromPath(path: string): string {\r\n    path = path.endsWith('/') ? path.slice(0, -1) : path;\r\n    return path.substr(path.lastIndexOf('/') + 1);\r\n}\r\n\r\nfunction getParentPathFromPath(path: string): string {\r\n    path = path.endsWith('/') ? path.slice(0, -1) : path;\r\n    path = path.substr(0, path.lastIndexOf('/'));\r\n    return path;\r\n}\r\n","import * as APIHandler from '../Api/ApiHandler';\r\nimport * as solidAuth from 'solid-auth-client';\r\n//import { createBrowserHistory, History } from 'history';\r\nimport { Item, FileItem, FolderItem } from '../Api/Item';\r\n//removed ENTER_FOLDER, \r\nimport { Action, SET_LOGGED_IN, SET_LOGGED_OUT, SET_HOST, SET_ITEMS, SET_METAS, SET_WEB_ID, SELECT_ITEMS, TOGGLE_SELECTED_ITEM, DESELECT_ITEM, FILTER_ITEMS, RESET_FILTER, DISPLAY_LOADING, STOP_LOADING, DIALOGS, OPEN_DIALOG, CLOSE_DIALOG, SET_LOADED_BLOB, SET_UPLOAD_FILE_LIST, SET_UPLOAD_FILE_PROGRESS, SET_PATH, MOVE_FOLDER_UPWARDS, RESET_LOADED_BLOB, RESET_HOST, RESET_WEB_ID, SET_ERROR_MESSAGE, OPEN_CONTEXT_MENU, CLOSE_CONTEXT_MENU } from './actionTypes';\r\nimport { AppState } from '../Reducers/reducer';\r\nimport { ThunkAction, ThunkDispatch } from 'redux-thunk';\r\nimport { Meta, MetaTag } from '../Api/MetaUtils';\r\n\r\nexport type MyThunk = ThunkAction<void, AppState, null, Action<any>>;\r\nexport type MyDispatch = ThunkDispatch<AppState, null, Action<any>>;\r\n\r\nexport const initApp = (): MyThunk => (dispatch, getState) => {\r\n    dispatch(updateLoginStatus());\r\n    dispatch(openDialog(DIALOGS.CHOOSE_LOCATION));\r\n};\r\n\r\n\r\nexport const solidLogin = (): MyThunk => (dispatch, getState) => {\r\n    dispatch(displayLoading());\r\n\r\n    solidPopupLogin()\r\n        .then(session => dispatch(updateLoginStatus(session)))\r\n        .catch(r => dispatch(setErrorMessage(String(r))))\r\n        .finally(() => dispatch(stopLoading()));\r\n};\r\n\r\nexport const updateLoginStatus = (session?: Session | null): MyThunk => async (dispatch, getState) => {\r\n    session = session || await solidAuth.currentSession();\r\n    if (!session) {\r\n        dispatch(setLoggedOut());\r\n        dispatch(resetWebId());\r\n    }\r\n    else {\r\n        dispatch(setWebId(session.webId));\r\n        dispatch(setLoggedIn());\r\n    }\r\n}\r\n\r\nasync function solidPopupLogin() {\r\n    return solidAuth.popupLogin({ popupUri: './vendor/solid-auth-client/popup.html' });\r\n}\r\n\r\n\r\nexport const solidLogout = (): MyThunk => (dispatch, getState) => {\r\n    dispatch(displayLoading());\r\n\r\n    solidAuth.logout()\r\n        .then(() => {\r\n            dispatch(resetPath());\r\n            dispatch(resetItems());\r\n            dispatch(resetSelectedItems());\r\n            dispatch(setLoggedOut());\r\n            dispatch(resetWebId());\r\n\r\n            dispatch(openDialog(DIALOGS.CHOOSE_LOCATION));\r\n        })\r\n        .catch(r => dispatch(setErrorMessage(String(r))))\r\n        .finally(() => dispatch(stopLoading()));\r\n};\r\n\r\nexport const clearCache = (): MyThunk => (dispatch, getState) => APIHandler.clearCache();\r\n\r\n\r\n/**\r\n * Request API to get file list for the selected path then refresh UI\r\n */\r\nexport const uploadFiles = (): MyThunk => (dispatch, getState) => {\r\n    const { path, upload: { fileList } } = getState();\r\n\r\n    if (fileList === null)\r\n        return dispatch(setErrorMessage(\"Couldn't find files to upload\"));\r\n\r\n    dispatch(displayLoading());\r\n    dispatch(resetSelectedItems());\r\n    dispatch(setFileUploadProgress(50));\r\n\r\n    APIHandler.uploadFiles(path.join('/'), fileList)\r\n        .then(r => {\r\n            dispatch(setFileUploadProgress(100));\r\n            setTimeout(f => {\r\n                dispatch(resetFileUploader());\r\n            }, 300);\r\n            dispatch(displayCurrentItemList());\r\n        })\r\n        .catch(r => dispatch(setErrorMessage(String(r))))\r\n        .finally(() => dispatch(stopLoading()));\r\n};\r\n\r\n\r\nexport const createFile = (fileName: string): MyThunk => (dispatch, getState) => {\r\n    const { path } = getState();\r\n    dispatch(displayLoading());\r\n\r\n    APIHandler.updateFile(path.join('/'), fileName, new Blob())\r\n        .then(r => {\r\n            dispatch(closeDialog(DIALOGS.CREATE_FILE));\r\n            dispatch(displayCurrentItemList());\r\n            dispatch(loadAndEditFile(fileName));\r\n            return APIHandler.getItemList(path.join('/'));\r\n        })\r\n        .then(itemList => itemList.find(item => item.getDisplayName() === fileName))\r\n        .then(item => {\r\n            if (!item)\r\n                throw new Error(\"Couldn't load created file for editing\");\r\n            dispatch(selectItem(item));\r\n            dispatch(getFileContent(item.name));\r\n        })\r\n        .catch(r => dispatch(setErrorMessage(String(r))))\r\n        .finally(() => dispatch(stopLoading()));\r\n};\r\n\r\n\r\nexport const updateTextFile = (fileName: string, content: Blob | string): MyThunk => (dispatch, getState) => {\r\n    const { path } = getState();\r\n    dispatch(displayLoading());\r\n\r\n    APIHandler.updateFile(path.join('/'), fileName, content)\r\n        .then(r => {\r\n            dispatch(closeDialog(DIALOGS.EDIT));\r\n            dispatch(displayCurrentItemList());\r\n        })\r\n        .catch(r => dispatch(setErrorMessage(String(r))))\r\n        .finally(() => dispatch(stopLoading()));\r\n}\r\n\r\n/**\r\n * Request API to get file tags  and display them\r\n */\r\nexport const loadAndEditTags = (fileName: string): MyThunk => (dispatch, getState) => {\r\n    dispatch(getFileContent(fileName));\r\n    dispatch(openDialog(DIALOGS.EDITTAGS));\r\n};\r\n\r\nexport const updateMeta = (meta: Meta): MyThunk => (dispatch, getState) => {\r\n    APIHandler.updateMeta(meta)\r\n    dispatch(closeDialog(DIALOGS.EDITTAGS));\r\n}\r\n\r\n/**\r\n * Request API to display Meta list for the selected tag\r\n */\r\nexport const getMetaList = (selectedTags: MetaTag[], showLocalOrCentral: boolean): MyThunk => (dispatch, getState) => {\r\n        dispatch(displayLoading());\r\n        APIHandler.getMetaList(selectedTags, showLocalOrCentral)\r\n            .then(items => dispatch(setMetas(items)))\r\n            .catch(r => dispatch(setErrorMessage(String(r))))\r\n            .finally(() => dispatch(stopLoading())); \r\n};\r\n\r\n/**\r\n * Request API to display file list for the selected path\r\n */\r\nexport const displayCurrentItemList = (): MyThunk => (dispatch, getState) => {\r\n    const { path } = getState();\r\n    dispatch(displayLoading());\r\n    dispatch(resetSelectedItems());\r\n    APIHandler.getItemList(path.join('/'))\r\n        .then(items => dispatch(setItems(items)))\r\n        .catch(r => dispatch(setErrorMessage(String(r))))\r\n        .finally(() => dispatch(stopLoading()));\r\n};\r\n\r\n/**\r\n * Request API to reload the file list and then refresh UI\r\n */\r\nexport const refreshItemList = (): MyThunk => (dispatch, getState) => {\r\n    const { path } = getState();\r\n    APIHandler.clearCacheForFolder(path.join('/'));\r\n    return dispatch(displayCurrentItemList());\r\n};\r\n\r\n/**\r\n * Request API to rename file then dispatch defined events\r\n */\r\nexport const renameFile = (fileName: string, newFileName: string): MyThunk => (dispatch, getState) => {\r\n    const { path } = getState();\r\n    dispatch(displayLoading());\r\n\r\n    APIHandler.renameFile(path.join('/'), fileName, newFileName)\r\n        .then(() => {\r\n            dispatch(displayCurrentItemList());\r\n            dispatch(closeDialog(DIALOGS.RENAME));\r\n        })\r\n        .catch(r => dispatch(setErrorMessage(String(r))))\r\n        .finally(() => dispatch(stopLoading()));\r\n};\r\n\r\n/**\r\n * Request API to rename folder then dispatch defined events\r\n */\r\nexport const renameFolder = (folderName: string, newFolderName: string): MyThunk => (dispatch, getState) => {\r\n    const { path } = getState();\r\n    dispatch(displayLoading());\r\n\r\n    APIHandler.renameFolder(path.join('/'), folderName, newFolderName)\r\n        .then(() => {\r\n            dispatch(displayCurrentItemList());\r\n            dispatch(closeDialog(DIALOGS.RENAME));\r\n        })\r\n        .catch(r => dispatch(setErrorMessage(String(r))))\r\n        .finally(() => dispatch(stopLoading()));\r\n};\r\n\r\n/**\r\n * Request API to download the specified items\r\n */\r\nexport const downloadItems = (items: Item[]): MyThunk => async (dispatch, getState) => {\r\n    const { path } = getState();\r\n    dispatch(displayLoading());\r\n\r\n    try {\r\n        let blob;\r\n        let downloadName = items[0].name;\r\n        if (items.length === 1 && items[0] instanceof FileItem) {\r\n            blob = await APIHandler.getFileBlob(path.join('/'), items[0].name);\r\n        }\r\n        else {\r\n            const zip = await APIHandler.getAsZip(path.join('/'), items);\r\n            blob = await zip.generateAsync({ type: 'blob' });\r\n\r\n            if (items.length > 1)\r\n                downloadName = 'Archive';\r\n            downloadName = `${downloadName}.zip`;\r\n        }\r\n\r\n        promptDownload(blob, downloadName);\r\n    }\r\n    catch (e) {\r\n        dispatch(setErrorMessage(String(e)));\r\n    }\r\n    dispatch(stopLoading());\r\n};\r\n\r\n/**\r\n * Request API to upload the items as zip archive\r\n */\r\nexport const zipAndUpload = (items: Item[]): MyThunk => (dispatch, getState) => {\r\n    const { path } = getState();\r\n    dispatch(displayLoading());\r\n\r\n    const archiveName = (items.length === 1 && items[0] instanceof FolderItem) ?\r\n        `${items[0].name}.zip`\r\n        : 'Archive.zip';\r\n\r\n    APIHandler.getAsZip(path.join('/'), items)\r\n        .then(zip => zip.generateAsync({ type: 'blob' }))\r\n        .then(blob => APIHandler.updateFile(path.join('/'), archiveName, blob))\r\n        .then(() => dispatch(displayCurrentItemList()))\r\n        .catch(r => dispatch(setErrorMessage(String(r))))\r\n        .finally(() => dispatch(stopLoading()));\r\n};\r\n\r\n/**\r\n * Request API for extracting a zip archive\r\n */\r\nexport const extractZipFile = (fileName: string): MyThunk => (dispatch, getState) => {\r\n    const { path } = getState();\r\n    dispatch(displayLoading());\r\n\r\n    APIHandler.extractZipArchive(path.join('/'), path.join('/'), fileName)\r\n        .then(r => dispatch(displayCurrentItemList()))\r\n        .catch(r => dispatch(setErrorMessage(String(r))))\r\n        .finally(() => dispatch(stopLoading()));\r\n};\r\n\r\n// code based on https://stackoverflow.com/a/30832210/6548154\r\nfunction promptDownload(file: Blob, fileName: string) {\r\n    if (window.navigator.msSaveOrOpenBlob) // IE10+\r\n        window.navigator.msSaveOrOpenBlob(file, fileName);\r\n    else { // Others\r\n        const a = document.createElement(\"a\");\r\n        const url = URL.createObjectURL(file);\r\n        a.href = url;\r\n        a.download = fileName;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        setTimeout(() => {\r\n            document.body.removeChild(a);\r\n            window.URL.revokeObjectURL(url);\r\n        }, 0);\r\n    }\r\n}\r\n\r\n/**\r\n * Opens the item in a new tab\r\n */\r\nexport const openInNewTab = (item: Item): MyThunk => (dispatch, getState) => {\r\n    window.open(item.url, '_blank');\r\n};\r\n\r\n\r\n/**\r\n * Request API to get file content then dispatch defined events\r\n */\r\nexport const getFileContent = (fileName: string): MyThunk => (dispatch, getState) => {\r\n    const { path } = getState();\r\n    dispatch(displayLoading());\r\n    dispatch(resetFileContent());\r\n\r\n    APIHandler.getFileBlob(path.join('/'), fileName)\r\n        .then(blob => dispatch(setFileContent(blob)))\r\n        .catch(r => dispatch(setErrorMessage(String(r))))\r\n        .finally(() => dispatch(stopLoading()));\r\n};\r\n\r\n\r\n/**\r\n * Request API to get file content and open the edit dialogue\r\n */\r\nexport const loadAndEditFile = (fileName: string): MyThunk => (dispatch, getState) => {\r\n    dispatch(getFileContent(fileName));\r\n    dispatch(openDialog(DIALOGS.EDIT));\r\n};\r\n\r\nexport const loadAndEditFileFromTag = (fileName: string, path: string[]): MyThunk => (dispatch, getState) => {\r\n    dispatch(setPath(path));\r\n    dispatch(loadAndEditFile(fileName));\r\n};\r\n\r\n\r\n/**\r\n * Request API to get file content and display it\r\n */\r\nexport const loadAndDisplayFile = (fileName: string): MyThunk => (dispatch, getState) => {\r\n    dispatch(getFileContent(fileName));\r\n    dispatch(openDialog(DIALOGS.CONTENT));\r\n};\r\n\r\nexport const loadAndDisplayFileFromTag = (fileName: string, path: string[]): MyThunk => (dispatch, getState) => {\r\n    dispatch(setPath(path));\r\n    dispatch(loadAndDisplayFile(fileName));\r\n};\r\n\r\n/**\r\n * Request API to display an audio or video file\r\n */\r\nexport const displaySelectedMediaFile = (): MyThunk => (dispatch, getState) => {\r\n    dispatch(openDialog(DIALOGS.MEDIA));\r\n};\r\n\r\nexport const displaySelectedMediaFileFromTag = (path: string[]): MyThunk => (dispatch, getState) => {\r\n    dispatch(setPath(path));\r\n    dispatch(displaySelectedMediaFile());\r\n};\r\n\r\n\r\n/**\r\n * Request API to create a folder then dispatch defined events\r\n */\r\nexport const createNewFolder = (folderName: string): MyThunk => (dispatch, getState) => {\r\n    const { path } = getState();\r\n    dispatch(displayLoading());\r\n\r\n    APIHandler.createFolder(path.join('/'), folderName)\r\n        .then(r => {\r\n            dispatch(displayCurrentItemList());\r\n            dispatch(closeDialog(DIALOGS.CREATE_FOLDER));\r\n        })\r\n        .catch(r => dispatch(setErrorMessage(String(r))))\r\n        .finally(() => dispatch(stopLoading()));\r\n};\r\n\r\n\r\n/**\r\n * Request API to remove multiple items\r\n */\r\nexport const removeItems = (items: Item[]): MyThunk => (dispatch, getState) => {\r\n    const { path } = getState();\r\n    dispatch(displayLoading());\r\n\r\n    const itemNames = items.map(f => f.name);\r\n\r\n    APIHandler.removeItems(path.join('/'), itemNames)\r\n        .then(r => dispatch(displayCurrentItemList()))\r\n        .catch(r => dispatch(setErrorMessage(String(r))))\r\n        .finally(() => dispatch(stopLoading()));\r\n};\r\n\r\n\r\n/**\r\n * Request API to move multiple items\r\n */\r\nexport const moveItems = (items: Item[], { host, path: targetPath }: { host: string, path: string[] }): MyThunk => (dispatch, getState) => {\r\n    const { path } = getState();\r\n    dispatch(displayLoading());\r\n\r\n\r\n    const destination = targetPath.join('/');\r\n    const itemNames = items.map(f => f.name);\r\n\r\n    APIHandler.moveItems(path.join('/'), destination, itemNames)\r\n        .then(r => {\r\n            dispatch(displayCurrentItemList());\r\n            dispatch(closeDialog(DIALOGS.MOVE));\r\n        })\r\n        .catch(r => dispatch(setErrorMessage(String(r))))\r\n        .finally(() => dispatch(stopLoading()));\r\n};\r\n\r\n\r\n/**\r\n * Request API to copy an item then dispatch defined events\r\n */\r\nexport const copyItems = (items: Item[], { host, path: targetPath }: { host: string, path: string[] }): MyThunk => (dispatch, getState) => {\r\n    const { path } = getState();\r\n    dispatch(displayLoading());\r\n\r\n    const destination = targetPath.join('/');\r\n    const itemNames = items.map(f => f.name);\r\n\r\n    APIHandler.copyItems(path.join('/'), destination, itemNames)\r\n        .then(r => {\r\n            dispatch(displayCurrentItemList());\r\n            dispatch(closeDialog(DIALOGS.COPY));\r\n        })\r\n        .catch(r => dispatch(setErrorMessage(String(r))))\r\n        .finally(() => dispatch(stopLoading()));\r\n};\r\n\r\n\r\n/**\r\n * This handles multiple selection by using shift key\r\n */\r\nexport const setSelectedItemsFromLastTo = (lastFile: Item): MyThunk => (dispatch, getState) => {\r\n    const { items: { inCurFolder: items, selected: selectedItems } } = getState();\r\n\r\n    const lastPreviouslySelected = [...selectedItems].pop();\r\n    if (!lastPreviouslySelected)\r\n        return dispatch(setErrorMessage(\"Couldn't enlarge selection because no items were previously selected\"));\r\n\r\n    const lastPreviouslySelectedIndex = items.indexOf(lastPreviouslySelected);\r\n    const lastSelectedIndex = items.indexOf(lastFile);\r\n\r\n    const isInRange = (num: number, start: number, end: number) => start <= num && num <= end;\r\n    const toAdd = lastSelectedIndex > lastPreviouslySelectedIndex ?\r\n        items.filter((item, index) => isInRange(index, lastPreviouslySelectedIndex, lastSelectedIndex))\r\n        : items.filter((item, index) => isInRange(index, lastSelectedIndex, lastPreviouslySelectedIndex));\r\n\r\n    dispatch(selectItems([...selectedItems, ...toAdd]));\r\n};\r\n\r\nexport const resetFileUploader = (): MyThunk => (dispatch, getState) => {\r\n    dispatch(setFileUploadProgress(0));\r\n    dispatch(closeDialog(DIALOGS.UPLOAD_FILE));\r\n    dispatch(resetFileUploadList());\r\n};\r\n\r\n\r\nexport const enterFolder = (path: string[]): MyThunk => (dispatch, getState) => {\r\n    dispatch(setPath(path));\r\n    dispatch(resetFilter());\r\n    dispatch(displayCurrentItemList());\r\n};\r\n\r\nexport const enterFolderByItem = (item: Item): MyThunk => (dispatch, getState) => {\r\n    const path = item.path;\r\n    // Open containing folder if it is a file\r\n    dispatch(enterFolder(item instanceof FileItem ? path : [...path, item.name]));\r\n};\r\n\r\nexport const moveFolderUpwardsAndRefresh = (n: number): MyThunk => (dispatch, getState) => {\r\n    dispatch(moveFolderUpwards(n));\r\n    dispatch(refreshItemList());\r\n};\r\n\r\nexport const rightClickOnFile = (item: Item): MyThunk => (dispatch, getState) => {\r\n    const { items: { selected } } = getState();\r\n    const isSelected = selected.includes(item);\r\n\r\n    !isSelected && dispatch(selectItem(item));\r\n};\r\n\r\n// Create action which can be dispatched\r\nconst makeActionCreator: <VALUE = void>(type: string) => (value: VALUE) => Action<VALUE> = <VALUE = void>(type: string) => (value: VALUE) => {\r\n    return {\r\n        type,\r\n        value\r\n    };\r\n};\r\n\r\nexport const moveFolderUpwards = makeActionCreator<number>(MOVE_FOLDER_UPWARDS);\r\nexport const setPath = makeActionCreator<string[]>(SET_PATH);\r\nexport const resetPath = () => setPath([]);\r\n\r\nexport const setLoggedIn = makeActionCreator(SET_LOGGED_IN);\r\nexport const setLoggedOut = makeActionCreator(SET_LOGGED_OUT);\r\nexport const setHost = makeActionCreator<string>(SET_HOST);\r\nexport const resetHost = makeActionCreator(RESET_HOST);\r\nexport const setWebId = makeActionCreator<string>(SET_WEB_ID);\r\nexport const resetWebId = makeActionCreator(RESET_WEB_ID);\r\n\r\nexport const setItems = makeActionCreator<Item[]>(SET_ITEMS);\r\nexport const resetItems = () => setItems([]);\r\n\r\nexport const setMetas = makeActionCreator<Meta[]>(SET_METAS);\r\n\r\nexport const selectItems = makeActionCreator<Item[]>(SELECT_ITEMS);\r\nexport const selectItem = (item: Item) => selectItems([item]);\r\nexport const resetSelectedItems = () => selectItems([]);\r\nexport const toggleSelectedItem = makeActionCreator<Item>(TOGGLE_SELECTED_ITEM);\r\nexport const deselectItem = makeActionCreator<Item>(DESELECT_ITEM);\r\n\r\nexport const filterItems = makeActionCreator<string>(FILTER_ITEMS);\r\nexport const resetFilter = makeActionCreator(RESET_FILTER);\r\n\r\n\r\nexport const displayLoading = makeActionCreator(DISPLAY_LOADING);\r\nexport const stopLoading = makeActionCreator(STOP_LOADING);\r\n\r\nexport const resetFileContent = makeActionCreator(RESET_LOADED_BLOB);\r\nexport const setFileContent = makeActionCreator<Blob>(SET_LOADED_BLOB);\r\nexport const setFileUploadList = makeActionCreator<FileList | null>(SET_UPLOAD_FILE_LIST);\r\nexport const resetFileUploadList = () => setFileUploadList(null);\r\nexport const setFileUploadProgress = makeActionCreator<number>(SET_UPLOAD_FILE_PROGRESS);\r\n\r\nexport const openDialog = makeActionCreator<DIALOGS>(OPEN_DIALOG);\r\nexport const closeDialog = makeActionCreator<DIALOGS>(CLOSE_DIALOG);\r\nexport const openContextMenu = makeActionCreator<{ x: number, y: number }>(OPEN_CONTEXT_MENU);\r\nexport const closeContextMenu = makeActionCreator(CLOSE_CONTEXT_MENU);\r\n\r\nexport const setErrorMessage = makeActionCreator<string>(SET_ERROR_MESSAGE);\r\nexport const resetErrorMessage = () => setErrorMessage('');\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\n\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\"\r\nimport ExpandLess from \"@material-ui/icons/ExpandLess\";\r\nimport ExpandMore from \"@material-ui/icons/ExpandMore\";\r\n//import { styled } from '@material-ui/styles';\r\n\r\nimport { enterFolderByItem, MyDispatch } from '../../Actions/Actions';\r\n\r\nimport { Item } from '../../Api/Item';\r\n\r\ninterface IFolder {\r\n    type: \"folder\";\r\n    name: string; // folder name (without path),\r\n    url: string; // full URL of the resource,\r\n    modified: string; // dcterms:modified date\r\n    mtime: string; // stat:mtime\r\n    size: number;// stat:size\r\n    parent: string;// parentFolder or undef if none,\r\n    content: string; // raw content of the folder's turtle representation,\r\n    files: Array<any>; // an array of files in the folder\r\n    folders: IFolder[];// an array of sub-folders in the folder,\r\n    alreadyReadSubFolders?: boolean;//details of sub folders are read\r\n}\r\n\r\ninterface IState {\r\n    [index: string]: boolean;\r\n}\r\n\r\n/*\r\nconst MyListItem =  styled(ListItem)({\r\n    padding: '0 16px 0px 16px',\r\n});\r\n\r\nconst MyListItemText = styled(ListItemText)({\r\n    fontSize: '0.8em',\r\n    padding: '0 0px',\r\n});\r\n*/\r\n\r\nclass TreeViewItem extends React.Component<TreeViewProps> {\r\n\r\n    state = {} as IState;\r\n    colNumber = 2;\r\n\r\n    render() {\r\n        //handleClick to show details on other view, from Redux\r\n        //itemHandleCkick from parent to expand/collapse\r\n        const { item, handleClick, colNumber, itemHandleClick } = this.props\r\n\r\n        return (\r\n            <ListItem style={{ padding: '0 16px 0px 16px'}}\r\n                button\r\n                key={item.name}\r\n                onClick={itemHandleClick.bind(this, item)}\r\n            >\r\n                {this.blanks(colNumber)}\r\n                <div\r\n                    key={item.name}\r\n                >\r\n                    {item.folders && item.folders.length !== 0 ? (\r\n                        this.props.expColl\r\n                            ? (<ExpandLess key={item.name} />)\r\n                            : (<ExpandMore key={item.name} />)\r\n                    ) : (this.Blank())}\r\n                </div>\r\n\r\n                <ListItemText style={{ fontSize: '0.8em', padding: '0 0px',}}\r\n                    key={item.name + 'txt'}\r\n                    onClick={handleClick}\r\n                >\r\n                    {item.name}\r\n                </ListItemText>\r\n\r\n            </ListItem>\r\n        )\r\n    }\r\n\r\n    Blank = () =>\r\n        <svg\r\n            width=\"24px\"\r\n            height=\"24px\"\r\n            viewBox=\"0 0 24 24\"\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            xmlnsXlink=\"http://www.w3.org/1999/xlink\"\r\n        >\r\n            <path d=\"\" fill=\"#fff\" />\r\n        </svg>;\r\n\r\n\r\n    blanks(colNumber: number) {\r\n        const blanks = [];\r\n        for (var it = 0; it < colNumber; it++) {\r\n            blanks.push(\r\n                this.Blank()\r\n            )\r\n        }\r\n        return blanks\r\n    }\r\n}\r\n\r\ninterface TreeViewOwnProps {\r\n    item: IFolder;\r\n    colNumber: number;\r\n    itemHandleClick(folder: IFolder): void;\r\n    expColl: boolean\r\n}\r\n\r\ninterface StateProps {\r\n}\r\ninterface DispatchProps {\r\n    handleClick(event: React.MouseEvent<HTMLDivElement, MouseEvent>): void;\r\n}\r\ninterface TreeViewProps extends TreeViewOwnProps, StateProps, DispatchProps { }\r\n\r\nconst mapStateToProps = () => ({});\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch, ownProps: TreeViewOwnProps): DispatchProps => {\r\n    return {\r\n        handleClick: () => {\r\n            const item = new Item(ownProps.item.url)\r\n            dispatch(enterFolderByItem(item));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(TreeViewItem);\r\n","import React from 'react';\r\nimport { withStyles, createStyles, Theme, WithStyles } from '@material-ui/core/styles';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport Grid from '@material-ui/core/Grid';\r\n\r\nconst styles = (theme: Theme) => createStyles({\r\n  progress: {\r\n    margin: theme.spacing.unit * 10,\r\n  },\r\n});\r\n\r\nfunction Loader(props: LoaderProps) {\r\n    return (\r\n        <Grid container justify=\"center\">\r\n            <CircularProgress className={props.classes.progress} color=\"secondary\" />\r\n        </Grid>\r\n    );\r\n}\r\n\r\ninterface LoaderProps extends WithStyles<typeof styles> {};\r\n\r\nexport default withStyles(styles)(Loader);\r\n","import React, { Component } from 'react';\r\n\r\nimport List from \"@material-ui/core/List\";\r\nimport ListSubheader from \"@material-ui/core/ListSubheader\";\r\nimport Collapse from \"@material-ui/core/Collapse\";\r\n//import { styled } from '@material-ui/styles';\r\n\r\nimport SolidFileClientUtils, { IFolder } from '../../Api/FileUtils';\r\nimport TreeViewItem from \"./TreeViewItem\";\r\nimport Loader from '../Loader/Loader'; \r\n\r\ninterface IState {\r\n    [index: string]: boolean;\r\n}\r\n\r\n/*\r\nconst MyList = styled(List)({\r\n    width: 'max-content',\r\n    flexShrink: 0\r\n});\r\n*/\r\n\r\nexport default class TreeView extends Component {\r\n    state = {} as IState;\r\n    folder = {} as IFolder;\r\n\r\n    constructor(props: any) {\r\n        super(props)\r\n        this.itemHandleClick = this.itemHandleClick.bind(this)\r\n    }\r\n\r\n    //sent to TreeViewItem for expand/collapse handled here\r\n    itemHandleClick(folder: IFolder) {\r\n        this.updateFolder(folder)\r\n        this.setState({ [folder.url]: !this.state[folder.url] });\r\n    };\r\n\r\n    async initFolders() {\r\n        \r\n        const baseUrl = (await SolidFileClientUtils.getWebIdAndHost()).baseUrl\r\n        \r\n        if (baseUrl !== null) {\r\n            this.folder = await SolidFileClientUtils.fileClientReadFolder(baseUrl)\r\n\r\n            //get folders in the root\r\n            await this.updateFolder(this.folder)\r\n            this.forceUpdate()\r\n\r\n            //and then update those folders so that the arrows (if any) are visible\r\n            for (var i = 0; i < this.folder.folders.length; i++) {\r\n                await this.updateFolder(this.folder.folders[i])\r\n            }\r\n            this.forceUpdate()\r\n        }\r\n    }\r\n\r\n    //also called on folder icon click\r\n    async updateFolder(item: IFolder) {\r\n        for (var i = 0; i < item.folders.length; i++) {\r\n            if (item.folders[i].known !== true) {\r\n                item.folders[i] = await SolidFileClientUtils.fileClientReadFolder(item.folders[i].url)\r\n                item.folders[i].known = true\r\n            }\r\n            for (var j = 0; j < item.folders[i].folders.length; j++) {\r\n                try {\r\n                    if (item.folders[i].folders[j].known !== true) {\r\n                        item.folders[i].folders[j] =\r\n                            await SolidFileClientUtils.fileClientReadFolder(item.folders[i].folders[j].url)\r\n                            item.folders[i].folders[j].known = true\r\n                    }\r\n                } catch (err) {\r\n                    //Error on some damaged folders, skip ...\r\n                }\r\n            }\r\n        }\r\n     }\r\n\r\n    render() {\r\n        if (this.folder.name === undefined) {\r\n            this.initFolders()\r\n            return (<div><Loader/></div>)\r\n        } else {\r\n            return (\r\n                <div>\r\n                    <List style={{width: 'max-content', flexShrink: 0 }}\r\n                        subheader={<ListSubheader></ListSubheader>}>\r\n                        {this.printRows(this.folder.folders, -1)}\r\n                    </List>\r\n                </div>\r\n            )\r\n        }\r\n\r\n    };\r\n\r\n    printRows(items: IFolder[], colNumber: number) {\r\n        colNumber = colNumber + 1\r\n        if (items != null) {\r\n            return (\r\n                items.map((item: IFolder) => {\r\n                    return (\r\n                        <div key={item.name}>\r\n                            <TreeViewItem\r\n                                item={item}\r\n                                key={0}\r\n                                colNumber={colNumber}\r\n                                itemHandleClick={this.itemHandleClick}\r\n                                expColl={this.state[item.url]}\r\n                            />\r\n                            {item.folders != null ? (\r\n                                <Collapse\r\n                                    key={item.name + 'col'}\r\n                                    component=\"div\"\r\n                                    in={this.state[item.url]}\r\n                                    timeout=\"auto\"\r\n                                    unmountOnExit\r\n                                >\r\n                                    {this.printRows(item.folders, colNumber)}\r\n                                </Collapse>\r\n                            ) : (null)}\r\n                        </div>\r\n                    )\r\n                })\r\n\r\n            );\r\n        }\r\n        colNumber = colNumber - 1\r\n    }\r\n}\r\n\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\n\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\n//import { styled } from '@material-ui/styles';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport Switch from '@material-ui/core/Switch';\r\n\r\nimport { getMetaList, MyDispatch } from '../../Actions/Actions';\r\nimport MetaUtils, { MetaTag, onServerColor } from '../../Api/MetaUtils'\r\nimport lodash from 'lodash'\r\n\r\n/*\r\nconst MyList = styled(List)({\r\n    minWidth: 'max-content'\r\n});\r\n\r\nconst MyListItem = styled(ListItem)({\r\n    padding: '0 0 0 10px'\r\n});\r\n\r\nconst MyListItemText = styled(ListItemText)({\r\n    fontSize: '0.9em',\r\n    padding: '0 0 0 0',\r\n});\r\n\r\nconst MyCheckbox = styled(Checkbox)({\r\n    padding: '0 0 0 0'\r\n});\r\n*/\r\n\r\nexport class TagList extends Component<TagListProps> {\r\n\r\n    usedTags = [] as MetaTag[]\r\n    selectedTags = [] as MetaTag[]\r\n\r\n    state = {\r\n        showLocalOrCentral: true,\r\n        loading: true\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.setState({showLocalOrCentral: false})\r\n        this.refreshView();\r\n    };\r\n\r\n    refreshView() {\r\n        this.usedTags = [] as MetaTag[]\r\n        if (this.state.showLocalOrCentral) {\r\n            MetaUtils.getLocalUsedTags()\r\n                .then(foundTags => {\r\n                    this.usedTags.push(...foundTags as MetaTag[]);\r\n                    this.setState({ loading: false })\r\n                })\r\n        }\r\n\r\n        if (!this.state.showLocalOrCentral) {\r\n            MetaUtils.getCentralUsedTags()\r\n                .then(foundTags => {\r\n                    if (foundTags !== undefined) {\r\n                        this.usedTags.push(...foundTags as MetaTag[]);\r\n                        this.setState({ loading: false })\r\n                    }\r\n                })\r\n        }\r\n    }\r\n\r\n    //Select a tag to load related Metas. Target is MetaUtils.getLocalMetaList\r\n    handleClick(metaTag: MetaTag) {\r\n        //event.preventDefault();\r\n        const i: number = this.selectedTags.indexOf(metaTag)\r\n        i !== -1\r\n            ? this.selectedTags.splice(i, 1)\r\n            : this.selectedTags.push(metaTag)\r\n        this.props.handleSubmit(this.selectedTags, this.state.showLocalOrCentral);\r\n        this.forceUpdate() //CheckBox update\r\n    }\r\n    \r\n\r\n    //local/central\r\n    onChange() {\r\n        this.selectedTags = []\r\n        this.setState({ showLocalOrCentral: !this.state.showLocalOrCentral });\r\n        this.setState({ loading: true })\r\n        this.refreshView()\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <div>\r\n                    Local\r\n                    <Switch\r\n                        checked={this.state.showLocalOrCentral}\r\n                        onChange={() => { this.onChange() }}\r\n                        color=\"default\"\r\n                    />\r\n                    Central\r\n                </div>\r\n                {this.state.loading ? \"Loading ...\" : this.PrintList()}\r\n            </div>\r\n        )\r\n    };\r\n\r\n    PrintList = () => {\r\n        if (!this.state.loading) {\r\n            this.usedTags = lodash.sortBy(this.usedTags, ['tagType', 'value']);\r\n            return (\r\n                < List style={{minWidth: 'max-content'}} className='leftPane' >\r\n                    {this.usedTags.map(tag => {\r\n                        const itemColor = {\r\n                            color: tag.published ? onServerColor : 'black'\r\n                        };\r\n                        return (\r\n                            <ListItem style={{ padding: '0 0 0 10px'}}\r\n                                key={tag.value}\r\n                                role={undefined}\r\n                                dense button\r\n                            >\r\n                                <Checkbox style={{ padding: '0 0 0 0'}}\r\n                                    color=\"primary\"\r\n                                    onChange={e => this.handleClick(tag)}\r\n                                    checked={this.selectedTags.find(elt => tag === elt) !== undefined}\r\n                                />\r\n                                <ListItemText style={{ padding: '0 0 0 0'}}\r\n                                    id={tag.value}\r\n                                    onClick={e => this.handleClick(tag)}>\r\n                                    <span style={itemColor}>{`${tag.tagType}: ${tag.value}`}</span>\r\n                                </ListItemText>\r\n                            </ListItem>\r\n                        )\r\n                    })\r\n                    }\r\n                </List >\r\n            )\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\ninterface TagListOwnProps {\r\n}\r\n\r\ninterface StateProps {\r\n    //loading: boolean\r\n}\r\n\r\ninterface DispatchProps {\r\n    handleSubmit(selectedTags: MetaTag[], showLocalOrCentral: boolean): void;\r\n}\r\n\r\ninterface TagListProps extends TagListOwnProps, StateProps, DispatchProps { }\r\n\r\nconst mapStateToProps = () => ({});\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch, ownProps: TagListOwnProps): DispatchProps => {\r\n    return {\r\n        handleSubmit: (selectedTags: MetaTag[], showLocalOrCentral: boolean) => {\r\n            dispatch(getMetaList(selectedTags, showLocalOrCentral));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(TagList);\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport {\r\n    setSelectedItemsFromLastTo, loadAndEditFile, loadAndDisplayFile, displaySelectedMediaFile,\r\n    rightClickOnFile, enterFolderByItem, MyDispatch, openContextMenu, toggleSelectedItem, selectItems\r\n} from '../../Actions/Actions';\r\nimport './File.css';\r\n\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport FolderIcon from '@material-ui/icons/Folder';\r\n//import { styled } from '@material-ui/styles';\r\nimport FileIcon from '@material-ui/icons/InsertDriveFile';\r\nimport blue from '@material-ui/core/colors/blue';\r\nimport { FileItem, Item } from '../../Api/Item';\r\nimport { AppState } from '../../Reducers/reducer';\r\n\r\n/*\r\nconst MyListItem = styled(ListItem)({\r\n    padding: '0 16px 0px 16px',\r\n});\r\n*/\r\n\r\nclass File extends Component<FileProps> {\r\n\r\n    render() {\r\n        //const classes = useStyles();\r\n        const { isSelected, item, handleClickOnName, handleClickOnFolder, handleDoubleClick, handleContextMenu } = this.props;\r\n        const iconStyle = {\r\n            backgroundColor: isSelected ? blue['A200'] : undefined\r\n        };\r\n        const realSize = (item instanceof FileItem) ? item.getDisplaySize() : null;\r\n        return (\r\n            <div className=\"File\" data-selected={isSelected}>\r\n                <ListItem style={{ padding: '0 16px 0px 16px'}}>\r\n                    <ListItemIcon>\r\n                        <div style={iconStyle} onClick={handleClickOnFolder} >\r\n                            {(item instanceof FileItem) ? <FileIcon /> : <FolderIcon />}\r\n                        </div>\r\n                    </ListItemIcon>\r\n                    <ListItemText className=\"filename\" primary={item.getDisplayName()} secondary={realSize}\r\n                        onClick={handleClickOnName} onDoubleClick={handleDoubleClick} onContextMenu={handleContextMenu} />\r\n                    <Divider absolute />\r\n                </ListItem>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\n\r\ninterface FileOwnProps {\r\n    item: Item;\r\n}\r\ninterface StateProps {\r\n    isSelected: boolean;\r\n}\r\ninterface DispatchProps {\r\n    handleClickOnName(event: React.MouseEvent<HTMLDivElement, MouseEvent>): void;\r\n    handleClickOnFolder(event: React.MouseEvent<HTMLDivElement, MouseEvent>): void;\r\n    handleDoubleClick(): void;\r\n    handleContextMenu(event: React.MouseEvent<HTMLDivElement, MouseEvent>): void;\r\n}\r\ninterface FileProps extends FileOwnProps, StateProps, DispatchProps { }\r\n\r\n\r\nconst mapStateToProps = (state: AppState, ownProps: FileOwnProps): StateProps => {\r\n    return {\r\n        isSelected: state.items.selected.includes(ownProps.item)\r\n    };\r\n};\r\n\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch, ownProps: FileOwnProps): DispatchProps => {\r\n    return {\r\n\r\n        handleDoubleClick: () => {\r\n            const item = ownProps.item;\r\n\r\n            if (item instanceof FileItem) {\r\n                if (item.isEditable())\r\n                    dispatch(loadAndEditFile(item.name));\r\n                else if (item.isImage())\r\n                    dispatch(loadAndDisplayFile(item.name));\r\n                else if (item.isMedia())\r\n                    dispatch(displaySelectedMediaFile());\r\n            }\r\n            else\r\n                dispatch(enterFolderByItem(item));\r\n        },\r\n\r\n        handleContextMenu: (event: React.MouseEvent<HTMLDivElement, MouseEvent> | React.TouchEvent) => {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n\r\n            let x = 0;\r\n            let y = 0;\r\n\r\n            if (event.nativeEvent instanceof MouseEvent) {\r\n                x = event.nativeEvent.clientX;\r\n                y = event.nativeEvent.clientY;\r\n            }\r\n            else if (event.nativeEvent instanceof TouchEvent) {\r\n                x = event.nativeEvent.touches[0].pageX;\r\n                y = event.nativeEvent.touches[0].pageY;\r\n            }\r\n            else {\r\n                console.warn(\"Unknown click event\", event);\r\n            }\r\n\r\n            if (event.shiftKey) {\r\n                dispatch(setSelectedItemsFromLastTo(ownProps.item));\r\n            } else {\r\n                dispatch(rightClickOnFile(ownProps.item));\r\n            }\r\n\r\n            dispatch(openContextMenu({ x, y }));\r\n        },\r\n\r\n        handleClickOnName: (event: React.MouseEvent<HTMLDivElement, MouseEvent> | React.TouchEvent) => {\r\n            event.stopPropagation();\r\n\r\n            if (event.ctrlKey) {\r\n                dispatch(toggleSelectedItem(ownProps.item));\r\n            } else if (event.shiftKey) {\r\n                dispatch(setSelectedItemsFromLastTo(ownProps.item));\r\n            } else {\r\n                dispatch(selectItems([ownProps.item]));\r\n            }\r\n        },\r\n        handleClickOnFolder: () => {\r\n            const item = ownProps.item;\r\n                dispatch(enterFolderByItem(item));\r\n        },\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(File);\r\n","import React from 'react';\r\nimport './FileListEmptyMessage.css';\r\n\r\nexport default function FileListEmptyMessage() {\r\n    return (\r\n        <div className=\"FileListEmptyMessage\">\r\n            No files in this folder\r\n        </div>\r\n    );\r\n};","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport File from '../File/File'; \r\nimport FileListEmptyMessage from './FileListEmptyMessage';\r\nimport Loader from '../Loader/Loader'; \r\nimport './FileList.css';\r\nimport { Item } from '../../Api/Item';\r\nimport { AppState } from '../../Reducers/reducer';\r\n\r\nclass FileList extends Component<FileListProps> {\r\n    render() {\r\n        const { items, isLoading } = this.props;\r\n        const itemComponents = items.map((item, key) => {\r\n            return <File item={item} key={key} />;\r\n        });\r\n\r\n        return <div className=\"FileList\">\r\n            { isLoading ? \r\n                <Loader /> : \r\n                itemComponents.length ? itemComponents : <FileListEmptyMessage />\r\n            }\r\n        </div>\r\n    }\r\n}\r\n\r\ninterface StateProps {\r\n    items: Item[];\r\n    isLoading: boolean;\r\n}\r\ninterface FileListProps extends StateProps {};\r\n\r\nconst mapStateToProps = (state: AppState): StateProps => {\r\n    const items = state.items.inCurFolder\r\n        .filter(item => filterMatch(item.getDisplayName(), state.items.filter));\r\n\r\n    return {\r\n        items,\r\n        isLoading: state.loading,\r\n    };\r\n};\r\n\r\n\r\nconst mapDispatchToProps = () => ({});\r\n\r\nconst filterMatch = (first: string, second: string) => {\r\n    return first.toLocaleLowerCase().match(second.toLocaleLowerCase());\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FileList);\r\n\r\n\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport {\r\n    setSelectedItemsFromLastTo, loadAndEditFileFromTag, loadAndDisplayFileFromTag, displaySelectedMediaFileFromTag,\r\n    rightClickOnFile, enterFolderByItem, MyDispatch, openContextMenu, toggleSelectedItem, selectItems\r\n} from '../../Actions/Actions';\r\nimport './Meta.css';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport { AppState } from '../../Reducers/reducer';\r\nimport { FileItem, FolderItem, Item } from '../../Api/Item';\r\nimport { Meta, onServerColor } from '../../Api/MetaUtils';\r\n\r\nclass MetaRow extends Component<MetaProps> {\r\n\r\n    render() {\r\n        const { isSelected, meta, handleClickOnName, handleDoubleClick, handleContextMenu } = this.props;\r\n        /*\r\n        let tagList = '' as string\r\n        let itemColor = { color: 'black' }\r\n        meta.tags.forEach(tag => {\r\n            console.log('1')\r\n            tag.published && itemColor.color === 'black'\r\n                ? itemColor = { color: onServerColor }\r\n                : itemColor = { color: 'black' }\r\n\r\n            if (tagList !== '') tagList += ` - `\r\n            tagList += <span style={itemColor}>`${tag.tagType}: ${tag.value}`</span>\r\n        })\r\n\r\n        tagList = ` (${tagList})`\r\n        */\r\n        let prevChars = ''\r\n        return (\r\n            <div className=\"File\" data-selected={isSelected}>\r\n                <ListItem style={{ padding: '0 16px 0px 16px' }}>\r\n                    <ListItemText\r\n                        onClick={handleClickOnName} onDoubleClick={handleDoubleClick} onContextMenu={handleContextMenu} >\r\n                        {meta.hostName} - {meta.pathName}\r\n                        {meta.tags.map(tag => {\r\n                            const itemColor = tag.published ? { color: onServerColor } : { color: 'black' }\r\n                            prevChars = prevChars === '' ? ' (' : ' - '\r\n                            return (\r\n                                <span style={itemColor}>\r\n                                    {prevChars}{tag.tagType}: {tag.value}\r\n                                </span>\r\n                            )\r\n                        })\r\n                        }\r\n                        )\r\n                    </ListItemText>\r\n                </ListItem>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\n\r\ninterface MetaOwnProps {\r\n    meta: Meta;\r\n    //item: Item;\r\n}\r\ninterface StateProps {\r\n    isSelected: boolean;\r\n}\r\ninterface DispatchProps {\r\n    handleClickOnName(event: React.MouseEvent<HTMLDivElement, MouseEvent>): void;\r\n    handleDoubleClick(): void;\r\n    handleContextMenu(event: React.MouseEvent<HTMLDivElement, MouseEvent>): void;\r\n}\r\ninterface MetaProps extends MetaOwnProps, StateProps, DispatchProps { }\r\n\r\nconst mapStateToProps = (state: AppState, ownProps: MetaOwnProps): StateProps => {\r\n    return {\r\n        isSelected: state.metas.selected.includes(ownProps.meta)\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch, ownProps: MetaOwnProps): DispatchProps => {\r\n    const meta = ownProps.meta;\r\n    let path = meta.pathName.split('/') as string[]\r\n    path.shift()\r\n    path.pop()\r\n\r\n    let item = {} as Item\r\n    if (meta.mimeType === 'FOLDER') item = new FolderItem('https://' + meta.hostName + meta.pathName)\r\n    else item = new FileItem('https://' + meta.hostName + meta.pathName)\r\n\r\n    return {\r\n        handleDoubleClick: () => {\r\n            if (item instanceof FileItem) {\r\n                if (item.isEditable())\r\n                    dispatch(loadAndEditFileFromTag(item.name, path));\r\n                else if (item.isImage())\r\n                    dispatch(loadAndDisplayFileFromTag(item.name, path));\r\n                else if (item.isMedia())\r\n                    dispatch(displaySelectedMediaFileFromTag(path));\r\n            }\r\n            else\r\n                dispatch(enterFolderByItem(item));\r\n        },\r\n\r\n        handleContextMenu: (event: React.MouseEvent<HTMLDivElement, MouseEvent> | React.TouchEvent) => {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n\r\n            let x = 0;\r\n            let y = 0;\r\n\r\n            if (event.nativeEvent instanceof MouseEvent) {\r\n                x = event.nativeEvent.clientX;\r\n                y = event.nativeEvent.clientY;\r\n            }\r\n            else if (event.nativeEvent instanceof TouchEvent) {\r\n                x = event.nativeEvent.touches[0].pageX;\r\n                y = event.nativeEvent.touches[0].pageY;\r\n            }\r\n            else {\r\n                console.warn(\"Unknown click event\", event);\r\n            }\r\n\r\n            if (event.shiftKey) {\r\n                dispatch(setSelectedItemsFromLastTo(item))//ownProps.item));\r\n            } else {\r\n                dispatch(rightClickOnFile(item))//ownProps.item));\r\n            }\r\n\r\n            dispatch(openContextMenu({ x, y }));\r\n        },\r\n\r\n        handleClickOnName: (event: React.MouseEvent<HTMLDivElement, MouseEvent> | React.TouchEvent) => {\r\n            event.stopPropagation();\r\n\r\n            if (event.ctrlKey) {\r\n                dispatch(toggleSelectedItem(item))//ownProps.item));\r\n            } else if (event.shiftKey) {\r\n                dispatch(setSelectedItemsFromLastTo(item))//ownProps.item));\r\n            } else {\r\n                dispatch(selectItems([item]))//ownProps.item]));\r\n            }\r\n        },\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MetaRow);\r\n","import React from 'react';\r\nimport './MetaListEmptyMessage.css';\r\n\r\nexport default function MetaListEmptyMessage() {\r\n    return (\r\n        <div className=\"MetaListEmptyMessage\">\r\n            <div>No files or folders for the selected tags.</div>\r\n            <div><b>Tags: </b></div>\r\n            <div>- Switch set to Local: Black tags are only saved on Local, purple are on Local and Central.</div>\r\n            <div>- Switch set to Central: All tags found on Central, black one are from other users, purple one are created or used by you.</div>\r\n        </div>\r\n    );\r\n};","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport MetaRow from './MetaRow'; \r\nimport FileListEmptyMessage from './MetaListEmptyMessage';\r\nimport Loader from '../Loader/Loader'; \r\n//import { getMetaList} from '../../Actions/Actions';\r\nimport './Meta.css';\r\nimport { Meta } from '../../Api/MetaUtils';\r\nimport { AppState } from '../../Reducers/reducer';\r\nimport './Meta.css';\r\n\r\nclass MetaList extends Component<MetaListProps> {\r\n    render() {\r\n        const { metas, isLoading } = this.props;\r\n        const itemComponents = metas.map((meta, key) => {\r\n            return <MetaRow \r\n                key ={meta.hostName + meta.pathName}\r\n                meta={meta}  />;\r\n        });\r\n\r\n        return <div className=\"MetaList\">\r\n            { isLoading ? \r\n                <Loader /> : \r\n                itemComponents.length ? itemComponents : <FileListEmptyMessage />\r\n            }\r\n        </div>\r\n    }\r\n}\r\n\r\ninterface StateProps {\r\n    metas: Meta[];\r\n    isLoading: boolean;\r\n}\r\ninterface MetaListProps extends StateProps {};\r\n\r\nconst mapStateToProps = (state: AppState): StateProps => {\r\n    const metas = state.metas.inCurFolder\r\n        .filter(meta => filterMatch(meta.hostName + meta.pathName, state.metas.filter));\r\n\r\n    return {\r\n        metas,\r\n        isLoading: state.loading,\r\n    };\r\n};\r\n\r\n\r\nconst mapDispatchToProps = () => ({});\r\n\r\nconst filterMatch = (first: string, second: string) => {\r\n    return first.toLocaleLowerCase().match(second.toLocaleLowerCase());\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MetaList);\r\n\r\n\r\n","import React, { Component } from 'react';\r\nimport Switch from '@material-ui/core/Switch';\r\nimport TreeView from './Components/TreeView/TreeView';\r\nimport TagList from './Components/TagList/TagList';\r\nimport FileList from './Components/FileList/FileList';\r\nimport MetaList from './Components/Meta/MetaList';\r\n\r\nimport './TreeAndTagList.css'\r\n\r\n\r\nexport default class TreeAndTagList extends Component<{}> {\r\n\r\n    state = {\r\n        showTreeOrTag: true\r\n    }\r\n\r\n    onChange() {\r\n        this.setState({\r\n            showTreeOrTag: !this.state.showTreeOrTag\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <div className='treeAndTagHeader'>\r\n                    Tags\r\n                    <Switch\r\n                        checked={this.state.showTreeOrTag}\r\n                        onChange={() => { this.onChange() }}\r\n                        color=\"default\"\r\n                    />\r\n                    Tree\r\n                </div>\r\n                <div>\r\n                    {this.state.showTreeOrTag ?\r\n                        <div className='bodyPlace'>\r\n                            <div className='leftView'><TreeView /></div>\r\n                            <FileList />\r\n                        </div>\r\n                        :\r\n                        <div className='bodyPlace'>\r\n                            <div className='leftView'><TagList /></div>\r\n                            <MetaList />\r\n                        </div>\r\n                    }\r\n                </div >\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import React from 'react';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport { connect } from 'react-redux';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport CreateNewFolderIcon from '@material-ui/icons/CreateNewFolder';\r\nimport { openDialog, MyDispatch } from '../../../Actions/Actions';\r\nimport { AppState } from '../../../Reducers/reducer';\r\nimport { DIALOGS } from '../../../Actions/actionTypes';\r\n\r\nfunction CreateFolderAction(props: CreateFolderActionProps) {\r\n    const {handleClick, handleClose} = props;\r\n\r\n    const handleCloseAfter = (callback: () => void) => () => {\r\n        callback();\r\n        handleClose();\r\n    };\r\n\r\n    return (\r\n        <MenuItem onClick={handleCloseAfter(handleClick)}>\r\n            <ListItemIcon>\r\n                <CreateNewFolderIcon />\r\n            </ListItemIcon>\r\n            <Typography variant=\"inherit\">\r\n                Create folder\r\n            </Typography>\r\n        </MenuItem>        \r\n    );\r\n}\r\n\r\ninterface CreateFolderActionProps {\r\n    handleClick(): void;\r\n    handleClose(): void;\r\n}\r\n\r\nconst mapStateToProps = (state: AppState) => {\r\n    return {};\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch) => {\r\n    return {\r\n        handleClick: () => {\r\n            dispatch(openDialog(DIALOGS.CREATE_FOLDER));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CreateFolderAction);\r\n","import React from 'react';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport { connect } from 'react-redux';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport InsertDriveFileIcon from '@material-ui/icons/InsertDriveFile';\r\nimport { openDialog, MyDispatch } from '../../../Actions/Actions';\r\nimport { AppState } from '../../../Reducers/reducer';\r\nimport { DIALOGS } from '../../../Actions/actionTypes';\r\n\r\nfunction CreateFileAction(props: CreateFileActionProps) {\r\n    const {handleClick, handleClose} = props;\r\n\r\n    const handleCloseAfter = (callback: () => void) => () => {\r\n        callback();\r\n        handleClose();\r\n    };\r\n\r\n    return (\r\n        <MenuItem onClick={handleCloseAfter(handleClick)}>\r\n            <ListItemIcon>\r\n                <InsertDriveFileIcon />\r\n            </ListItemIcon>\r\n            <Typography variant=\"inherit\">\r\n                Create file\r\n            </Typography>\r\n        </MenuItem>        \r\n    );\r\n}\r\n\r\ninterface CreateFileActionProps {\r\n    handleClick(): void;\r\n    handleClose(): void;\r\n}\r\n\r\nconst mapStateToProps = (state: AppState) => {\r\n    return {};\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch) => {\r\n    return {\r\n        handleClick: () => {\r\n            dispatch(openDialog(DIALOGS.CREATE_FILE));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CreateFileAction);\r\n","import React from 'react';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport { connect } from 'react-redux';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\r\nimport { openDialog, MyDispatch } from '../../../Actions/Actions';\r\nimport { AppState } from '../../../Reducers/reducer';\r\nimport { DIALOGS } from '../../../Actions/actionTypes';\r\n\r\nfunction UploadFileAction(props: UploadFileActionProps) {\r\n    const { handleClick, handleClose } = props;\r\n\r\n    const handleCloseAfter = (callback: () => void) => () => {\r\n        callback();\r\n        handleClose();\r\n    };\r\n\r\n    return (\r\n        <MenuItem onClick={handleCloseAfter(handleClick)}>\r\n            <ListItemIcon>\r\n                <CloudUploadIcon />\r\n            </ListItemIcon>\r\n            <Typography variant=\"inherit\">\r\n                Upload files\r\n            </Typography>\r\n        </MenuItem>        \r\n    );\r\n}\r\n\r\ninterface UploadFileActionProps {\r\n    handleClick(): void;\r\n    handleClose(): void;\r\n}\r\n\r\nconst mapStateToProps = (state: AppState) => {\r\n    return {};\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch) => {\r\n    return {\r\n        handleClick: () => {\r\n            dispatch(openDialog(DIALOGS.UPLOAD_FILE));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UploadFileAction);\r\n","import React from 'react';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport { connect } from 'react-redux';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport FolderSharedIcon from '@material-ui/icons/FolderSharedOutlined';\r\nimport { openDialog, MyDispatch } from '../../../Actions/Actions';\r\nimport { AppState } from '../../../Reducers/reducer';\r\nimport { DIALOGS } from '../../../Actions/actionTypes';\r\n\r\nfunction ChooseLocationAction(props: ChooseLocationActionProps) {\r\n    const { handleClick, handleClose } = props;\r\n\r\n    const handleCloseAfter = (callback: () => void) => () => {\r\n        callback();\r\n        handleClose();\r\n    };\r\n\r\n    return (\r\n        <MenuItem onClick={handleCloseAfter(handleClick)}>\r\n            <ListItemIcon>\r\n                <FolderSharedIcon />\r\n            </ListItemIcon>\r\n            <Typography variant=\"inherit\">\r\n                Choose root location\r\n            </Typography>\r\n        </MenuItem>        \r\n    );\r\n}\r\n\r\ninterface ChooseLocationActionProps {\r\n    handleClick(): void;\r\n    handleClose(): void;\r\n}\r\n\r\nconst mapStateToProps = (state: AppState) => {\r\n    return {};\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch) => {\r\n    return {\r\n        handleClick: () => {\r\n            dispatch(openDialog(DIALOGS.CHOOSE_LOCATION));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ChooseLocationAction);\r\n","import React from 'react';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\r\nimport { connect } from 'react-redux';\r\nimport CreateFolderAction from '../ContextMenu/ContextMenuActions/CreateFolderAction';\r\nimport CreateFileAction from '../ContextMenu/ContextMenuActions/CreateFileAction';\r\nimport UploadFileAction from '../ContextMenu/ContextMenuActions/UploadFileAction';\r\nimport ChooseLocationAction from '../ContextMenu/ContextMenuActions/ChooseLocationAction';\r\n\r\nclass ThreeDotsMenu extends React.Component {\r\n  state = {\r\n    anchorEl: null as HTMLElement|null,\r\n  };\r\n\r\n  handleClick = (event: React.MouseEvent<HTMLElement, MouseEvent>) => {\r\n    this.setState({ anchorEl: event.currentTarget });\r\n  };\r\n\r\n  handleClose = () => {\r\n    this.setState({ anchorEl: null });\r\n  };\r\n\r\n  render() {\r\n    const { anchorEl } = this.state;\r\n\r\n    return (\r\n      <div style={{marginLeft:'1em'}}>\r\n        <IconButton color=\"inherit\" \r\n          aria-label=\"More\"\r\n          aria-owns={Boolean(anchorEl) ? 'long-menu' : undefined}\r\n          aria-haspopup=\"true\"\r\n          onClick={this.handleClick}>\r\n          <MoreVertIcon />\r\n        </IconButton>\r\n\r\n        <Menu anchorEl={anchorEl} open={Boolean(anchorEl)} onClose={this.handleClose}>\r\n          <CreateFolderAction handleClose={this.handleClose} />\r\n          <CreateFileAction handleClose={this.handleClose} />\r\n          <UploadFileAction handleClose={this.handleClose} />\r\n          <ChooseLocationAction handleClose={this.handleClose} />\r\n        </Menu>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n\r\nconst mapStateToProps = () => ({});\r\n\r\nconst mapDispatchToProps = () => ({});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ThreeDotsMenu);\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withStyles, createStyles, Theme, WithStyles } from '@material-ui/core/styles';\r\nimport KeyboardArrowLeftIcon from '@material-ui/icons/KeyboardArrowLeft';\r\nimport Button from '@material-ui/core/Button';\r\nimport './BreadcrumbText.css';\r\n\r\nconst styles = (theme: Theme) => createStyles({\r\n  lastPath: {\r\n    display: 'block',\r\n    [theme.breakpoints.up('sm')]: {\r\n      display: 'none'\r\n    }\r\n  },\r\n  paths: {\r\n    display: 'none',\r\n    [theme.breakpoints.up('sm')]: {\r\n      display: 'block',\r\n    }\r\n  }\r\n});\r\n\r\nclass BreadcrumbText extends Component<BreadcrumbTextProps> {\r\n\r\n    render() {\r\n        const { classes, handleClickPath, path, rootTitle, handleGoBack, canGoBack } = this.props;\r\n\r\n        const separator = <span>&gt;</span>;\r\n        const rootPath = <span onClick={() => handleClickPath(-1)} data-index={0}>\r\n            { rootTitle } { path.length ? separator : '' }\r\n        </span>;\r\n        const lastPath = [...path].pop() || rootTitle;\r\n\r\n        const directories = path.map((dir, index) => {\r\n            return <span key={index} data-index={index} onClick={(e) => handleClickPath(index)}>\r\n                <span>{dir}</span> { path.length -1 !== index ? separator : '' }&nbsp;\r\n            </span>\r\n        });\r\n\r\n        return (\r\n            <div className=\"BreadcrumbText\">\r\n                <div className={classes.lastPath}>\r\n                    <Button onClick={handleGoBack} color=\"inherit\" type=\"button\" style={{display: canGoBack ? 'inline-flex' : 'none'}}>\r\n                        <KeyboardArrowLeftIcon />\r\n                    </Button>\r\n                    {lastPath}\r\n                </div>\r\n                <div className={classes.paths}>{rootPath} {directories}</div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\ninterface BreadcrumbTextProps extends WithStyles<typeof styles> {\r\n    handleClickPath(index: number): void;\r\n    handleGoBack(): void;\r\n    canGoBack: boolean;\r\n    path: string[];\r\n    rootTitle: string;\r\n\r\n}\r\n\r\nconst mapDispatchToProps = () => ({});\r\n\r\nconst mapStateToProps = () => ({});\r\n\r\nexport default withStyles(styles)(connect(mapStateToProps, mapDispatchToProps)(BreadcrumbText));\r\n","import React, { ChangeEvent } from 'react';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport InputBase from '@material-ui/core/InputBase';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport { fade } from '@material-ui/core/styles/colorManipulator';\r\nimport { withStyles, Theme, createStyles, WithStyles } from '@material-ui/core/styles';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport RefreshIcon from '@material-ui/icons/Refresh';\r\nimport { connect } from 'react-redux';\r\nimport { refreshItemList, moveFolderUpwardsAndRefresh, filterItems, MyDispatch } from '../../Actions/Actions';\r\nimport ThreeDotsMenu from './ThreeDotsMenu';\r\nimport BreadcrumbText from '../Breadcrumb/BreadcrumbText';\r\nimport { AppState } from '../../Reducers/reducer';\r\n\r\nconst styles = (theme: Theme) => createStyles({\r\n  root: {\r\n    width: '100%',\r\n    marginBottom: '4.3em'\r\n  },\r\n  grow: {\r\n    flexGrow: 1,\r\n  },\r\n  menuButton: {\r\n    marginLeft: -12,\r\n    marginRight: 20,\r\n  },\r\n  title: {\r\n    display: 'block', // was none\r\n    [theme.breakpoints.up('sm')]: {\r\n      display: 'block',\r\n    },\r\n  },\r\n  search: {\r\n    position: 'relative',\r\n    borderRadius: theme.shape.borderRadius,\r\n    backgroundColor: fade(theme.palette.common.white, 0.15),\r\n    '&:hover': {\r\n      backgroundColor: fade(theme.palette.common.white, 0.25),\r\n    },\r\n    marginLeft: 0,\r\n    width: '100%',\r\n    display: 'none',\r\n    [theme.breakpoints.up('sm')]: {\r\n      marginLeft: theme.spacing.unit,\r\n      width: 'auto',\r\n      display: 'block'\r\n    },\r\n  },\r\n  searchIcon: {\r\n    width: theme.spacing.unit * 9,\r\n    height: '100%',\r\n    position: 'absolute',\r\n    pointerEvents: 'none',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  inputRoot: {\r\n    color: 'inherit',\r\n    width: '100%',\r\n  },\r\n  inputInput: {\r\n    paddingTop: theme.spacing.unit,\r\n    paddingRight: theme.spacing.unit,\r\n    paddingBottom: theme.spacing.unit,\r\n    paddingLeft: theme.spacing.unit * 10,\r\n    transition: theme.transitions.create('width'),\r\n    width: '100%',\r\n    [theme.breakpoints.up('sm')]: {\r\n      width: 100,\r\n      '&:focus': {\r\n        width: 200,\r\n      },\r\n    },\r\n  },\r\n});\r\n\r\nfunction SearchAppBar(props: SearchAppBarProps) {\r\n  const { classes, path, filter, moveUpwards, canGoBack, handleChange, handleRefresh } = props;\r\n  return (\r\n    <div className={classes.root}>\r\n      <AppBar position=\"fixed\">\r\n        <Toolbar>\r\n          <Typography className={classes.title} variant=\"h6\" color=\"inherit\" noWrap>\r\n            <BreadcrumbText \r\n                path={path} \r\n                handleClickPath={index => moveUpwards(path.length - index - 1)} \r\n                handleGoBack={() => moveUpwards(1)}\r\n                canGoBack={canGoBack}\r\n                rootTitle=\"Root\"\r\n            />\r\n          </Typography>\r\n          <div className={classes.grow} />\r\n\r\n          <div className={classes.search}>\r\n            <div className={classes.searchIcon}>\r\n              <SearchIcon />\r\n            </div>\r\n            <InputBase\r\n              placeholder=\"Search…\"\r\n              value={filter}\r\n              onChange={handleChange}\r\n              classes={{\r\n                root: classes.inputRoot,\r\n                input: classes.inputInput,\r\n              }}\r\n            />\r\n          </div>\r\n          <IconButton color=\"inherit\" aria-label=\"Refresh\" onClick={handleRefresh}>\r\n            <RefreshIcon/>\r\n          </IconButton>\r\n          <ThreeDotsMenu />\r\n        </Toolbar>\r\n      </AppBar>\r\n    </div>\r\n  );\r\n}\r\n\r\ninterface StateProps {\r\n  filter: string;\r\n  path: string[];\r\n  canGoBack: boolean; \r\n}\r\ninterface DispatchProps {\r\n  handleChange(event: ChangeEvent<HTMLInputElement>): void;\r\n  moveUpwards(n: number): void;\r\n  handleRefresh(): void;\r\n}\r\ninterface SearchAppBarProps extends StateProps, DispatchProps, WithStyles<typeof styles> {\r\n\r\n}\r\n\r\n\r\nconst mapStateToProps = (state: AppState): StateProps => {\r\n    return {\r\n        filter: state.items.filter,\r\n        path: state.path,\r\n        canGoBack: state.path.length > 0,\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch): DispatchProps => {\r\n    return {\r\n        handleChange: (event) => {\r\n            dispatch(filterItems(event.currentTarget.value));\r\n        },\r\n        moveUpwards: (n) => {\r\n          dispatch(moveFolderUpwardsAndRefresh(n));\r\n        },\r\n        handleRefresh: () => dispatch(refreshItemList())\r\n    };\r\n};\r\n\r\n\r\nexport default withStyles(styles)(connect(mapStateToProps, mapDispatchToProps)(SearchAppBar));\r\n","import React from 'react';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport { connect } from 'react-redux';\r\nimport { loadAndDisplayFile, displaySelectedMediaFile, loadAndEditFile, enterFolderByItem, MyDispatch } from '../../../Actions/Actions';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport OpenInBrowserIcon from '@material-ui/icons/OpenInBrowser';\r\nimport { FileItem, FolderItem, Item } from '../../../Api/Item';\r\nimport { AppState } from '../../../Reducers/reducer';\r\n\r\nfunction OpenAction(props: OpenActionProps) {\r\n    const { handleClick, selectedItems } = props;\r\n    return (\r\n        <MenuItem onClick={() => handleClick(selectedItems)}>\r\n            <ListItemIcon>\r\n                <OpenInBrowserIcon />\r\n            </ListItemIcon>\r\n            <Typography variant=\"inherit\">\r\n                Open\r\n            </Typography>\r\n        </MenuItem>        \r\n    );\r\n}\r\n\r\ninterface OpenActionProps {\r\n    handleClick(selectedItems: Item[]): void;\r\n    selectedItems: Item[];\r\n}\r\n\r\nconst mapStateToProps = (state: AppState) => {\r\n    return {\r\n        selectedItems: state.items.selected\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch) => {\r\n    return {\r\n        handleClick: (selectedItems: Item[]) => {\r\n            const item = selectedItems[0];\r\n\r\n            if (item instanceof FolderItem)\r\n                dispatch(enterFolderByItem(item));\r\n            else if (item instanceof FileItem) {\r\n                if (item.isEditable())\r\n                    dispatch(loadAndEditFile(item.name));\r\n                else if (item.isImage())\r\n                    dispatch(loadAndDisplayFile(item.name));\r\n                else if (item.isMedia())\r\n                    dispatch(displaySelectedMediaFile());\r\n            }\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(OpenAction);\r\n","import React from 'react';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport { connect } from 'react-redux';\r\nimport { removeItems, MyDispatch } from '../../../Actions/Actions';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport { Item } from '../../../Api/Item';\r\nimport { AppState } from '../../../Reducers/reducer';\r\n\r\nfunction RemoveAction(props: RemoveActionProps) {\r\n    const { handleClick, selectedItems } = props;\r\n    return (\r\n        <MenuItem onClick={() => handleClick(selectedItems)}>\r\n            <ListItemIcon>\r\n                <DeleteIcon />\r\n            </ListItemIcon>\r\n            <Typography variant=\"inherit\">\r\n                Remove\r\n            </Typography>\r\n        </MenuItem>        \r\n    );\r\n}\r\n\r\ninterface RemoveActionProps {\r\n    handleClick(selectedItems: Item[]): void;\r\n    selectedItems: Item[];\r\n}\r\n\r\nconst mapStateToProps = (state: AppState) => {\r\n    return {\r\n        selectedItems: state.items.selected\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch) => {\r\n    return {\r\n        handleClick: (selectedItems: Item[]) => {\r\n            dispatch(removeItems(selectedItems));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(RemoveAction);\r\n","import React from 'react';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport { connect } from 'react-redux';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport HowToVoteIcon from '@material-ui/icons/HowToVote';\r\nimport { openDialog, MyDispatch } from '../../../Actions/Actions';\r\nimport { AppState } from '../../../Reducers/reducer';\r\nimport { DIALOGS } from '../../../Actions/actionTypes';\r\n\r\nfunction MoveAction(props: MoveActionProps) {\r\n    const { handleClick } = props;\r\n\r\n    return (\r\n        <MenuItem onClick={() => handleClick()}>\r\n            <ListItemIcon>\r\n                <HowToVoteIcon />\r\n            </ListItemIcon>\r\n            <Typography variant=\"inherit\">\r\n                Move\r\n            </Typography>\r\n        </MenuItem>        \r\n    );\r\n}\r\n\r\ninterface MoveActionProps {\r\n    handleClick(): void;\r\n}\r\n\r\nconst mapStateToProps = (state: AppState) => {\r\n    return {};\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch) => {\r\n    return {\r\n        handleClick: () => {\r\n            dispatch(openDialog(DIALOGS.MOVE));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MoveAction);\r\n","import React from 'react';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport { connect } from 'react-redux';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport FileCopyIcon from '@material-ui/icons/FileCopy';\r\nimport { openDialog, MyDispatch } from '../../../Actions/Actions';\r\nimport { AppState } from '../../../Reducers/reducer';\r\n//import { DIALOGS, Action } from '../../../Actions/actionTypes';\r\nimport { DIALOGS} from '../../../Actions/actionTypes';\r\n\r\nfunction CopyAction(props: CopyActionProps) {\r\n    const { handleClick } = props;\r\n\r\n    return (\r\n        <MenuItem onClick={handleClick}>\r\n            <ListItemIcon>\r\n                <FileCopyIcon />\r\n            </ListItemIcon>\r\n            <Typography variant=\"inherit\">\r\n                Copy\r\n            </Typography>\r\n        </MenuItem>        \r\n    );\r\n}\r\n\r\ninterface CopyActionProps {\r\n    handleClick(): void;\r\n}\r\n\r\nconst mapStateToProps = (state: AppState) => {\r\n    return {};\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch) => {\r\n    return {\r\n        handleClick: () => {\r\n            dispatch(openDialog(DIALOGS.COPY));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CopyAction);\r\n","import React from 'react';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport { connect } from 'react-redux';\r\nimport { loadAndEditFile, MyDispatch } from '../../../Actions/Actions';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport OpenInBrowserIcon from '@material-ui/icons/OpenInBrowser';\r\nimport { Item } from '../../../Api/Item';\r\nimport { AppState } from '../../../Reducers/reducer';\r\n\r\nfunction OpenAction(props: OpenActionProps) {\r\n    const { handleClick, selectedItems } = props;\r\n    return (\r\n        <MenuItem onClick={() => handleClick(selectedItems)}>\r\n            <ListItemIcon>\r\n                <OpenInBrowserIcon />\r\n            </ListItemIcon>\r\n            <Typography variant=\"inherit\">\r\n                Edit\r\n            </Typography>\r\n        </MenuItem>        \r\n    );\r\n}\r\n\r\ninterface OpenActionProps {\r\n    handleClick(selectedItems: Item[]): void;\r\n    selectedItems: Item[];\r\n}\r\n\r\nconst mapStateToProps = (state: AppState) => {\r\n    return {\r\n        selectedItems: state.items.selected\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch) => {\r\n    return {\r\n        handleClick: (selectedItems: Item[]) => {\r\n            dispatch(loadAndEditFile(selectedItems[0].name));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(OpenAction);\r\n","import React from 'react';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport { connect } from 'react-redux';\r\nimport { loadAndEditTags, MyDispatch } from '../../../Actions/Actions';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport OpenInBrowserIcon from '@material-ui/icons/OpenInBrowser';\r\nimport { Item } from '../../../Api/Item';\r\nimport { AppState } from '../../../Reducers/reducer';\r\n\r\nfunction EditTagsAction(props: EditTagsActionProps) {\r\n    const { handleClick, selectedItems } = props;\r\n    return (\r\n        <MenuItem onClick={() => handleClick(selectedItems)}>\r\n            <ListItemIcon>\r\n                <OpenInBrowserIcon />\r\n            </ListItemIcon>\r\n            <Typography variant=\"inherit\">\r\n                Edit tags\r\n            </Typography>\r\n        </MenuItem>        \r\n    );\r\n}\r\n\r\ninterface EditTagsActionProps {\r\n    handleClick(selectedItems: Item[]): void;\r\n    selectedItems: Item[];\r\n}\r\n\r\nconst mapStateToProps = (state: AppState) => {\r\n    return {\r\n        selectedItems: state.items.selected\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch) => {\r\n    return {\r\n        handleClick: (selectedItems: Item[]) => {\r\n            dispatch(loadAndEditTags(selectedItems[0].name));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EditTagsAction);\r\n","import React from 'react';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport { connect } from 'react-redux';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport WrapTextIcon from '@material-ui/icons/WrapText';\r\nimport { openDialog, MyDispatch } from '../../../Actions/Actions';\r\nimport { AppState } from '../../../Reducers/reducer';\r\nimport { DIALOGS } from '../../../Actions/actionTypes';\r\n\r\nfunction MoveAction(props: MoveActionProps) {\r\n    const { handleClick } = props;\r\n\r\n    return (\r\n        <MenuItem onClick={handleClick}>\r\n            <ListItemIcon>\r\n                <WrapTextIcon />\r\n            </ListItemIcon>\r\n            <Typography variant=\"inherit\">\r\n                Rename\r\n            </Typography>\r\n        </MenuItem>        \r\n    );\r\n}\r\n\r\ninterface MoveActionProps {\r\n    handleClick(): void;\r\n}\r\n\r\nconst mapStateToProps = (state: AppState) => {\r\n    return {};\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch) => {\r\n    return {\r\n        handleClick: () => {\r\n            dispatch(openDialog(DIALOGS.RENAME));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MoveAction);\r\n","import React from 'react';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport { connect } from 'react-redux';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport ArchiveIcon from '@material-ui/icons/Archive';\r\nimport { zipAndUpload, MyDispatch } from '../../../Actions/Actions';\r\nimport { Item } from '../../../Api/Item';\r\nimport { AppState } from '../../../Reducers/reducer';\r\n\r\nfunction ZipAction(props: ZipActionProps) {\r\n    const { handleClick, selectedItems } = props;\r\n\r\n    return (\r\n        <MenuItem onClick={() => handleClick(selectedItems)}>\r\n            <ListItemIcon>\r\n                <ArchiveIcon />\r\n            </ListItemIcon>\r\n            <Typography variant=\"inherit\">\r\n                Zip here\r\n            </Typography>\r\n        </MenuItem>        \r\n    );\r\n}\r\n\r\ninterface ZipActionProps {\r\n    handleClick(selectedItems: Item[]): void;\r\n    selectedItems: Item[];\r\n}\r\n\r\nconst mapStateToProps = (state: AppState) => {\r\n    return {\r\n        selectedItems: state.items.selected\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch) => {\r\n    return {\r\n        handleClick: (selectedItems: Item[]) => {\r\n            dispatch(zipAndUpload(selectedItems));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ZipAction);\r\n","import React from 'react';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport { connect } from 'react-redux';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport UnarchiveIcon from '@material-ui/icons/Unarchive';\r\nimport { extractZipFile, MyDispatch } from '../../../Actions/Actions';\r\nimport { AppState } from '../../../Reducers/reducer';\r\nimport { Item } from '../../../Api/Item';\r\n\r\nfunction ExtractAction(props: ExtractActionProps) {\r\n    const {handleClick, selectedItems} = props;\r\n\r\n    return (\r\n        <MenuItem onClick={() => handleClick(selectedItems)}>\r\n            <ListItemIcon>\r\n                <UnarchiveIcon />\r\n            </ListItemIcon>\r\n            <Typography variant=\"inherit\">\r\n                Extract here\r\n            </Typography>\r\n        </MenuItem>        \r\n    );\r\n}\r\n\r\ninterface ExtractActionProps {\r\n    handleClick(selectedItems: Item[]): void;\r\n    selectedItems: Item[];\r\n}\r\n\r\nconst mapStateToProps = (state: AppState) => {\r\n    return {\r\n        selectedItems: state.items.selected\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch) => {\r\n    return {\r\n        handleClick: (selectedItems: Item[]) => {\r\n            dispatch(extractZipFile(selectedItems[0].name));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ExtractAction);\r\n","import React from 'react';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport { connect } from 'react-redux';\r\nimport { downloadItems, MyDispatch } from '../../../Actions/Actions';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport CloudDownloadIcon from '@material-ui/icons/CloudDownload';\r\nimport { FileItem, Item } from '../../../Api/Item';\r\nimport { AppState } from '../../../Reducers/reducer';\r\n\r\nfunction DownloadAction(props: DownloadActionProps) {\r\n    const { handleClick, selectedItems } = props;\r\n    return (\r\n        <MenuItem onClick={() => handleClick(selectedItems)}>\r\n            <ListItemIcon>\r\n                <CloudDownloadIcon />\r\n            </ListItemIcon>\r\n            <Typography variant=\"inherit\">\r\n                {(selectedItems.length === 1 && selectedItems[0] instanceof FileItem) ? \r\n                    'Download'\r\n                    : 'Download Zip'\r\n                }\r\n            </Typography>\r\n        </MenuItem>        \r\n    );\r\n}\r\n\r\ninterface DownloadActionProps {\r\n    handleClick(selectedItems: Item[]): void;\r\n    selectedItems: Item[];\r\n}\r\n\r\nconst mapStateToProps = (state: AppState) => {\r\n    return {\r\n        selectedItems: state.items.selected\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch) => {\r\n    return {\r\n        handleClick: (selectedItems: Item[]) => {\r\n            dispatch(downloadItems(selectedItems));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DownloadAction);\r\n","import React from 'react';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport { connect } from 'react-redux';\r\nimport { openInNewTab, MyDispatch } from '../../../Actions/Actions';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport LinkIcon from '@material-ui/icons/Link';\r\nimport { Item } from '../../../Api/Item';\r\nimport { AppState } from '../../../Reducers/reducer';\r\n\r\nfunction OpenInNewTabAction(props: OpenInNewTabActionProps) {\r\n    const { handleClick, selectedItems } = props;\r\n    return (\r\n        <MenuItem onClick={() => handleClick(selectedItems)}>\r\n            <ListItemIcon>\r\n                <LinkIcon   />\r\n            </ListItemIcon>\r\n            <Typography variant=\"inherit\">\r\n                Open in new Tab\r\n            </Typography>\r\n        </MenuItem>        \r\n    );\r\n}\r\n\r\ninterface OpenInNewTabActionProps {\r\n    handleClick(selectedItems: Item[]): void;\r\n    selectedItems: Item[];\r\n}\r\n\r\nconst mapStateToProps = (state: AppState) => {\r\n    return {\r\n        selectedItems: state.items.selected\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch) => {\r\n    return {\r\n        handleClick: (selectedItems: Item[]) => {\r\n            dispatch(openInNewTab(selectedItems[0]));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(OpenInNewTabAction);\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport './ContextMenu.css';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport OpenAction from './ContextMenuActions/OpenAction';\r\nimport RemoveAction from './ContextMenuActions/RemoveAction';\r\nimport MoveAction from './ContextMenuActions/MoveAction';\r\nimport CopyAction from './ContextMenuActions/CopyAction';\r\nimport EditAction from './ContextMenuActions/EditAction';\r\nimport EditTagsAction from './ContextMenuActions/EditTagsAction';\r\nimport RenameAction from './ContextMenuActions/RenameAction';\r\nimport ZipAction from './ContextMenuActions/ZipAction';\r\nimport ExtractAction from './ContextMenuActions/ExtractAction';\r\nimport DownloadAction from './ContextMenuActions/DownloadAction';\r\nimport OpenInNewTabAction from './ContextMenuActions/OpenInNewTabAction';\r\nimport UploadFileAction from './ContextMenuActions/UploadFileAction';\r\nimport { Item, FileItem, FolderItem } from '../../Api/Item';\r\nimport { AppState } from '../../Reducers/reducer';\r\n\r\nclass ContextMenu extends Component<ContextMenuProps> {\r\n\r\n    render() {\r\n        const { acts, open, x, y } = this.props;\r\n\r\n        return (\r\n            <div>\r\n                <Menu\r\n                    anchorReference=\"anchorPosition\"\r\n                    anchorPosition={{ top: y, left: x }}\r\n                    transformOrigin={{\r\n                        vertical: 'top',\r\n                        horizontal: 'left',\r\n                    }}\r\n                    open={open}\r\n                    onClose={() => { }}\r\n                    PaperProps={{ style: { width: 190 } }}>\r\n                    {acts.includes('open') && <OpenAction />}\r\n                    {acts.includes('openInNewTab') && <OpenInNewTabAction />}\r\n                    {acts.includes('download') && <DownloadAction />}\r\n                    {acts.includes('upload') && <UploadFileAction />}\r\n                    {acts.includes('compress') && <ZipAction />}\r\n                    {acts.includes('extract') && <ExtractAction />}\r\n                    {acts.includes('edit') && <EditAction />}\r\n                    {acts.includes('editTags') && <EditTagsAction />}\r\n                    {acts.includes('copy') && <CopyAction />}\r\n                    {acts.includes('move') && <MoveAction />}\r\n                    {acts.includes('rename') && <RenameAction />}\r\n                    {acts.includes('remove') && <RemoveAction />}\r\n                </Menu>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\ninterface StateProps {\r\n    acts: string[];\r\n    open: boolean;\r\n    x: number;\r\n    y: number;\r\n}\r\ninterface ContextMenuProps extends StateProps {}\r\n\r\n\r\nconst mapStateToProps = (state: AppState): StateProps => {\r\n    return {\r\n        x: state.contextMenu.x,\r\n        y: state.contextMenu.y,\r\n        open: state.contextMenu.open,\r\n        acts: getActionsForMultipleItems(state.items.selected),\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = () => ({});\r\n\r\n\r\n/**\r\n * Get available actions for multiple items\r\n */\r\nconst getActionsForMultipleItems = (items: Item[]): string[] => {\r\n    return items.length === 1 ?\r\n        getActionsForItem(items[0])\r\n        : [\r\n            'copy',\r\n            'move',\r\n            'remove',\r\n            'download',\r\n            'compress',\r\n        ];\r\n};\r\n\r\n/**\r\n * Get available actions for an item\r\n */\r\nconst getActionsForItem = (item: Item) => {\r\n    const commonActions = [\r\n        'openInNewTab',\r\n        'copy',\r\n        'move',\r\n        'rename',\r\n        'remove',\r\n        'download',\r\n        'editTags'\r\n    ];\r\n    return [\r\n        ...commonActions,\r\n        ...((item instanceof FileItem) ?\r\n            getActionsForFile(item)\r\n            : getActionsForFolder(item))\r\n    ];\r\n};\r\n\r\n/**\r\n * Get available file specific actions\r\n */\r\nconst getActionsForFile = (file: FileItem) => {\r\n    const actions = [];\r\n    file.isEditable() && actions.push('edit');\r\n    //actions.push('editTags');\r\n    file.isExtractable() && actions.push('extract');\r\n    (file.isImage() || file.isMedia()) && actions.push('open');\r\n\r\n    return actions;\r\n};\r\n\r\n/**\r\n * Get available folder specific actions\r\n */\r\nconst getActionsForFolder = (folder: FolderItem) => {\r\n    return [\r\n        'open',\r\n        'compress',\r\n        'upload'\r\n    ];\r\n};\r\n\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ContextMenu);","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { createBrowserHistory, History, Location } from \"history\";\r\nimport { MyDispatch, setHost, enterFolder } from \"../../Actions/Actions\";\r\nimport { AppState } from \"../../Reducers/reducer\";\r\n\r\nclass HistoryHandler extends Component<HistoryHandlerProps> {\r\n    private history: History<LocationState>;\r\n    private states: LocationState[];\r\n    private stateIndex: number;\r\n\r\n    constructor(props: HistoryHandlerProps) {\r\n        super(props);\r\n\r\n        this.states = [];\r\n        this.stateIndex = -1;\r\n        this.history = createBrowserHistory();\r\n        this.history.listen((location, action) => {\r\n            switch(action) {\r\n                case 'POP':\r\n                    this.handlePop(location);\r\n                    break;\r\n                case 'REPLACE':\r\n                    this.handleReplace(location);\r\n                    break;\r\n                case 'PUSH':\r\n                    this.handlePush(location);\r\n                    break;\r\n            }\r\n        });\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        const { host, path } = this.props;\r\n\r\n        // Don't update history when the host is invalid\r\n        if (host === null)\r\n            return;\r\n        if (this.states.length === 0 || this.stateIndex < 0)\r\n            return this.updateBrowserHistory();\r\n        \r\n        const prevState = this.states[this.stateIndex];\r\n\r\n        if (!locationsEqual({ host, path }, prevState))\r\n            this.updateBrowserHistory();\r\n    }\r\n\r\n    updateBrowserHistory() {\r\n        const { host, path } = this.props;\r\n        const url = encodeURI(`${host}/${path.join('/')}`);\r\n        const newState = {\r\n            host: host || '',\r\n            path,\r\n            index: this.stateIndex + 1,\r\n        };\r\n\r\n        this.history.push(`?url=${url}`, newState);\r\n    }\r\n\r\n    handlePop(location: Location<LocationState>) {\r\n        this.stateIndex = location.state.index;\r\n        this.props.handlePop(location);\r\n    }\r\n\r\n    handleReplace(location: Location<LocationState>) {\r\n        this.states[this.stateIndex] = location.state;\r\n    }\r\n\r\n    handlePush(location: Location<LocationState>) {\r\n        this.states = [...this.states.slice(0, ++this.stateIndex), location.state];\r\n    }\r\n\r\n    render() {\r\n        // This Component doesn't provide anything to the DOM\r\n        // The only reason it is a component is to get access to the state and dispatch\r\n        return <></>;\r\n    }\r\n}\r\n\r\ninterface LocationState extends MyLocation {\r\n    index: number;\r\n}\r\ninterface MyLocation {\r\n    host: string;\r\n    path: string[];\r\n}\r\n\r\n\r\ninterface StateProps {\r\n    host: string | null;\r\n    path: string[];\r\n}\r\ninterface DispatchProps {\r\n    handlePop(location: Location<LocationState>): void;\r\n}\r\ninterface HistoryHandlerProps extends StateProps, DispatchProps { }\r\n\r\n\r\nconst mapStateToProps = (state: AppState): StateProps => ({\r\n    host: state.account.host,\r\n    path: state.path\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch): DispatchProps => {\r\n    return {\r\n        handlePop: (location: Location<LocationState>) => {\r\n            let host = '';\r\n            let path: string[] = [];\r\n\r\n            if (location && typeof location.state !== typeof undefined) {\r\n                ({ host, path } = location.state);\r\n            }\r\n            else {\r\n                const params = new URLSearchParams(location.search.substr(1));\r\n                const url = params.get('url');\r\n                if (url !== null) {\r\n                    ({ host, path } = getLocationObjectFromUrl(url));\r\n                }\r\n            }\r\n            dispatch(setHost(host));\r\n            dispatch(enterFolder(path));\r\n        }\r\n    };\r\n};\r\n\r\nexport const getLocationObjectFromUrl = (urlString: string) => {\r\n    const url = new URL(urlString);\r\n    const host = url.origin;\r\n    const path = url.pathname.split('/').filter(val => val !== '');\r\n\r\n    return {\r\n        host,\r\n        path\r\n    };\r\n}\r\n\r\nconst locationsEqual = (first: MyLocation, second: MyLocation) => {\r\n    return first.host === second.host\r\n           && first.path.length === second.path.length\r\n           && first.path.every((val, index) => val === second.path[index]);\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(HistoryHandler);\r\n","import React, { Component } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { connect } from 'react-redux';\r\nimport { solidLogin, setHost, enterFolder, solidLogout, clearCache, MyDispatch, setErrorMessage, closeDialog } from '../../../Actions/Actions';\r\nimport { getLocationObjectFromUrl } from '../../HistoryHandler/HistoryHandler';\r\nimport { DialogButtonClickEvent, DialogDispatchProps, DialogStateProps } from '../dialogTypes';\r\nimport { AppState } from '../../../Reducers/reducer';\r\nimport { DIALOGS } from '../../../Actions/actionTypes';\r\n\r\nclass FormDialog extends Component<ChooseLocationProps> {\r\n    state = {\r\n        location: '',\r\n    };\r\n\r\n    componentWillReceiveProps(props: ChooseLocationProps) {\r\n        const { isLoggedIn, webId } = props;\r\n        const params = new URLSearchParams(document.location.search.substr(1));\r\n        const encodedUrl = params.get('url');\r\n\r\n        if (encodedUrl !== null) {\r\n            const location = decodeURI(encodedUrl);\r\n            this.setState({ location });\r\n        }\r\n        else if (isLoggedIn && webId) {\r\n            const location = (new URL(webId)).origin;\r\n            this.setState({ location });\r\n        }\r\n    }\r\n\r\n    handleChange(event: React.ChangeEvent<HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement>) {\r\n        const targetForm = event.currentTarget.form;\r\n        if (targetForm) {\r\n            const input = targetForm.querySelector('input');\r\n            if (input) {\r\n                const location = input.value;\r\n                this.setState({ location });\r\n                return;\r\n            }\r\n        }\r\n        console.log(\"Couldn't find location input\");\r\n    }\r\n\r\n    handleSubmit(event: DialogButtonClickEvent) {\r\n        this.props.handleSubmit(event, { location: this.state.location });\r\n    }\r\n\r\n    render() {\r\n        let { location } = this.state;\r\n        location = location ? location : '';\r\n        const { handleClose, handleLogin, handleLogout, open, isLoggedIn, webId } = this.props;\r\n\r\n        return (\r\n            <Dialog open={open} onClose={handleClose} aria-labelledby=\"form-dialog-choose-location\" fullWidth={true} maxWidth={'sm'}>\r\n                <form>\r\n                    <DialogTitle id=\"form-dialog-choose-location\">Choose the storage location</DialogTitle>\r\n                    <DialogContent>\r\n                        <Typography variant=\"body1\" gutterBottom>\r\n                            {!isLoggedIn ?\r\n                                \"If you want to access private resources, please login with the button below.\"\r\n                                : \"Logged in as \" + webId + \".\"\r\n                            }\r\n                        </Typography>\r\n                        {!isLoggedIn ?\r\n                            <Button variant=\"outlined\" color=\"primary\" onClick={handleLogin}>Login</Button>\r\n                            : <Button variant=\"outlined\" onClick={handleLogout}>Logout</Button>\r\n                        }\r\n\r\n                        <Typography variant=\"body1\">\r\n                            Please enter the directory you want to open below.\r\n                    </Typography>\r\n                        <TextField autoFocus fullWidth\r\n                            margin=\"normal\"\r\n                            label=\"Storage Location\"\r\n                            variant=\"outlined\"\r\n                            onChange={this.handleChange.bind(this)}\r\n                            value={location} />\r\n                    </DialogContent>\r\n                    <DialogActions>\r\n                        <Button onClick={handleClose} color=\"primary\" type=\"button\">\r\n                            Cancel\r\n                    </Button>\r\n                        <Button color=\"primary\" type=\"submit\" onClick={this.handleSubmit.bind(this)}>\r\n                            Open directory\r\n                    </Button>\r\n                    </DialogActions>\r\n                </form>\r\n            </Dialog>\r\n        );\r\n    }\r\n}\r\n\r\ninterface StateProps extends DialogStateProps {\r\n    webId: string | null;\r\n    isLoggedIn: boolean;\r\n}\r\ninterface DispatchProps extends DialogDispatchProps {\r\n    handleLogin(event: DialogButtonClickEvent): void;\r\n    handleLogout(event: DialogButtonClickEvent): void;\r\n    handleSubmit(event: DialogButtonClickEvent, { location }: { location: string }): void;\r\n}\r\ninterface ChooseLocationProps extends StateProps, DispatchProps { }\r\n\r\n\r\nconst mapStateToProps = (state: AppState): StateProps => {\r\n    return {\r\n        open: state.visibleDialogs.CHOOSE_LOCATION,\r\n        webId: state.account.webId,\r\n        isLoggedIn: state.account.loggedIn\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch): DispatchProps => {\r\n    return {\r\n        handleClose: () => {\r\n            dispatch(closeDialog(DIALOGS.CHOOSE_LOCATION));\r\n        },\r\n        handleLogin: event => {\r\n            event.preventDefault();\r\n            dispatch(solidLogin());\r\n        },\r\n        handleLogout: event => {\r\n            event.preventDefault();\r\n            dispatch(solidLogout());\r\n        },\r\n        handleSubmit: (event, { location }) => {\r\n            event.preventDefault();\r\n            if (!location)\r\n                return dispatch(setErrorMessage(\"Please enter the folder which should be opened\"));\r\n\r\n            const { host, path } = getLocationObjectFromUrl(location);\r\n            dispatch(closeDialog(DIALOGS.CHOOSE_LOCATION));\r\n            dispatch(setHost(host));\r\n            dispatch(clearCache());\r\n            dispatch(enterFolder(path));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FormDialog);\r\n","import React, { Component } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport { connect } from 'react-redux';\r\n//import { closeDialog, MyDispatch, openDialog } from '../../../Actions/Actions';\r\nimport { closeDialog, MyDispatch } from '../../../Actions/Actions';\r\nimport { DialogStateProps, DialogDispatchProps } from '../dialogTypes';\r\nimport { AppState } from '../../../Reducers/reducer';\r\nimport { DIALOGS } from '../../../Actions/actionTypes';\r\n\r\nclass FormDialog extends Component<ContentProps> {\r\n\r\n    state = {\r\n        lastBlobUrl: null,\r\n        content: '...',\r\n        loading: false\r\n    };\r\n\r\n    componentDidUpdate() {\r\n        if (this.props.blobUrl !== this.state.lastBlobUrl) {\r\n            this.setState({\r\n                lastBlobUrl: this.props.blobUrl\r\n            });\r\n            this.setState({\r\n                loading: true\r\n            });\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const { handleClose, open } = this.props;\r\n        return (\r\n          <div style={{marginLeft:'1em'}}>\r\n            <Dialog open={open} onClose={handleClose} aria-labelledby=\"form-dialog-content\" fullWidth={true} maxWidth={'sm'}>\r\n              <DialogTitle id=\"form-dialog-content\">Viewing file </DialogTitle>\r\n              <DialogContent>\r\n                <img src={this.props.blobUrl} alt=\"\" style={{maxWidth: '100%'}}/>\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={handleClose} color=\"primary\" type=\"button\">\r\n                  Close\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n          </div>\r\n        );\r\n    }\r\n}\r\n\r\ninterface StateProps extends DialogStateProps {\r\n    blobUrl: string | undefined;\r\n}\r\ninterface DispatchProps extends DialogDispatchProps {}\r\ninterface ContentProps extends StateProps, DispatchProps {}\r\n\r\nconst mapStateToProps = (state: AppState): StateProps => {\r\n    return {\r\n        open: state.visibleDialogs.CONTENT,\r\n        blobUrl: state.blob || undefined\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch): DialogDispatchProps => {\r\n    return {\r\n        handleClose: () => {\r\n            dispatch(closeDialog(DIALOGS.CONTENT));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FormDialog);\r\n","import React, { Component } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport { connect } from 'react-redux';\r\nimport { MyDispatch, closeDialog } from '../../../Actions/Actions';\r\nimport Plyr from 'react-plyr';\r\nimport 'plyr/dist/plyr.css';\r\nimport { FileItem } from '../../../Api/Item';\r\nimport { DialogStateProps, DialogDispatchProps } from '../dialogTypes';\r\nimport { AppState } from '../../../Reducers/reducer';\r\nimport { DIALOGS } from '../../../Actions/actionTypes';\r\n\r\nclass FormDialog extends Component<MediaProps> {\r\n    render() {\r\n        const { file, handleClose, open } = this.props;\r\n        const url = file ? file.url : undefined;\r\n        const type = file ? (file.isVideo() ? 'video' : 'audio') : undefined;\r\n\r\n        return (\r\n            <Dialog open={open} onClose={handleClose} aria-labelledby=\"form-dialog-display-media\" fullWidth={true} maxWidth={'lg'}>\r\n                <DialogTitle id=\"form-dialog-display-media\">Display Media</DialogTitle>\r\n                <DialogContent>\r\n                    {\r\n                        file ?\r\n                            (\r\n                                <div>\r\n                                    <p>Playing {file.name}</p>\r\n                                    <Plyr type={type} /*TODO: provider={provider}*/ url={url} iconUrl=\"./vendor/plyr/plyr.svg\" />\r\n                                </div>\r\n                            )\r\n                            : <p>No media file opened</p>\r\n                            \r\n                    }\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={handleClose} color=\"primary\" type=\"button\">\r\n                        Close\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n        );\r\n    }\r\n}\r\n\r\ninterface StateProps extends DialogStateProps {\r\n    file?: FileItem;\r\n}\r\ninterface MediaProps extends StateProps, DialogDispatchProps {}\r\n\r\n\r\nconst mapStateToProps = (state: AppState): StateProps => {\r\n    const open = state.visibleDialogs.MEDIA;\r\n\r\n    const file = state.items.selected[0];   \r\n\r\n    if (file instanceof FileItem) {\r\n            return {\r\n                open,\r\n                file,\r\n            };\r\n    }\r\n    return { open };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch): DialogDispatchProps => {\r\n    return {\r\n        handleClose: () => {\r\n            dispatch(closeDialog(DIALOGS.MEDIA));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FormDialog);\r\n","import React, { Component, createRef } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport { connect } from 'react-redux';\r\nimport { updateTextFile, MyDispatch, closeDialog } from '../../../Actions/Actions';\r\nimport { DialogStateProps, DialogDispatchProps, DialogButtonClickEvent } from '../dialogTypes';\r\nimport { AppState } from '../../../Reducers/reducer';\r\nimport { DIALOGS } from '../../../Actions/actionTypes';\r\nimport { Item } from '../../../Api/Item';\r\n\r\nclass FormDialog extends Component<EditProps> {\r\n    private textField: React.RefObject<HTMLTextAreaElement> = createRef();\r\n    state = {\r\n        lastBlobUrl: null as string|null,\r\n        content: null as string|null,\r\n        loading: false\r\n    };\r\n\r\n    componentDidUpdate() {\r\n        if (this.props.blobUrl !== this.state.lastBlobUrl) {\r\n            this.setState({\r\n                lastBlobUrl: this.props.blobUrl\r\n            });\r\n            this.setState({\r\n                loading: true\r\n            });\r\n\r\n            this.props.blobUrl && fetch(this.props.blobUrl).then(r => {\r\n                return r.text();\r\n            }).then(t => {\r\n                this.setState({\r\n                    content: t\r\n                });\r\n                this.setState({\r\n                    loading: false\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n    handleSave(event: DialogButtonClickEvent) {\r\n        event.preventDefault();\r\n        const textField = this.textField.current;\r\n        const item = this.props.item;\r\n        if (textField && item) {\r\n            const content = textField.value;\r\n            this.props.handleSubmit(event, {\r\n                itemName: item.name,\r\n                content\r\n            });\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const { handleClose, open, item } = this.props;\r\n        const itemName = item ? item.getDisplayName() : 'No item selected';\r\n        const textAreaStyle = {\r\n            width: '100%',\r\n            minHeight: '300px'\r\n        };\r\n        const textArea = <textarea style={textAreaStyle} defaultValue={this.state.content || ''} ref={this.textField} />;\r\n\r\n        return (\r\n            <div>\r\n              <Dialog open={open} onClose={handleClose} aria-labelledby=\"form-dialog-edit\" fullWidth={true} maxWidth={'sm'}>\r\n                <form>\r\n                  <DialogTitle id=\"form-dialog-edit\">Editing file {itemName} </DialogTitle>\r\n                  <DialogContent>\r\n                    <DialogContentText>\r\n                      {this.state.loading ? 'Loading...' : textArea}\r\n                    </DialogContentText>\r\n                  </DialogContent>\r\n                  <DialogActions>\r\n                    <Button onClick={handleClose} color=\"primary\" type=\"button\">\r\n                      Close\r\n                    </Button>\r\n                    <Button color=\"primary\" onClick={this.handleSave.bind(this)} type=\"submit\">\r\n                      Update\r\n                    </Button>\r\n                  </DialogActions>\r\n                </form>\r\n              </Dialog>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\ninterface StateProps extends DialogStateProps {\r\n    item: Item;\r\n    blobUrl: string;\r\n}\r\ninterface DispatchProps extends DialogDispatchProps {\r\n    handleSubmit(event: DialogButtonClickEvent, { itemName, content }: { itemName: string, content: string }): void;\r\n}\r\ninterface EditProps extends StateProps, DispatchProps {}\r\n\r\nconst mapStateToProps = (state: AppState): StateProps => {\r\n    return {\r\n        open: state.visibleDialogs.EDIT, // TODO: rename visibleDialogs (e.g. to dialogIsOpen)\r\n        item: state.items.selected[0],\r\n        blobUrl: state.blob || ''\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch): DispatchProps => {\r\n    return {\r\n        handleClose: () => {\r\n            dispatch(closeDialog(DIALOGS.EDIT));\r\n        },\r\n        handleSubmit: (event, { itemName, content }) => {\r\n            dispatch(updateTextFile(itemName, content));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FormDialog);\r\n","export default function CallJsonP(callback1, searchedString) {\r\n    const autoComplete = `https://suggestqueries.google.com/complete/search?client=firefox&q=${searchedString}`\r\n    jsonp(\r\n        autoComplete,\r\n        (response) => callback1(response)\r\n    );\r\n}\r\n\r\nconst jsonp = (url, callback2) => {\r\n    const callbackName = 'jsonp_callback_' + Math.round(100000 * Math.random());\r\n    window[callbackName] = function (data) {\r\n        delete window[callbackName];\r\n        document.body.removeChild(script);\r\n        callback2(data);\r\n    };\r\n\r\n    var script = document.createElement('script');\r\n    script.src =\r\n        url + (url.indexOf('?') >= 0 ? '&' : '?') + 'callback=' + callbackName;\r\n    document.body.appendChild(script);\r\n};\r\n","import React from 'react';\r\nimport MetaUtils, { Meta, MetaTag, onServerColor } from '../../../Api/MetaUtils';\r\nimport CreatableSelect from 'react-select/creatable';\r\nimport CallJsonP from '../../../Api/jsonp';\r\nimport Radio from '@material-ui/core/Radio';\r\nimport RadioGroup from '@material-ui/core/RadioGroup';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\n//import { styled } from '@material-ui/styles';\r\nimport './Autocomplete.css'\r\n\r\ninterface MultiValueLabelProps {\r\n    children: {},\r\n    data: MetaTag\r\n}\r\n\r\n//Each tag is a MultiValueLabel in Autocomplete componennt\r\nclass MultiValueLabel extends React.Component<MultiValueLabelProps> {\r\n    //Click a tag to publish it\r\n    tagHandleClick() {\r\n        this.props.data.published = !this.props.data.published\r\n        this.forceUpdate()\r\n    }\r\n\r\n    render() {\r\n        const { data } = this.props;\r\n        const styles = {\r\n            color: data.published ? onServerColor : 'black'\r\n        };\r\n\r\n        return (\r\n            <div id={data.value}\r\n                style={styles}\r\n                onClick={this.tagHandleClick.bind(this)}>\r\n                {data.tagType}: {data.value}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n/*\r\nconst MyCheckbox = styled(Checkbox)({\r\n    padding: '0 0 0 0'\r\n});\r\n\r\nconst MyFormControlLabel = styled(FormControlLabel)({\r\n    padding: '0 15px 5px 0'\r\n});\r\nconst MyRadio = styled(Radio)({\r\n    padding: '0 20px 5px 0px'\r\n});\r\n*/\r\n\r\ninterface PopupProps {\r\n    [x: string]: any,\r\n    meta: Meta,\r\n    setSaveText(saveTextLevel: number): void;\r\n}\r\n\r\ninterface PopupState {\r\n    suggests: Suggestion[]\r\n}\r\n//Suggestions (options in component) need label additional property\r\ninterface Suggestion extends MetaTag {\r\n    label: string\r\n}\r\n\r\nexport default class AutocompleteTag extends React.Component<PopupProps, PopupState> {\r\n\r\n    constructor(props: PopupProps) {\r\n        super(props);\r\n        this.state = { suggests: [] };\r\n        this.creatableSelect = React.createRef();\r\n        this.focusCreatableSelect = this.focusCreatableSelect.bind(this);\r\n    }\r\n\r\n    creatableSelect = {} as React.RefObject<PopupProps>\r\n    source = 'local'\r\n    lastStr = ''\r\n\r\n    focusCreatableSelect() {\r\n        if (this.creatableSelect.current) this.creatableSelect.current.focus();\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.focusCreatableSelect()\r\n    }\r\n\r\n    //select a suggestion or delete a tag: items parameter is the list of ALL selected values\r\n    handleChangeTagList(items: Suggestion[]) {\r\n        this.props.meta.tags = items\r\n        this.setSaveTextParameter()\r\n        this.forceUpdate()\r\n    }\r\n\r\n    //Called from here when modifying the list of tags and send to parent\r\n    setSaveTextParameter() {\r\n        let saveTextLevel = 0\r\n        if (this.props.meta.tags) {\r\n            this.props.meta.tags.forEach((tag) => {\r\n                if (saveTextLevel === 0) {\r\n                    if (tag.published) saveTextLevel = 3\r\n                    if (!tag.published) saveTextLevel = 1\r\n                }\r\n                if ((saveTextLevel === 1 && tag.published)\r\n                    || (saveTextLevel === 3 && !tag.published)) {\r\n                    saveTextLevel = 2\r\n                }\r\n            })\r\n        }\r\n        this.props.setSaveText(saveTextLevel)\r\n    }\r\n\r\n    //Change source of suggestions for tags\r\n    handleRadioChange = (event: React.ChangeEvent<{}>, value: string) => {\r\n        this.source = value\r\n        this.handleChange(this.lastStr)\r\n        this.forceUpdate()\r\n    };\r\n\r\n    //type a letter. items in suggestions are Metatag\r\n    handleChange(str: string) {\r\n        if (str !== \"\") {\r\n            this.lastStr = str\r\n            let retVal = [] as Suggestion[]\r\n            if (this.source === 'google') {\r\n                CallJsonP((suggests: any[]) => {\r\n                    //suggests[1] creates a new Io\r\n                    suggests[1].forEach((item: string) => {\r\n                        const suggestion: Suggestion = { 'tagType': 'FreeTag', 'value': item, published: false, 'label': item }\r\n                        retVal.push(suggestion)\r\n                    })\r\n                    this.setState({ suggests: retVal })\r\n                }\r\n                    , str);\r\n            }\r\n\r\n            if (this.source === 'local') {\r\n                MetaUtils.getLocalUsedTags()\r\n                    .then((foundTags: MetaTag[]) => {\r\n                        foundTags.forEach(tag => {\r\n                            const suggestion: Suggestion = { 'tagType': 'FreeTag', 'value': tag.value, published: false, 'label': tag.value }\r\n                            retVal.push(suggestion);\r\n                        })\r\n                        this.setState({ suggests: retVal })\r\n                    })\r\n            }\r\n\r\n            if (this.source === 'central') {\r\n                MetaUtils.getCentralUsedTags()\r\n                    .then((foundTags: MetaTag[]) => {\r\n                        foundTags.forEach(tag => {\r\n                            const suggestion: Suggestion = { 'tagType': 'FreeTag', 'value': tag.value, published: false, 'label': tag.value }\r\n                            retVal.push(suggestion);\r\n                        })\r\n                        this.setState({ suggests: retVal })\r\n                    })\r\n            }\r\n        }\r\n        //Also trigered when clikcing on item to make it published/not\r\n        this.setSaveTextParameter()\r\n    }\r\n\r\n    //set all to published\r\n    selectAllToCentral(event: React.ChangeEvent<HTMLInputElement>) {\r\n        this.props.meta.tags.forEach((tag) => {\r\n            tag.published = event.target.checked\r\n        })\r\n        this.setSaveTextParameter()\r\n        this.forceUpdate()\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className='bodyPlace'>\r\n                <div className='leftplace'>\r\n                    <FormControl>\r\n                        <RadioGroup aria-label=\"gender\" value={this.source} onChange={this.handleRadioChange}>\r\n                            <FormControlLabel value=\"local\" control={<Radio color=\"primary\" style={{padding: '0 20px 5px 0px'}}/>} label=\"Local\" labelPlacement=\"start\" style={{padding: '0 15px 5px 0'}}/>\r\n                            <FormControlLabel value=\"central\" control={<Radio color=\"primary\" style={{padding: '0 20px 5px 0px'}}/>} label=\"Central\" labelPlacement=\"start\" style={{padding: '0 15px 5px 0'}} />\r\n                            <FormControlLabel value=\"google\" control={<Radio color=\"primary\" style={{padding: '0 20px 5px 0px'}}/>} label=\"Google\" labelPlacement=\"start\" style={{padding: '0 15px 5px 0'}}  />\r\n                        </RadioGroup>\r\n                    </FormControl>\r\n                </div>\r\n                <div className='rightplace'>\r\n                    <div>\r\n                        <CreatableSelect\r\n                            ref={this.creatableSelect}\r\n                            components={{ MultiValueLabel }}\r\n                            options={this.state.suggests}\r\n                            value={this.props.meta.tags}\r\n                            isMulti\r\n                            className='creatableSelect'\r\n                            onChange={this.handleChangeTagList.bind(this)}\r\n                            onInputChange={this.handleChange.bind(this)}\r\n                        />\r\n                    </div>\r\n                    <div>\r\n                        <Checkbox\r\n                            color=\"primary\" style={{padding: '0 0 0 0'}}\r\n                            onChange={e => this.selectAllToCentral(e)}\r\n                        /> Publish all tags to central\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import React, { Component } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport { connect } from 'react-redux';\r\nimport { updateMeta, MyDispatch, closeDialog } from '../../../Actions/Actions';\r\nimport { DialogStateProps, DialogDispatchProps, DialogButtonClickEvent } from '../dialogTypes';\r\nimport { AppState } from '../../../Reducers/reducer';\r\nimport { DIALOGS } from '../../../Actions/actionTypes';\r\nimport { Item } from '../../../Api/Item';\r\nimport MetaUtils, { Meta, MetaTag } from '../../../Api/MetaUtils';\r\nimport AutocompleteTag from './AutocompleteTag'\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport Select from '@material-ui/core/Select';\r\n\r\nclass FormDialog extends Component<EditTagsProps> {\r\n\r\n    constructor(props: any) {\r\n        super(props)\r\n        this.setSaveText = this.setSaveText.bind(this)\r\n    }\r\n\r\n    //sent to TreeViewItem for expand/collapse handled here\r\n    setSaveText(saveTextLevel: number) {\r\n        if (saveTextLevel === 1) this.saveText = 'Save all to local'\r\n        if (saveTextLevel === 2) this.saveText = 'Save all to local and some to central'\r\n        if (saveTextLevel === 3) this.saveText = 'Save all to local and central'\r\n        this.setState({ saveText: this.saveText });\r\n    };\r\n\r\n    //Init mandatory as render sn invoked on left click on item, even before Edit tag is choosed\r\n    currentMeta = {} as Meta;\r\n    currentItem = {} as Item;\r\n    saveText = ''\r\n\r\n    componentDidUpdate() {\r\n        const itemUrl = new URL(this.currentItem.getUrl())\r\n        //In case this called on a item = file\r\n        //else we directly get the Meta\r\n        if (this.props.item\r\n            && (\r\n                this.currentMeta.hostName !== itemUrl.hostname\r\n                || this.currentMeta.pathName !== itemUrl.pathname\r\n            )) {\r\n            this.currentItem = this.props.item as Item\r\n            MetaUtils.getOrInitMeta(this.currentItem)\r\n                .then(response => {\r\n                    this.currentMeta = response;\r\n                })\r\n        }\r\n    }\r\n\r\n    //target function is MetaUtils.updateMeta\r\n    handleSave(event: DialogButtonClickEvent) {\r\n        event.preventDefault();\r\n        //cleanup new tags created with autocomplete properties (label and source)\r\n        let cleanedTags = [] as MetaTag[]\r\n        if (this.currentMeta.tags) {\r\n            this.currentMeta.tags.forEach(tag => {\r\n                cleanedTags.push({ 'tagType': 'FreeTag', 'value': tag.value, published: tag.published })\r\n            })\r\n        }\r\n        this.currentMeta.tags = cleanedTags\r\n        this.props.handleSubmit(event, this.currentMeta);\r\n        this.setState({ item: null })\r\n    }\r\n\r\n    handleClose = {}\r\n\r\n    //changes on mimeType\r\n    handleChange = (name: string) => (event: React.ChangeEvent<HTMLSelectElement>) => {\r\n        if (name === 'mimeType') this.currentMeta.mimeType = event.target.value\r\n        this.forceUpdate()\r\n    };\r\n\r\n    render() {\r\n        //handle close: Rdux, sent by store\r\n        const { handleClose, open, item } = this.props;\r\n\r\n        if (item) {\r\n            this.currentItem = item\r\n            this.handleClose = handleClose\r\n            let extension = '' as string\r\n            if (this.currentMeta && this.currentMeta.pathName) {\r\n                const spl = this.currentMeta.pathName.split('.') as string[]\r\n                if (spl.length > 1) extension = spl[1]\r\n            }\r\n\r\n            return (\r\n                <div id='1'>\r\n                    <Dialog id='2'\r\n                        fullScreen={false}\r\n                        open={open}\r\n                        onClose={handleClose}\r\n                        aria-labelledby=\"form-dialog-edit\"\r\n                        fullWidth={true} maxWidth={'sm'}\r\n                        PaperProps={{\r\n                            style: {\r\n                                overflow: 'visible'\r\n                            }\r\n                        }}\r\n                    >\r\n                        <form id='3 '>\r\n                            <DialogTitle\r\n                                id=\"form-dialog-edit\">Editing TAGS : {this.currentItem.getDisplayName()}\r\n                            </DialogTitle>\r\n                            <DialogContent\r\n                                style={{ overflow: 'visible' }}\r\n                            >\r\n                                <AutocompleteTag\r\n                                    meta={this.currentMeta}\r\n                                    setSaveText={this.setSaveText}\r\n\r\n                                />\r\n\r\n                                {extension === ''\r\n                                    ? (\r\n                                        <div><br />\r\n                                            File has no extension, enter file type:&nbsp;\r\n                                            <FormControl>\r\n\r\n                                                <Select\r\n                                                    native\r\n                                                    value={this.currentMeta.mimeType}\r\n                                                    onChange={this.handleChange('mimeType')}\r\n                                                >\r\n                                                    <option value=\"\" />\r\n                                                    <option value={'text-plain'}>text-plain</option>\r\n                                                    <option value={'multipart/mixed'}>mixed</option>\r\n                                                    <option value={'image/jpeg}'}>image</option>\r\n                                                </Select>\r\n                                            </FormControl>\r\n                                        </div>\r\n                                    ) : (<div><br />Extension file : {extension}</div>)}\r\n                            </DialogContent>\r\n                            <DialogActions>\r\n                                <Button onClick={handleClose} color=\"primary\" type=\"button\">\r\n                                    Close\r\n                                </Button>\r\n                                <Button color=\"primary\" onClick={this.handleSave.bind(this)} type=\"submit\">\r\n                                    {this.saveText}\r\n                                </Button>\r\n                            </DialogActions>\r\n                        </form>\r\n                    </Dialog>\r\n                </div >\r\n            );\r\n        } else return (null)\r\n    }\r\n}\r\n\r\ninterface StateProps extends DialogStateProps {\r\n    meta: Meta\r\n    item: Item\r\n    saveText: string\r\n}\r\n\r\ninterface DispatchProps extends DialogDispatchProps {\r\n    handleSubmit(event: DialogButtonClickEvent, meta: Meta): void;\r\n}\r\n\r\ninterface EditTagsProps extends StateProps, DispatchProps { }\r\n\r\nconst mapStateToProps = (state: AppState): StateProps => {\r\n    return {\r\n        open: state.visibleDialogs.EDITTAGS, // TODO: rename visibleDialogs (e.g. to dialogIsOpen)\r\n        meta: state.metas.selected[0],\r\n        item: state.items.selected[0],\r\n        saveText: ''\r\n    };\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch): DispatchProps => {\r\n    return {\r\n        handleClose: () => {\r\n            dispatch(closeDialog(DIALOGS.EDITTAGS));\r\n        },\r\n        handleSubmit: (event, meta) => {\r\n            dispatch(updateMeta(meta));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FormDialog);\r\n","import React, { Component, createRef } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport { connect } from 'react-redux';\r\n//import { createNewFolder, closeDialog, MyDispatch, setErrorMessage } from '../../../Actions/Actions';\r\nimport { createNewFolder, closeDialog, MyDispatch } from '../../../Actions/Actions';\r\nimport { DialogStateProps, DialogDispatchProps, DialogButtonClickEvent } from '../dialogTypes';\r\nimport { AppState } from '../../../Reducers/reducer';\r\nimport { DIALOGS } from '../../../Actions/actionTypes';\r\n\r\nclass FormDialog extends Component<CreateFolderProps> {\r\n    private textField: React.RefObject<HTMLInputElement> = createRef();\r\n\r\n    handleSubmit(event: DialogButtonClickEvent) {\r\n        const textField = this.textField.current;\r\n        if (textField) {\r\n            const folderName = textField.value;\r\n            this.props.handleSubmit(event, { folderName });\r\n        }\r\n    }\r\n\r\n    render() {\r\n        //const { handleClose, handleSubmit, open } = this.props;\r\n        const { handleClose, open } = this.props;\r\n\r\n        return (\r\n            <Dialog open={open} onClose={handleClose} aria-labelledby=\"form-dialog-create-folder\" fullWidth={true} maxWidth={'sm'}>\r\n                <form>\r\n                    <DialogTitle id=\"form-dialog-create-folder\">Create folder</DialogTitle>\r\n                    <DialogContent>\r\n                        <TextField autoFocus fullWidth margin=\"dense\" label=\"Folder name\" type=\"text\" inputRef={this.textField} />\r\n                    </DialogContent>\r\n                    <DialogActions>\r\n                        <Button onClick={handleClose} color=\"primary\" type=\"button\">\r\n                            Cancel\r\n                    </Button>\r\n                        <Button color=\"primary\" type=\"submit\" onClick={this.handleSubmit.bind(this)}>\r\n                            Save\r\n                    </Button>\r\n                    </DialogActions>\r\n                </form>\r\n            </Dialog>\r\n        );\r\n    }\r\n}\r\n\r\ninterface DispatchProps extends DialogDispatchProps {\r\n    handleSubmit(event: DialogButtonClickEvent, { folderName }: { folderName: string }): void;\r\n}\r\ninterface CreateFolderProps extends DialogStateProps, DispatchProps { }\r\n\r\nconst mapStateToProps = (state: AppState): DialogStateProps => {\r\n    return {\r\n        open: state.visibleDialogs.CREATE_FOLDER\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch): DispatchProps => {\r\n    return {\r\n        handleClose: () => {\r\n            dispatch(closeDialog(DIALOGS.CREATE_FOLDER));\r\n        },\r\n        handleSubmit: (event, { folderName }) => {\r\n            event.preventDefault();\r\n            dispatch(createNewFolder(folderName));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FormDialog);\r\n","import React, { Component, createRef } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport { connect } from 'react-redux';\r\n//import { createFile, closeDialog, MyDispatch, setErrorMessage } from '../../../Actions/Actions';\r\nimport { createFile, closeDialog, MyDispatch } from '../../../Actions/Actions';\r\nimport { AppState } from '../../../Reducers/reducer';\r\nimport { DialogStateProps, DialogDispatchProps, DialogButtonClickEvent } from '../dialogTypes';\r\nimport { DIALOGS } from '../../../Actions/actionTypes';\r\n\r\nclass FormDialog extends Component<CreateFileProps> {\r\n    private textField: React.RefObject<HTMLInputElement> = createRef();\r\n\r\n    handleSubmit(event: DialogButtonClickEvent) {\r\n        const textField = this.textField.current;\r\n        if (textField) {\r\n            const fileName = textField.value;\r\n            this.props.handleSubmit(event, { fileName });\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const { handleClose, open } = this.props;\r\n\r\n        return (\r\n            <Dialog open={open} onClose={handleClose} aria-labelledby=\"form-dialog-create-file\" fullWidth={true} maxWidth={'sm'}>\r\n                <form>\r\n                    <DialogTitle id=\"form-dialog-create-file\">Create file</DialogTitle>\r\n                    <DialogContent>\r\n                        <TextField autoFocus fullWidth margin=\"dense\" label=\"File name\" type=\"text\" inputRef={this.textField}/>\r\n                    </DialogContent>\r\n                    <DialogActions>\r\n                        <Button onClick={handleClose} color=\"primary\" type=\"button\">\r\n                            Cancel\r\n                    </Button>\r\n                        <Button color=\"primary\" type=\"submit\" onClick={this.handleSubmit.bind(this)}>\r\n                            Create\r\n                    </Button>\r\n                    </DialogActions>\r\n                </form>\r\n            </Dialog>\r\n        );\r\n    }\r\n}\r\n\r\ninterface DispatchProps extends DialogDispatchProps {\r\n    handleSubmit(event: DialogButtonClickEvent, { fileName }: { fileName: string }): void;\r\n}\r\ninterface CreateFileProps extends DialogStateProps, DispatchProps { }\r\n\r\nconst mapStateToProps = (state: AppState): DialogStateProps => {\r\n    return {\r\n        open: state.visibleDialogs.CREATE_FILE\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch): DispatchProps => {\r\n    return {\r\n        handleClose: () => {\r\n            dispatch(closeDialog(DIALOGS.CREATE_FILE));\r\n        },\r\n        handleSubmit: (event, { fileName }) => {\r\n            event.preventDefault();\r\n            dispatch(createFile(fileName));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FormDialog);\r\n","//import React, { Component, ChangeEvent, createRef } from 'react';\r\nimport React, { Component, createRef } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport { connect } from 'react-redux';\r\nimport { renameFile, renameFolder, MyDispatch, closeDialog } from '../../../Actions/Actions';\r\nimport { FolderItem, Item } from '../../../Api/Item';\r\nimport { DialogStateProps, DialogDispatchProps, DialogButtonClickEvent } from '../dialogTypes';\r\nimport { AppState } from '../../../Reducers/reducer';\r\nimport { DIALOGS } from '../../../Actions/actionTypes';\r\nclass FormDialog extends Component<RenameProps> {\r\n    private textField: React.RefObject<HTMLInputElement> = createRef();\r\n\r\n    handleSubmit(event: DialogButtonClickEvent) {\r\n        const textField = this.textField.current;\r\n        const item = this.props.item;\r\n        if (textField && item) {\r\n            const newName = textField.value;\r\n            this.props.handleSubmit(event, { item, newName });\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const { handleClose, open, item } = this.props;\r\n        const previousName = item ? item.name : '';\r\n\r\n        return (\r\n            <Dialog open={open} onClose={handleClose} aria-labelledby=\"form-dialog-create-folder\" fullWidth={true} maxWidth={'sm'}>\r\n                <form>\r\n                  <DialogTitle id=\"form-dialog-create-folder\">Rename</DialogTitle>\r\n                  <DialogContent>\r\n                    <TextField autoFocus fullWidth margin=\"dense\" label=\"Item name\" type=\"text\" inputRef={this.textField} defaultValue={previousName} />\r\n                  </DialogContent>\r\n                  <DialogActions>\r\n                    <Button onClick={handleClose} color=\"primary\" type=\"button\">\r\n                      Cancel\r\n                    </Button>\r\n                    <Button color=\"primary\" type=\"submit\" onClick={this.handleSubmit.bind(this)}>\r\n                      Save\r\n                    </Button>\r\n                  </DialogActions>\r\n                </form>\r\n            </Dialog>\r\n        );\r\n    }\r\n}\r\n\r\ninterface StateProps extends DialogStateProps {\r\n    item?: Item;\r\n}\r\ninterface DispatchProps extends DialogDispatchProps {\r\n    handleSubmit(event: DialogButtonClickEvent, { item, newName }: { item: Item, newName: string }): void;\r\n}\r\ninterface RenameProps extends StateProps, DispatchProps {}\r\n\r\n\r\nconst mapStateToProps = (state: AppState): StateProps => {\r\n    return {\r\n        open: state.visibleDialogs.RENAME,\r\n        item: state.items.selected[0],\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch): DispatchProps => {\r\n    return {\r\n        handleClose: () => {\r\n            dispatch(closeDialog(DIALOGS.RENAME));\r\n        },\r\n        handleSubmit: (event, { item, newName }) => {\r\n            event.preventDefault();\r\n            if (item instanceof FolderItem) // TODO: Create renameItem\r\n                dispatch(renameFolder(item.name, newName));\r\n            else\r\n                dispatch(renameFile(item.name, newName));\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FormDialog);\r\n","import React from 'react';\r\nimport ListItem from '@material-ui/core/ListItem';\r\n//import ListItemAvatar from '@material-ui/core/ListItemAvatar';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport FolderIcon from '@material-ui/icons/Folder';\r\nimport FileIcon from '@material-ui/icons/InsertDriveFile';\r\nimport blue from '@material-ui/core/colors/blue';\r\nimport '../File.css';\r\nimport { FileItem, Item } from '../../../Api/Item';\r\n\r\n// TODO: Check main differences between normal File.tsx component\r\nfunction FileSublist(props: OwnProps) {\r\n    const { item, isSelected, handleClick, handleDoubleClick } = props;\r\n    const iconStyle = {\r\n        backgroundColor: isSelected ? blue['A200'] : undefined\r\n    };\r\n    return (\r\n        <div className=\"File\" onClick={handleClick} data-selected={isSelected} onDoubleClick={handleDoubleClick}>\r\n        <h1>fileSublist.tsx</h1>\r\n            <ListItem>\r\n            <ListItemIcon>\r\n                        <div style={iconStyle}>\r\n                            { (item instanceof FileItem) ? <FileIcon /> : <FolderIcon />}\r\n                        </div>\r\n                    </ListItemIcon>\r\n                <ListItemText primary={item.name} secondary=\"\" />\r\n                <Divider absolute />\r\n            </ListItem>\r\n        </div>\r\n    );\r\n}\r\n\r\ninterface OwnProps {\r\n    item: Item;\r\n    isSelected: boolean;\r\n    handleClick(): void;\r\n    handleDoubleClick(): void;\r\n}\r\n\r\nexport default FileSublist;\r\n\r\n","import React from 'react';\r\nimport FileSublist from '../../File/FileSublist/FileSublist'; \r\nimport Loader from '../../Loader/Loader'; \r\nimport FileListEmptyMessage from '../FileListEmptyMessage';\r\nimport './FileListSublist.css'; \r\nimport { FolderItem } from '../../../Api/Item';\r\n\r\nfunction FileListSublist(props: OwnProps) {\r\n    const { items, isLoading, handleOpenFolder } = props;\r\n    \r\n    const itemComponents = items.map((item, key) => {\r\n        return <FileSublist\r\n            item={item}\r\n            isSelected={false}\r\n            handleClick={() => handleOpenFolder(item)}\r\n            handleDoubleClick={() => handleOpenFolder(item)}\r\n            key={key} />\r\n    });\r\n\r\n    return <div className=\"FileListSublist\">\r\n        { isLoading ? \r\n            <Loader /> : \r\n            itemComponents.length ? itemComponents : <FileListEmptyMessage />\r\n        }\r\n    </div>\r\n}\r\n\r\ninterface OwnProps {\r\n    items: FolderItem[];\r\n    isLoading: boolean;\r\n    handleOpenFolder(folder: FolderItem): void;\r\n}\r\n\r\nexport default FileListSublist;","import React, { Component } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport FileListSublist from '../../FileList/FileListSublist/FileListSublist'; \r\nimport KeyboardArrowLeftIcon from '@material-ui/icons/KeyboardArrowLeft';\r\nimport { Item, FolderItem } from '../../../Api/Item';\r\nimport * as ApiHandler from '../../../Api/ApiHandler';\r\n\r\nclass FormDialog extends Component<OwnProps, OwnState> {\r\n    private host: string;\r\n    private path: string[];\r\n\r\n    constructor(props: OwnProps) {\r\n        super(props);\r\n        const { initialPath, initialHost } = props;\r\n        this.host = initialHost;\r\n        this.path = initialPath;\r\n\r\n        this.state = {\r\n            items: [],\r\n            isLoading: true,\r\n        };\r\n    }\r\n\r\n    componentDidUpdate(prevProps: OwnProps) {\r\n        if (prevProps.initialHost !== this.props.initialHost\r\n            || prevProps.initialPath.join('') !== this.props.initialPath.join('')) {\r\n            this.host = this.props.initialHost;\r\n            this.path = this.props.initialPath;\r\n            this.updateItems();\r\n        }\r\n    }\r\n\r\n    handleGoBack() {\r\n        this.path = this.path.slice(0, -1);\r\n        this.updateItems();\r\n    }\r\n\r\n    handleOpenFolder(folder: FolderItem) {\r\n        this.path = [...folder.path, folder.name];\r\n        this.updateItems();\r\n    }\r\n\r\n    async updateItems() {\r\n        this.setState({ isLoading: true });\r\n        const items = (await ApiHandler.getItemList(this.path.join('/')))\r\n            .filter(item => item instanceof FolderItem);\r\n\r\n        this.setState({ isLoading: false, items });\r\n    }\r\n\r\n    render() {\r\n        const { open, handleClose, handleSubmit, actionName } = this.props;\r\n        const { items, isLoading } = this.state;\r\n        const host = this.host;\r\n        const path = this.path;\r\n        const url = `${host}/${path.join('/')}`;\r\n        const canGoBack = path.length > 0;\r\n        \r\n        return (\r\n            <Dialog open={open} onClose={handleClose} aria-labelledby=\"form-dialog-move\" fullWidth={true} maxWidth={'sm'}>\r\n                <form>\r\n                    <DialogTitle id=\"form-dialog-move\">\r\n                        {actionName} items to <small style={{color: 'grey'}}>{ url }</small>\r\n                    </DialogTitle>\r\n                    <DialogContent>\r\n                        <FileListSublist items={items} isLoading={isLoading} handleOpenFolder={this.handleOpenFolder.bind(this)}/>\r\n                    </DialogContent>\r\n                    <DialogActions>\r\n                        <Button onClick={this.handleGoBack.bind(this)} color=\"primary\" type=\"button\" disabled={!canGoBack}>\r\n                            <KeyboardArrowLeftIcon /> Go back directory\r\n                        </Button>\r\n\r\n                        <Button onClick={handleClose} color=\"primary\" type=\"button\">\r\n                            Cancel\r\n                        </Button>\r\n                        <Button color=\"primary\" onClick={(e) => handleSubmit({ host, path })} type=\"submit\">\r\n                            {actionName}\r\n                        </Button>\r\n                    </DialogActions>\r\n                </form>\r\n            </Dialog>\r\n        );\r\n    }\r\n}\r\n\r\ninterface OwnProps {\r\n    open: boolean;\r\n    actionName: string;\r\n    initialHost: string;\r\n    initialPath: string[];\r\n    handleSubmit({ host, path }: { host: string, path: string[] }): void;\r\n    handleClose(): void;\r\n}\r\n\r\ninterface OwnState {\r\n    items: Item[];\r\n    isLoading: boolean;\r\n}\r\n\r\nexport default FormDialog;\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { moveItems, closeDialog, MyDispatch } from '../../../Actions/Actions';\r\nimport { DialogStateProps } from '../dialogTypes';\r\nimport { Item } from '../../../Api/Item';\r\nimport { AppState } from '../../../Reducers/reducer';\r\nimport { DIALOGS } from '../../../Actions/actionTypes';\r\n\r\nimport ChooseLocation from '../ChooseLocation/ChooseLocation';\r\n\r\nfunction MoveDialog(props: MoveProps) {\r\n    const { initialHost, initialPath, selectedItems, open, handleClose, move } = props;\r\n\r\n    return <ChooseLocation\r\n        open={open}\r\n        actionName=\"Move\"\r\n        initialHost={initialHost}\r\n        initialPath={initialPath}\r\n        handleClose={handleClose}\r\n        handleSubmit={(location) => move(selectedItems, location)}\r\n    />\r\n}\r\n\r\n\r\ninterface StateProps extends DialogStateProps {\r\n    initialHost: string;\r\n    initialPath: string[];\r\n    selectedItems: Item[];\r\n}\r\ninterface DispatchProps {\r\n    handleClose(): void;\r\n    move(selectedItems: Item[], { host, path }: { host: string, path: string[] }): void;\r\n}\r\ninterface MoveProps extends StateProps, DispatchProps {}\r\n\r\n\r\n\r\nconst mapStateToProps = (state: AppState): StateProps => {\r\n    return {\r\n        open: state.visibleDialogs.MOVE,\r\n        initialHost: state.account.host || '',\r\n        initialPath: state.path,\r\n        selectedItems: state.items.selected,\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch): DispatchProps => {\r\n    return {\r\n        handleClose: () => {\r\n            dispatch(closeDialog(DIALOGS.MOVE));\r\n        },\r\n        move: (selectedItems, targetLocation) => {\r\n            dispatch(moveItems(selectedItems, targetLocation));\r\n        },\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MoveDialog);","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { copyItems, closeDialog, MyDispatch } from '../../../Actions/Actions';\r\nimport { DialogStateProps } from '../dialogTypes';\r\nimport { Item } from '../../../Api/Item';\r\nimport { AppState } from '../../../Reducers/reducer';\r\nimport { DIALOGS } from '../../../Actions/actionTypes';\r\n\r\nimport ChooseLocation from '../ChooseLocation/ChooseLocation';\r\n\r\nfunction CopyDialog(props: CopyProps) {\r\n    const { initialHost, initialPath, selectedItems, open, handleClose, copy } = props;\r\n\r\n    return <ChooseLocation\r\n        open={open}\r\n        actionName=\"Copy\"\r\n        initialHost={initialHost}\r\n        initialPath={initialPath}\r\n        handleClose={handleClose}\r\n        handleSubmit={(location) => copy(selectedItems, location)}\r\n    />\r\n}\r\n\r\n\r\ninterface StateProps extends DialogStateProps {\r\n    initialHost: string;\r\n    initialPath: string[];\r\n    selectedItems: Item[];\r\n}\r\ninterface DispatchProps {\r\n    handleClose(): void;\r\n    copy(selectedItems: Item[], { host, path }: { host: string, path: string[] }): void;\r\n}\r\ninterface CopyProps extends StateProps, DispatchProps {}\r\n\r\n\r\n\r\nconst mapStateToProps = (state: AppState): StateProps => {\r\n    return {\r\n        open: state.visibleDialogs.COPY,\r\n        initialHost: state.account.host || '',\r\n        initialPath: state.path,\r\n        selectedItems: state.items.selected,\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch): DispatchProps => {\r\n    return {\r\n        handleClose: () => {\r\n            dispatch(closeDialog(DIALOGS.COPY));\r\n        },\r\n        copy: (selectedItems, targetLocation) => {\r\n            dispatch(copyItems(selectedItems, targetLocation));\r\n        },\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CopyDialog);\r\n","import React from 'react';\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport FileIcon from '@material-ui/icons/InsertDriveFile';\r\nimport { getHumanFileSize } from '../../Api/Item';\r\n\r\nfunction UploadFileList(props: UploadFileListProps) {\r\n    const { files } = props;\r\n    const list = Array.from(files).map((f, i) =>\r\n        <ListItem dense key={i}>\r\n            <ListItemIcon>\r\n                <FileIcon />\r\n            </ListItemIcon>\r\n            <ListItemText primary={`${f.name} (${getHumanFileSize(f.size)})`} />\r\n        </ListItem>\r\n    );\r\n\r\n    return (\r\n        <div>\r\n            <List component=\"nav\">\r\n                {list}\r\n            </List>\r\n        </div>\r\n    );\r\n}\r\n\r\ninterface UploadFileListProps {\r\n    files: FileList;\r\n}\r\n\r\nexport default UploadFileList;\r\n","import React, { Component, createRef } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport UploadFileList from './UploadFileList';\r\n\r\nclass FileUploader extends Component<FileUploadProps> {\r\n    inputRef: React.RefObject<HTMLInputElement> = createRef();\r\n\r\n    handleReset(event: React.MouseEvent<HTMLElement, MouseEvent> | React.TouchEvent): void {\r\n        const inputElement = this.inputRef.current;\r\n        if (inputElement) {\r\n            inputElement.value = '';\r\n            this.props.handleReset(event);\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const { fileList, handleSelectedFiles } = this.props;\r\n        const styles = {\r\n            inputfile: {\r\n                // TODO: Change this to display none as soon, as the label button works\r\n                // display: 'none'\r\n            }, inputreset: {\r\n                display: (fileList && fileList.length) ? 'inline-flex' : 'none'\r\n            }\r\n        }\r\n\r\n        return (\r\n            <div>\r\n                <label htmlFor=\"button-file\">\r\n                    <input style={styles.inputfile} id=\"button-file\" ref={this.inputRef} multiple type=\"file\" onChange={handleSelectedFiles} />\r\n                    {/*<Button component=\"span\" variant=\"contained\" color=\"primary\">\r\n                        Select Files\r\n                    </Button>*/}\r\n                </label>\r\n\r\n                <Button style={styles.inputreset} component=\"span\" type=\"reset\" onClick={this.handleReset.bind(this)}>\r\n                    Clear\r\n                </Button>\r\n\r\n                { fileList && <UploadFileList files={fileList} /> }\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\ninterface FileUploadProps {\r\n    fileList: FileList|null;\r\n    handleReset(event: React.MouseEvent<HTMLElement, MouseEvent> | React.TouchEvent): void;\r\n    handleSelectedFiles(event: React.ChangeEvent<HTMLInputElement>): void;\r\n}\r\n\r\nexport default FileUploader;\r\n","import React, { Component } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport LinearProgress from '@material-ui/core/LinearProgress';\r\nimport { connect } from 'react-redux';\r\n//import { resetFileUploader, uploadFiles, setFileUploadList, MyDispatch, resetFileUploadList, setErrorMessage } from '../../../Actions/Actions';\r\nimport { resetFileUploader, uploadFiles, setFileUploadList, MyDispatch, resetFileUploadList } from '../../../Actions/Actions';\r\nimport FileUploader from '../../FileUploader/FileUploader';\r\nimport { DialogStateProps, DialogDispatchProps } from '../dialogTypes';\r\nimport { AppState } from '../../../Reducers/reducer';\r\n\r\nclass FormDialog extends Component<UploadFileProps> {\r\n\r\n    render() {\r\n        const { handleClose, handleReset, handleSubmit, open, canUpload, progress, fileList, handleSelectedFiles } = this.props;\r\n\r\n        return (\r\n            <Dialog open={open} onClose={handleClose} aria-labelledby=\"form-dialog-upload\" fullWidth={true} maxWidth={'sm'}>\r\n                <form>\r\n                    <DialogTitle id=\"form-dialog-upload\">\r\n                        Upload files\r\n                    </DialogTitle>\r\n                    <DialogContent>\r\n                        <FileUploader fileList={fileList} handleSelectedFiles={handleSelectedFiles} handleReset={handleReset}/>\r\n                        {canUpload ? <LinearProgress variant=\"determinate\" value={progress} /> : null }\r\n                    </DialogContent>\r\n                    <DialogActions>\r\n                        <Button onClick={handleClose} color=\"primary\" type=\"button\">\r\n                            Cancel\r\n                        </Button>\r\n                        <Button color=\"primary\" onClick={handleSubmit} disabled={!canUpload} type=\"submit\">\r\n                            Upload\r\n                        </Button>\r\n                    </DialogActions>\r\n                </form>\r\n            </Dialog>\r\n        );\r\n    }\r\n}\r\n\r\ninterface StateProps extends DialogStateProps {\r\n    canUpload: boolean;\r\n    fileList: FileList|null;\r\n    progress: number;\r\n}\r\ninterface DispatchProps extends DialogDispatchProps {\r\n    handleSelectedFiles(event: React.ChangeEvent<HTMLInputElement>): void;\r\n    handleReset(): void;\r\n}\r\ninterface UploadFileProps extends StateProps, DispatchProps {}\r\n\r\n\r\nconst mapStateToProps = (state: AppState): StateProps => {\r\n    return {\r\n        open: state.visibleDialogs.UPLOAD_FILE,\r\n        canUpload: state.upload.fileList ? state.upload.fileList.length > 0 : false,\r\n        fileList: state.upload.fileList,\r\n        progress: state.upload.progress,\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch): DispatchProps => {\r\n    return {\r\n        handleClose: (event) => {\r\n            dispatch(resetFileUploader());\r\n        },\r\n        handleSubmit: (event) => {\r\n            event.preventDefault();\r\n            dispatch(uploadFiles());\r\n        },\r\n        handleSelectedFiles: (event) => {\r\n            const files = event.target.files;\r\n            dispatch(setFileUploadList(files));\r\n        },\r\n        handleReset: () => {\r\n            dispatch(resetFileUploadList());\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FormDialog);\r\n","import React from 'react';\r\nimport DialogMenu from './Menu/Menu';\r\nimport DialogContent from './Content/Content';\r\nimport DialogMedia from './Media/Media';\r\nimport DialogEdit from './Edit/Edit';\r\nimport DialogEditTags from './EditTags/EditTags';\r\nimport DialogCreateFolder from './CreateFolder/CreateFolder';\r\nimport DialogCreateFile from './CreateFile/CreateFile';\r\nimport DialogRename from './Rename/Rename';\r\nimport DialogMove from './Move/Move';\r\nimport DialogCopy from './Copy/Copy';\r\nimport DialogUploadFile from './UploadFile/UploadFile';\r\n\r\n// TODO: Consider moving the visibility logic here\r\nfunction Dialogs() {\r\n    return (\r\n        <div className=\"Dialogs\">\r\n            <DialogMenu />\r\n            <DialogContent />\r\n            <DialogMedia />\r\n            <DialogEdit />\r\n            <DialogEditTags />\r\n            <DialogCreateFolder />\r\n            <DialogCreateFile />\r\n            <DialogMove />\r\n            <DialogCopy />\r\n            <DialogRename />\r\n            <DialogUploadFile />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Dialogs;\r\n","import React from 'react';\r\nimport { withStyles, Theme, createStyles, WithStyles } from '@material-ui/core/styles';\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport { connect } from 'react-redux';\r\nimport { MyDispatch, resetErrorMessage } from '../../Actions/Actions';\r\nimport { AppState } from '../../Reducers/reducer';\r\n\r\nconst styles = (theme: Theme) => createStyles({\r\n  close: {\r\n    padding: theme.spacing.unit / 2,\r\n  },\r\n});\r\n\r\nclass DynamicSnackbar extends React.Component<DynamicSnackbarProps> {\r\n  render() {\r\n    const { classes, errorMsg, handleClose, open, notificationDuration } = this.props;\r\n    return (\r\n      <div>\r\n        <Snackbar\r\n          anchorOrigin={{\r\n            vertical: 'bottom',\r\n            horizontal: 'left',\r\n          }}\r\n          open={open}\r\n          autoHideDuration={notificationDuration}\r\n          onClose={handleClose}\r\n          ContentProps={{\r\n            'aria-describedby': 'message-id',\r\n          }}\r\n          message={<span id=\"message-id\">{errorMsg}</span>}\r\n          action={[\r\n            <IconButton key=\"close\" aria-label=\"Close\" color=\"inherit\" className={classes.close} onClick={handleClose} >\r\n              <CloseIcon />\r\n            </IconButton>,\r\n          ]}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\ninterface StateProps {\r\n  open: boolean;\r\n  errorMsg: string;\r\n  notificationDuration: number;\r\n}\r\ninterface DispatchProps {\r\n  handleClose(): void;\r\n}\r\ninterface DynamicSnackbarProps extends StateProps, DispatchProps, WithStyles<typeof styles> {}\r\n\r\nconst mapStateToProps = (state: AppState): StateProps => {\r\n    return {\r\n        open: !!state.errorMessage,\r\n        errorMsg: state.errorMessage,\r\n        notificationDuration: 60000\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch): DispatchProps => {\r\n    return {\r\n        handleClose: () => {\r\n          dispatch(resetErrorMessage());\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withStyles(styles)(DynamicSnackbar));\r\n\r\n","import React, { Component } from 'react';\r\nimport TreeAndTagList from './TreeAndTagList';\r\nimport Navbar from './Components/Navbar/Navbar';\r\nimport ContextMenu from './Components/ContextMenu/ContextMenu';\r\nimport Dialogs from './Components/Dialogs/Dialogs';\r\nimport { MuiThemeProvider as MaterialUI, createMuiTheme } from '@material-ui/core/styles';\r\nimport { connect } from 'react-redux';\r\nimport { initApp, MyDispatch, closeContextMenu } from './Actions/Actions';\r\nimport DynamicSnackbar from './Components/Notification/DynamicSnackbar';\r\nimport HistoryHandler from './Components/HistoryHandler/HistoryHandler';\r\n\r\nconst theme = createMuiTheme({\r\n    palette: {\r\n        //primary: blue,\r\n    },\r\n    typography: {\r\n        useNextVariants: true,\r\n    }\r\n});\r\n\r\nclass App extends Component<AppProps> {\r\n\r\n    componentDidMount() {\r\n        this.props.init();\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"App\">\r\n                <MaterialUI theme={theme}>\r\n                    <div onClick={this.props.handleHideContextMenu} onContextMenu={this.props.handleHideContextMenu}>\r\n                        <Navbar />\r\n                        <TreeAndTagList />\r\n                        <ContextMenu />\r\n                        <DynamicSnackbar />\r\n                        <Dialogs />\r\n                    </div>\r\n                </MaterialUI>\r\n                <HistoryHandler />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\ninterface DispatchProps {\r\n    init(): void;\r\n    handleHideContextMenu(event: React.MouseEvent<HTMLDivElement, MouseEvent>): void;\r\n}\r\n\r\ninterface AppProps extends DispatchProps { }\r\n\r\nconst mapStateToProps = () => ({});\r\n\r\nconst mapDispatchToProps = (dispatch: MyDispatch): DispatchProps => {\r\n    return {\r\n        init: () => {\r\n            dispatch(initApp());\r\n        },\r\n\r\n        handleHideContextMenu: (event) => {\r\n            const element = event.target as HTMLElement;\r\n            if (!(element.tagName === 'INPUT' || /label/i.test(element.className))) {\r\n                event.preventDefault();\r\n            }\r\n            dispatch(closeContextMenu());\r\n        }\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport thunk from 'redux-thunk';\r\nimport { Provider } from 'react-redux';\r\nimport { createStore, applyMiddleware } from 'redux'\r\nimport reducer from './Reducers/reducer'\r\nimport * as serviceWorker from './serviceWorker';\r\nimport App from './App';\r\nimport './index.css';\r\nimport 'typeface-roboto';\r\n\r\nconst store = createStore(reducer, applyMiddleware(thunk));\r\n\r\nReactDOM.render(\r\n    <Provider store={store}>\r\n        <App />\r\n    </Provider >\r\n    , document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: http://bit.ly/CRA-PWA\r\nserviceWorker.register({\r\n    onUpdate: (config) => {\r\n        console.group('serviceWorker.onUpdate');\r\n        console.log(config);\r\n        console.groupEnd();\r\n    },\r\n    onSuccess: (config) => {\r\n        console.group('serviceWorker.onSuccess');\r\n        console.log(config);\r\n        console.groupEnd();\r\n    }\r\n});"],"sourceRoot":""}